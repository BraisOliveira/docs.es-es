---
title: Identificación de los límites del modelo de dominio para cada microservicio
description: Explore la esencia de crear particiones de una aplicación grande en microservicios para lograr una arquitectura sólida.
ms.date: 09/20/2018
ms.openlocfilehash: aa903e13b20be1084fad60e6fb7bbb1c61403deb
ms.sourcegitcommit: f20dd18dbcf2275513281f5d9ad7ece6a62644b4
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 07/30/2019
ms.locfileid: "68673092"
---
# <a name="identify-domain-model-boundaries-for-each-microservice"></a><span data-ttu-id="dd71a-103">Identificar los límites del modelo de dominio para cada microservicio</span><span class="sxs-lookup"><span data-stu-id="dd71a-103">Identify domain-model boundaries for each microservice</span></span>

<span data-ttu-id="dd71a-104">El objetivo al identificar los límites del modelo y el tamaño de cada microservicio no es llegar a la separación más específica posible (aunque debería intentar usar microservicios pequeños siempre que sea posible),</span><span class="sxs-lookup"><span data-stu-id="dd71a-104">The goal when identifying model boundaries and size for each microservice isn't to get to the most granular separation possible, although you should tend toward small microservices if possible.</span></span> <span data-ttu-id="dd71a-105">sino que debería ser llegar a la separación más significativa basada en el conocimiento del dominio.</span><span class="sxs-lookup"><span data-stu-id="dd71a-105">Instead, your goal should be to get to the most meaningful separation guided by your domain knowledge.</span></span> <span data-ttu-id="dd71a-106">El énfasis no está en el tamaño, sino más bien en las capacidades empresariales.</span><span class="sxs-lookup"><span data-stu-id="dd71a-106">The emphasis isn't on the size, but instead on business capabilities.</span></span> <span data-ttu-id="dd71a-107">Además, si se necesita una clara cohesión para un área concreta de la aplicación sobre la base de un gran número de dependencias, eso también indica la necesidad de un solo microservicio.</span><span class="sxs-lookup"><span data-stu-id="dd71a-107">In addition, if there's clear cohesion needed for a certain area of the application based on a high number of dependencies, that indicates the need for a single microservice, too.</span></span> <span data-ttu-id="dd71a-108">La cohesión es una manera de identificar cómo separar o agrupar microservicios.</span><span class="sxs-lookup"><span data-stu-id="dd71a-108">Cohesion is a way to identify how to break apart or group together microservices.</span></span> <span data-ttu-id="dd71a-109">En última instancia, al tiempo que conoce mejor el dominio, debe adaptar el tamaño de su microservicio de forma iterativa.</span><span class="sxs-lookup"><span data-stu-id="dd71a-109">Ultimately, while you gain more knowledge about the domain, you should adapt the size of your microservice, iteratively.</span></span> <span data-ttu-id="dd71a-110">Buscar el tamaño adecuado no es un proceso monoestable.</span><span class="sxs-lookup"><span data-stu-id="dd71a-110">Finding the right size isn't a one-shot process.</span></span>

<span data-ttu-id="dd71a-111">[Sam Newman](https://samnewman.io/), un reconocido promotor de microservicios y autor del libro [Crear microservicios](https://samnewman.io/books/building_microservices/), resalta que los microservicios se deben diseñar de acuerdo con el patrón de contexto limitado (BC) (parte del diseño guiado por el dominio), como se ha mencionado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="dd71a-111">[Sam Newman](https://samnewman.io/), a recognized promoter of microservices and author of the book [Building Microservices](https://samnewman.io/books/building_microservices/), highlights that you should design your microservices based on the Bounded Context (BC) pattern (part of domain-driven design), as introduced earlier.</span></span> <span data-ttu-id="dd71a-112">A veces, un BC podría estar compuesto de varios servicios físicos, pero no viceversa.</span><span class="sxs-lookup"><span data-stu-id="dd71a-112">Sometimes, a BC could be composed of several physical services, but not vice versa.</span></span>

<span data-ttu-id="dd71a-113">Un modelo de dominio con entidades de dominio específicas se aplica en un BC o un microservicio concreto.</span><span class="sxs-lookup"><span data-stu-id="dd71a-113">A domain model with specific domain entities applies within a concrete BC or microservice.</span></span> <span data-ttu-id="dd71a-114">Un BC delimita la aplicabilidad de un modelo de dominio y ofrece a los miembros del equipo de desarrolladores una descripción clara y compartida de qué partes deben ser cohesivas y qué partes se pueden desarrollar de manera independiente.</span><span class="sxs-lookup"><span data-stu-id="dd71a-114">A BC delimits the applicability of a domain model and gives developer team members a clear and shared understanding of what must be cohesive and what can be developed independently.</span></span> <span data-ttu-id="dd71a-115">Estos son los mismos objetivos para los microservicios.</span><span class="sxs-lookup"><span data-stu-id="dd71a-115">These are the same goals for microservices.</span></span>

<span data-ttu-id="dd71a-116">Otra herramienta que informa sobre su elección de diseño es la [ley de Conway](https://en.wikipedia.org/wiki/Conway%27s_law), que indica que una aplicación reflejará los límites sociales de la organización que la produjo.</span><span class="sxs-lookup"><span data-stu-id="dd71a-116">Another tool that informs your design choice is [Conway's law](https://en.wikipedia.org/wiki/Conway%27s_law), which states that an application will reflect the social boundaries of the organization that produced it.</span></span> <span data-ttu-id="dd71a-117">Pero a veces sucede lo contrario: el software forma la organización de una empresa.</span><span class="sxs-lookup"><span data-stu-id="dd71a-117">But sometimes the opposite is true -the company's organization is formed by the software.</span></span> <span data-ttu-id="dd71a-118">Tal vez deba invertir la ley de Conway y establecer los límites de la forma que quiere que la empresa se organice, decantándose por la consultoría de procesos empresariales.</span><span class="sxs-lookup"><span data-stu-id="dd71a-118">You might need to reverse Conway's law and build the boundaries the way you want the company to be organized, leaning toward business process consulting.</span></span>

<span data-ttu-id="dd71a-119">Para identificar los contextos limitados, puede usar un patrón DDD denominado [patrón de asignación de contexto](https://www.infoq.com/articles/ddd-contextmapping).</span><span class="sxs-lookup"><span data-stu-id="dd71a-119">To identify bounded contexts, you can use a DDD pattern called the [Context Mapping pattern](https://www.infoq.com/articles/ddd-contextmapping).</span></span> <span data-ttu-id="dd71a-120">Con la asignación de contexto, puede identificar los distintos contextos de la aplicación y sus límites.</span><span class="sxs-lookup"><span data-stu-id="dd71a-120">With Context Mapping, you identify the various contexts in the application and their boundaries.</span></span> <span data-ttu-id="dd71a-121">Es habitual tener un contexto y un límite diferentes para cada subsistema pequeño, por ejemplo.</span><span class="sxs-lookup"><span data-stu-id="dd71a-121">It's common to have a different context and boundary for each small subsystem, for instance.</span></span> <span data-ttu-id="dd71a-122">La asignación de contexto es una manera de definir y establecer explícitamente esos límites entre dominios.</span><span class="sxs-lookup"><span data-stu-id="dd71a-122">The Context Map is a way to define and make explicit those boundaries between domains.</span></span> <span data-ttu-id="dd71a-123">Un BC es autónomo, incluye los detalles de un único dominio, como las entidades de dominio, y define los contratos de integración con otros BC.</span><span class="sxs-lookup"><span data-stu-id="dd71a-123">A BC is autonomous and includes the details of a single domain -details like the domain entities- and defines integration contracts with other BCs.</span></span> <span data-ttu-id="dd71a-124">Esto es similar a la definición de un microservicio: es autónomo, implementa cierta capacidad de dominio y debe proporcionar interfaces.</span><span class="sxs-lookup"><span data-stu-id="dd71a-124">This is similar to the definition of a microservice: it's autonomous, it implements certain domain capability, and it must provide interfaces.</span></span> <span data-ttu-id="dd71a-125">Esta es la razón por la que la asignación de contexto y el patrón de contexto limitado son enfoques excelentes para identificar los límites del modelo de dominio de sus microservicios.</span><span class="sxs-lookup"><span data-stu-id="dd71a-125">This is why Context Mapping and the Bounded Context pattern are good approaches for identifying the domain model boundaries of your microservices.</span></span>

<span data-ttu-id="dd71a-126">Al diseñar una aplicación grande, verá cómo se puede fragmentar su modelo de dominio; por ejemplo, un experto en dominios del dominio de catálogo denominará las entidades de una manera diferente en los dominios de catálogo e inventario que un experto en dominios de envío.</span><span class="sxs-lookup"><span data-stu-id="dd71a-126">When designing a large application, you'll see how its domain model can be fragmented - a domain expert from the catalog domain will name entities differently in the catalog and inventory domains than a shipping domain expert, for instance.</span></span> <span data-ttu-id="dd71a-127">O puede que la entidad de dominio de usuario sea diferente en tamaño y número de atributos cuando se trata de un experto de CRM que quiere almacenar todos los detalles sobre el cliente, en comparación con un experto en dominios de pedido que solo necesita datos parciales sobre el cliente.</span><span class="sxs-lookup"><span data-stu-id="dd71a-127">Or the user domain entity might be different in size and number of attributes when dealing with a CRM expert who wants to store every detail about the customer than for an ordering domain expert who just needs partial data about the customer.</span></span> <span data-ttu-id="dd71a-128">Es muy difícil eliminar la ambigüedad de todos los términos del dominio en todos los dominios relacionados con una aplicación grande.</span><span class="sxs-lookup"><span data-stu-id="dd71a-128">It's very hard to disambiguate all domain terms across all the domains related to a large application.</span></span> <span data-ttu-id="dd71a-129">Pero lo más importante es que no debe intentar unificar los términos.</span><span class="sxs-lookup"><span data-stu-id="dd71a-129">But the most important thing is that you shouldn't try to unify the terms.</span></span> <span data-ttu-id="dd71a-130">En su lugar, acepte las diferencias y la riqueza que cada dominio proporciona.</span><span class="sxs-lookup"><span data-stu-id="dd71a-130">Instead, accept the differences and richness provided by each domain.</span></span> <span data-ttu-id="dd71a-131">Si intenta tener una base de datos unificada para toda la aplicación, los intentos de establecer un vocabulario unificado serán difíciles y los resultados no sonarán bien a ninguno de los múltiples expertos en dominios.</span><span class="sxs-lookup"><span data-stu-id="dd71a-131">If you try to have a unified database for the whole application, attempts at a unified vocabulary will be awkward and won't sound right to any of the multiple domain experts.</span></span> <span data-ttu-id="dd71a-132">Por tanto, con los BC (implementados como microservicios) será más fácil aclarar dónde puede usar determinados términos del dominio y dónde debe dividir el sistema y crear BC adicionales con dominios diferentes.</span><span class="sxs-lookup"><span data-stu-id="dd71a-132">Therefore, BCs (implemented as microservices) will help you to clarify where you can use certain domain terms and where you'll need to split the system and create additional BCs with different domains.</span></span>

<span data-ttu-id="dd71a-133">Sabrá que obtuvo los límites y los tamaños correctos de cada BC y modelo de dominio si tiene pocas relaciones sólidas entre los modelos de dominio y normalmente no necesita combinar información de varios modelos de dominio al realizar operaciones de aplicaciones típicas.</span><span class="sxs-lookup"><span data-stu-id="dd71a-133">You'll know that you got the right boundaries and sizes of each BC and domain model if you have few strong relationships between domain models, and you do not usually need to merge information from multiple domain models when performing typical application operations.</span></span>

<span data-ttu-id="dd71a-134">Quizá la mejor respuesta a la pregunta de qué tamaño debe tener un modelo de dominio para cada microservicio es la siguiente: debe tener un BC autónomo, tan aislado como sea posible, que le permita trabajar sin tener que cambiar constantemente a otros contextos (otros modelos de microservicio).</span><span class="sxs-lookup"><span data-stu-id="dd71a-134">Perhaps the best answer to the question of how large a domain model for each microservice should be is the following: it should have an autonomous BC, as isolated as possible, that enables you to work without having to constantly switch to other contexts (other microservice's models).</span></span> <span data-ttu-id="dd71a-135">En la figura 4-10 puede ver cómo varios microservicios (varios BC) tienen su propio modelo y cómo se pueden definir sus entidades, según los requisitos específicos para cada uno de los dominios identificados en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="dd71a-135">In Figure 4-10, you can see how multiple microservices (multiple BCs) each has their own model and how their entities can be defined, depending on the specific requirements for each of the identified domains in your application.</span></span>

![Las entidades en varios límites de modelo (contextos delimitados), donde la misma entidad aparece como "Users", "Buyers", "Payers" y "Customers" en función del contexto delimitado](./media/image10.png)

<span data-ttu-id="dd71a-137">**Figura 4-10**.</span><span class="sxs-lookup"><span data-stu-id="dd71a-137">**Figure 4-10**.</span></span> <span data-ttu-id="dd71a-138">Identificación de las entidades y de los límites del modelo de microservicio</span><span class="sxs-lookup"><span data-stu-id="dd71a-138">Identifying entities and microservice model boundaries</span></span>

<span data-ttu-id="dd71a-139">En la figura 4-10 se ilustra un escenario de ejemplo relacionado con un sistema de administración de conferencias en línea.</span><span class="sxs-lookup"><span data-stu-id="dd71a-139">Figure 4-10 illustrates a sample scenario related to an online conference management system.</span></span> <span data-ttu-id="dd71a-140">Ha identificado varios BC que se podrían implementar como microservicios, de acuerdo con los dominios que los expertos en dominios definieron para su caso.</span><span class="sxs-lookup"><span data-stu-id="dd71a-140">You've identified several BCs that could be implemented as microservices, based on domains that domain experts defined for you.</span></span> <span data-ttu-id="dd71a-141">Como puede ver, hay entidades que están presentes solo en un modelo de microservicio único, como los pagos en el microservicio de pago.</span><span class="sxs-lookup"><span data-stu-id="dd71a-141">As you can see, there are entities that are present just in a single microservice model, like Payments in the Payment microservice.</span></span> <span data-ttu-id="dd71a-142">Serán fáciles de implementar.</span><span class="sxs-lookup"><span data-stu-id="dd71a-142">Those will be easy to implement.</span></span>

<span data-ttu-id="dd71a-143">Sin embargo, también puede tener entidades que tienen una forma diferente, pero comparten la misma identidad a través de los múltiples modelos de dominio de los diversos microservicios.</span><span class="sxs-lookup"><span data-stu-id="dd71a-143">However, you might also have entities that have a different shape but share the same identity across the multiple domain models from the multiple microservices.</span></span> <span data-ttu-id="dd71a-144">Por ejemplo, la entidad User se identifica en el microservicio de administración de conferencias.</span><span class="sxs-lookup"><span data-stu-id="dd71a-144">For example, the User entity is identified in the Conferences Management microservice.</span></span> <span data-ttu-id="dd71a-145">Ese mismo usuario, con la misma identidad, es el que se llama compradores en el microservicio de pedidos, o el que se llama pagador en el microservicio de pago e incluso el que se llama cliente en el microservicio de servicio al cliente.</span><span class="sxs-lookup"><span data-stu-id="dd71a-145">That same user, with the same identity, is the one named Buyers in the Ordering microservice, or the one named Payer in the Payment microservice, and even the one named Customer in the Customer Service microservice.</span></span> <span data-ttu-id="dd71a-146">Esto es porque, según el [lenguaje ubicuo](https://martinfowler.com/bliki/UbiquitousLanguage.html) que cada experto en dominios use, un usuario podría tener una perspectiva distinta incluso con atributos diferentes.</span><span class="sxs-lookup"><span data-stu-id="dd71a-146">This is because, depending on the [ubiquitous language](https://martinfowler.com/bliki/UbiquitousLanguage.html) that each domain expert is using, a user might have a different perspective even with different attributes.</span></span> <span data-ttu-id="dd71a-147">La entidad de usuario en el modelo de microservicio denominado Administración de conferencias podría tener la mayoría de sus atributos de datos personales.</span><span class="sxs-lookup"><span data-stu-id="dd71a-147">The user entity in the microservice model named Conferences Management might have most of its personal data attributes.</span></span> <span data-ttu-id="dd71a-148">Sin embargo, puede ser que ese mismo usuario en la forma de pagador en el microservicio de pago o en la forma de cliente en el microservicio de servicio al cliente no necesite la misma lista de atributos.</span><span class="sxs-lookup"><span data-stu-id="dd71a-148">However, that same user in the shape of Payer in the microservice Payment or in the shape of Customer in the microservice Customer Service might not need the same list of attributes.</span></span>

<span data-ttu-id="dd71a-149">Un enfoque similar se muestra en la figura 4-11.</span><span class="sxs-lookup"><span data-stu-id="dd71a-149">A similar approach is illustrated in Figure 4-11.</span></span>

![Al descomponer un modelo de datos tradicionales entre contextos limitados, puede tener distintas entidades que comparten la misma identidad (un comprador también es un usuario) con otros atributos en cada contexto delimitado.](./media/image11.png)

<span data-ttu-id="dd71a-151">**Figura 4-11**.</span><span class="sxs-lookup"><span data-stu-id="dd71a-151">**Figure 4-11**.</span></span> <span data-ttu-id="dd71a-152">Descomponer los modelos de datos tradicionales en varios modelos de dominio</span><span class="sxs-lookup"><span data-stu-id="dd71a-152">Decomposing traditional data models into multiple domain models</span></span>

<span data-ttu-id="dd71a-153">Puede ver cómo el usuario está presente en el modelo de microservicio de administración de conferencias como la entidad User y también está presente en la forma de la entidad Buyer en el microservicio de precios, con atributos o detalles alternativos sobre el usuario cuando es realmente un comprador.</span><span class="sxs-lookup"><span data-stu-id="dd71a-153">You can see how the user is present in the Conferences Management microservice model as the User entity and is also present in the form of the Buyer entity in the Pricing microservice, with alternate attributes or details about the user when it's actually a buyer.</span></span> <span data-ttu-id="dd71a-154">Puede ser que no todos los microservicios o BC necesiten todos los datos relacionados con una entidad User, solo parte de ellos, según el problema que se deba resolver o el contexto.</span><span class="sxs-lookup"><span data-stu-id="dd71a-154">Each microservice or BC might not need all the data related to a User entity, just part of it, depending on the problem to solve or the context.</span></span> <span data-ttu-id="dd71a-155">Por ejemplo, en el modelo del microservicio de precios, no necesita la dirección ni el identificador del usuario, solo el identificador (como identidad) y el estado, que influirán en los descuentos al poner precio al número de puestos por comprador.</span><span class="sxs-lookup"><span data-stu-id="dd71a-155">For instance, in the Pricing microservice model, you do not need the address or the name of the user, just the ID (as identity) and Status, which will have an impact on discounts when pricing the seats per buyer.</span></span>

<span data-ttu-id="dd71a-156">La entidad Seat tiene el mismo nombre, pero distintos atributos en cada modelo de dominio,</span><span class="sxs-lookup"><span data-stu-id="dd71a-156">The Seat entity has the same name but different attributes in each domain model.</span></span> <span data-ttu-id="dd71a-157">pero Seat comparte la identidad según el mismo identificador, como sucede con User y Buyer.</span><span class="sxs-lookup"><span data-stu-id="dd71a-157">However, Seat shares identity based on the same ID, as happens with User and Buyer.</span></span>

<span data-ttu-id="dd71a-158">Básicamente, hay un concepto compartido de un usuario que existe en varios servicios (dominios), que comparten la identidad de ese usuario.</span><span class="sxs-lookup"><span data-stu-id="dd71a-158">Basically, there's a shared concept of a user that exists in multiple services (domains), which all share the identity of that user.</span></span> <span data-ttu-id="dd71a-159">Pero, en cada modelo de dominio, podría haber detalles adicionales o diferentes sobre la entidad de usuario.</span><span class="sxs-lookup"><span data-stu-id="dd71a-159">But in each domain model there might be additional or different details about the user entity.</span></span> <span data-ttu-id="dd71a-160">Por tanto, debe haber una manera de asignar una entidad de usuario de un dominio (microservicio) a otro.</span><span class="sxs-lookup"><span data-stu-id="dd71a-160">Therefore, there needs to be a way to map a user entity from one domain (microservice) to another.</span></span>

<span data-ttu-id="dd71a-161">No compartir la misma entidad de usuario con el mismo número de atributos entre dominios tiene varias ventajas.</span><span class="sxs-lookup"><span data-stu-id="dd71a-161">There are several benefits to not sharing the same user entity with the same number of attributes across domains.</span></span> <span data-ttu-id="dd71a-162">Una ventaja es reducir la duplicación, por lo que los modelos de microservicio no tienen ningún dato que no necesiten.</span><span class="sxs-lookup"><span data-stu-id="dd71a-162">One benefit is to reduce duplication, so that microservice models do not have any data that they do not need.</span></span> <span data-ttu-id="dd71a-163">Otra ventaja es tener un microservicio maestro que posee un determinado tipo de datos por entidad para que solo ese microservicio dirija las actualizaciones y las consultas para ese tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="dd71a-163">Another benefit is having a master microservice that owns a certain type of data per entity so that updates and queries for that type of data are driven only by that microservice.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="dd71a-164">[Anterior](distributed-data-management.md)
>[Siguiente](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span><span class="sxs-lookup"><span data-stu-id="dd71a-164">[Previous](distributed-data-management.md)
[Next](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span></span>
