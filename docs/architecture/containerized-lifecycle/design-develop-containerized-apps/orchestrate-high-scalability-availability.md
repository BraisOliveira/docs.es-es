---
title: Orquestación de microservicios y aplicaciones de varios contenedores para una alta escalabilidad y disponibilidad
description: Las aplicaciones de producción real deben implementarse y administrarse con orquestadores que controlen el mantenimiento, la carga de trabajo y los ciclos de vida de todos los contenedores.
ms.date: 02/15/2019
ms.openlocfilehash: 8f2cef774acde47e9a1bb4680342b5e2c66ac154
ms.sourcegitcommit: 005980b14629dfc193ff6cdc040800bc75e0a5a5
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 09/14/2019
ms.locfileid: "70990495"
---
# <a name="orchestrating-microservices-and-multi-container-applications-for-high-scalability-and-availability"></a><span data-ttu-id="47ace-103">Orquestación de microservicios y aplicaciones de varios contenedores para una alta escalabilidad y disponibilidad</span><span class="sxs-lookup"><span data-stu-id="47ace-103">Orchestrating microservices and multi-container applications for high scalability and availability</span></span>

<span data-ttu-id="47ace-104">La utilización de orquestadores para aplicaciones listas para producción es fundamental si la aplicación se basa en microservicios o está dividida entre varios contenedores.</span><span class="sxs-lookup"><span data-stu-id="47ace-104">Using orchestrators for production-ready applications is essential if your application is based on microservices or split across multiple containers.</span></span> <span data-ttu-id="47ace-105">Como se mencionó anteriormente, en un enfoque basado en microservicios, cada microservicio posee su modelo y sus datos para que sea autónomo desde un punto de vista del desarrollo y la implementación.</span><span class="sxs-lookup"><span data-stu-id="47ace-105">As introduced previously, in a microservice-based approach, each microservice owns its model and data so that it will be autonomous from a development and deployment point of view.</span></span> <span data-ttu-id="47ace-106">Pero incluso si tiene una aplicación más tradicional que se compone de varios servicios (por ejemplo, SOA), también tendrá varios contenedores o servicios que conforman una sola aplicación de negocio que deban implementarse como un sistema distribuido.</span><span class="sxs-lookup"><span data-stu-id="47ace-106">But even if you have a more traditional application that's composed of multiple services (like SOA), you'll also have multiple containers or services comprising a single business application that need to be deployed as a distributed system.</span></span> <span data-ttu-id="47ace-107">Estos tipos de sistemas son difíciles de administrar y escalar horizontalmente; por lo tanto, un orquestador es indispensable si se quiere tener una aplicación de varios contenedores, escalable y lista para la producción.</span><span class="sxs-lookup"><span data-stu-id="47ace-107">These kinds of systems are complex to scale out and manage; therefore, you absolutely need an orchestrator if you want to have a production-ready and scalable multi-container application.</span></span>

<span data-ttu-id="47ace-108">La figura 4-6 ilustra la implementación en un clúster de una aplicación formada por varios microservicios (contenedores).</span><span class="sxs-lookup"><span data-stu-id="47ace-108">Figure 4-6 illustrates deployment into a cluster of an application composed of multiple microservices (containers).</span></span>

![Aplicaciones compuestas de Docker en un clúster: use un contenedor para cada instancia de servicio.](./media/image6.png)

<span data-ttu-id="47ace-112">**Figura 4-6**.</span><span class="sxs-lookup"><span data-stu-id="47ace-112">**Figure 4-6**.</span></span> <span data-ttu-id="47ace-113">Un clúster de contenedores</span><span class="sxs-lookup"><span data-stu-id="47ace-113">A cluster of containers</span></span>

<span data-ttu-id="47ace-114">Parece un enfoque lógico.</span><span class="sxs-lookup"><span data-stu-id="47ace-114">It looks like a logical approach.</span></span> <span data-ttu-id="47ace-115">Pero ¿cómo se está administrando el equilibrio de carga, el enrutamiento y la orquestación de estas aplicaciones compuestas?</span><span class="sxs-lookup"><span data-stu-id="47ace-115">But how are you handling load balancing, routing, and orchestrating these composed applications?</span></span>

<span data-ttu-id="47ace-116">La interfaz de la línea de comandos (CLI) de Docker satisface las necesidades de administración de un contenedor en un host, pero se queda corta a la hora de administrar varios contenedores implementados en varios hosts para aplicaciones distribuidas más complejas.</span><span class="sxs-lookup"><span data-stu-id="47ace-116">The Docker command-line interface (CLI) meets the needs of managing one container on one host, but it falls short when it comes to managing multiple containers deployed on multiple hosts for more complex distributed applications.</span></span> <span data-ttu-id="47ace-117">En la mayoría de los casos, se necesita una plataforma de administración que automáticamente inicie los contenedores, escale horizontalmente los contenedores con varias instancias por imagen, los suspenda o los cierre cuando sea necesario y, a ser posible, también controle su acceso a recursos como la red y el almacenamiento de datos.</span><span class="sxs-lookup"><span data-stu-id="47ace-117">In most cases, you need a management platform that will automatically start containers, scale out containers with multiple instances per image, suspend them, or shut them down when needed, and ideally also control how they access resources like the network and data storage.</span></span>

<span data-ttu-id="47ace-118">Para ir más allá de la administración de contenedores individuales o aplicaciones compuestas simples y pasar a aplicaciones empresariales más grandes con microservicios, debe cambiar a orquestación y plataformas de agrupación en clústeres.</span><span class="sxs-lookup"><span data-stu-id="47ace-118">To go beyond the management of individual containers or simple composed apps and move toward larger enterprise applications with microservices, you must turn to orchestration and clustering platforms.</span></span>

<span data-ttu-id="47ace-119">Desde el punto de vista de la arquitectura y el desarrollo, si está compilando grandes aplicaciones empresariales basadas en microservicios, es importante familiarizarse con las siguientes plataformas y productos que admiten escenarios avanzados:</span><span class="sxs-lookup"><span data-stu-id="47ace-119">From an architecture and development point of view, if you're building large, enterprise, microservices-based, applications, it's important to understand the following platforms and products that support advanced scenarios:</span></span>

- <span data-ttu-id="47ace-120">**Clústeres y orquestadores**.</span><span class="sxs-lookup"><span data-stu-id="47ace-120">**Clusters and orchestrators.**</span></span> <span data-ttu-id="47ace-121">Cuando se necesita escalar horizontalmente las aplicaciones a varios hosts de Docker, como con una aplicación grande basada en microservicios, es fundamental poder administrar todos los hosts como un solo clúster mediante la abstracción de la complejidad de la plataforma subyacente.</span><span class="sxs-lookup"><span data-stu-id="47ace-121">When you need to scale out applications across many Docker hosts, such as with a large microservices-based application, it's critical to be able to manage all of those hosts as a single cluster by abstracting the complexity of the underlying platform.</span></span> <span data-ttu-id="47ace-122">Eso es lo que proporcionan los clústeres de contenedor y los orquestadores.</span><span class="sxs-lookup"><span data-stu-id="47ace-122">That's what the container clusters and orchestrators provide.</span></span> <span data-ttu-id="47ace-123">Azure Service Fabric y Kubernetes son ejemplos de orquestadores.</span><span class="sxs-lookup"><span data-stu-id="47ace-123">Examples of orchestrators are Azure Service Fabric and Kubernetes.</span></span> <span data-ttu-id="47ace-124">Kubernetes está disponible en Azure a través de Azure Kubernetes Service.</span><span class="sxs-lookup"><span data-stu-id="47ace-124">Kubernetes is available in Azure through Azure Kubernetes Service.</span></span>

- <span data-ttu-id="47ace-125">**Programadores**.</span><span class="sxs-lookup"><span data-stu-id="47ace-125">**Schedulers.**</span></span> <span data-ttu-id="47ace-126">*Programar* significa tener la capacidad de que un administrador inicie los contenedores de un clúster, por lo que los programadores también proporcionan una interfaz de usuario para hacerlo.</span><span class="sxs-lookup"><span data-stu-id="47ace-126">*Scheduling* means to have the capability for an administrator to launch containers in a cluster, so schedulers also provide a user interface for doing so.</span></span> <span data-ttu-id="47ace-127">Un programador de clúster tiene varias responsabilidades: usar eficazmente los recursos del clúster, establecer las restricciones definidas por el usuario, equilibrar eficazmente la carga de los contenedores entre los distintos nodos o hosts, ser resistente a los errores y proporcionar un alto grado de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="47ace-127">A cluster scheduler has several responsibilities: to use the cluster's resources efficiently, to set the constraints provided by the user, to efficiently load-balance containers across nodes or hosts, and to be robust against errors while providing high availability.</span></span>

<span data-ttu-id="47ace-128">Los conceptos de un clúster y un programador están estrechamente relacionados, por lo que los productos proporcionados por diferentes proveedores suelen ofrecer ambos conjuntos de funciones.</span><span class="sxs-lookup"><span data-stu-id="47ace-128">The concepts of a cluster and a scheduler are closely related, so the products provided by different vendors often provide both sets of capabilities.</span></span> <span data-ttu-id="47ace-129">En la sección siguiente se muestran las plataformas y las opciones de software más importantes disponibles para clústeres y programadores.</span><span class="sxs-lookup"><span data-stu-id="47ace-129">The section below shows the most important platform and software choices you have for clusters and schedulers.</span></span> <span data-ttu-id="47ace-130">Estos orquestadores generalmente se ofrecen en nubes públicas como Azure.</span><span class="sxs-lookup"><span data-stu-id="47ace-130">These orchestrators are widely offered in public clouds like Azure.</span></span>

## <a name="software-platforms-for-container-clustering-orchestration-and-scheduling"></a><span data-ttu-id="47ace-131">Plataformas de software para agrupación en clústeres de contenedores, orquestación y programación</span><span class="sxs-lookup"><span data-stu-id="47ace-131">Software platforms for container clustering, orchestration, and scheduling</span></span>

| <span data-ttu-id="47ace-132">Plataforma</span><span class="sxs-lookup"><span data-stu-id="47ace-132">Platform</span></span> | <span data-ttu-id="47ace-133">Comentarios</span><span class="sxs-lookup"><span data-stu-id="47ace-133">Comments</span></span> |
|:---:|:---|
| <span data-ttu-id="47ace-134">**Kubernetes**</span><span class="sxs-lookup"><span data-stu-id="47ace-134">**Kubernetes**</span></span> <br/> <span data-ttu-id="47ace-135">![Logotipo de Kubernetes](./media/kubernetes-logo.png)</span><span class="sxs-lookup"><span data-stu-id="47ace-135">![Kubernetes Logo](./media/kubernetes-logo.png)</span></span> | <span data-ttu-id="47ace-136">[*Kubernetes*](https://kubernetes.io/) es un producto de código abierto cuya funcionalidad abarca desde la infraestructura de clúster y la programación de contenedores a las capacidades de orquestación.</span><span class="sxs-lookup"><span data-stu-id="47ace-136">[*Kubernetes*](https://kubernetes.io/) is an open-source product that provides functionality that ranges from cluster infrastructure and container scheduling to orchestrating capabilities.</span></span> <span data-ttu-id="47ace-137">Permite automatizar la implementación, la escala y las operaciones de contenedores de aplicaciones en varios clústeres de hosts.</span><span class="sxs-lookup"><span data-stu-id="47ace-137">It lets you automate deployment, scaling, and operations of application containers across clusters of hosts.</span></span> <br/> <br/> <span data-ttu-id="47ace-138">*Kubernetes* proporciona una infraestructura centrada en el contenedor que agrupa los contenedores de la aplicación en unidades lógicas para facilitar la administración y detección.</span><span class="sxs-lookup"><span data-stu-id="47ace-138">*Kubernetes* provides a container-centric infrastructure that groups application containers into logical units for easy management and discovery.</span></span> <br/> <br/> <span data-ttu-id="47ace-139">*Kubernetes* está más desarrollado en Linux que en Windows.</span><span class="sxs-lookup"><span data-stu-id="47ace-139">*Kubernetes* is mature in Linux, less mature in Windows.</span></span> |
| <span data-ttu-id="47ace-140">**Azure Kubernetes Service (AKS)**</span><span class="sxs-lookup"><span data-stu-id="47ace-140">**Azure Kubernetes Service (AKS)**</span></span> <br/> <span data-ttu-id="47ace-141">![Logotipo de Azure Kubernetes Service](./media/aks-logo.png)</span><span class="sxs-lookup"><span data-stu-id="47ace-141">![Azure Kubernetes Service Logo](./media/aks-logo.png)</span></span> | <span data-ttu-id="47ace-142">[Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/) es un servicio administrado de orquestación de contenedores de Kubernetes en Azure que simplifica la administración, implementación y operaciones del clúster de Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="47ace-142">[Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/) is a managed Kubernetes container orchestration service in Azure that simplifies Kubernetes cluster’s management, deployment, and operations.</span></span> |
| <span data-ttu-id="47ace-143">**Azure Service Fabric**</span><span class="sxs-lookup"><span data-stu-id="47ace-143">**Azure Service Fabric**</span></span> <br/> <span data-ttu-id="47ace-144">![Logotipo de Azure Service Fabric](./media/service-fabric-logo.png)</span><span class="sxs-lookup"><span data-stu-id="47ace-144">![Azure Service Fabric Logo](./media/service-fabric-logo.png)</span></span> | <span data-ttu-id="47ace-145">[Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview) es una plataforma de microservicios de Microsoft para crear aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="47ace-145">[Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview) is a Microsoft microservices platform for building applications.</span></span> <span data-ttu-id="47ace-146">Es un [orquestador](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-resource-manager-introduction) de servicios y crea clústeres de máquinas.</span><span class="sxs-lookup"><span data-stu-id="47ace-146">It's an [orchestrator](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-resource-manager-introduction) of services and creates clusters of machines.</span></span> <span data-ttu-id="47ace-147">Service Fabric puede implementar servicios como contenedores o procesos estándar.</span><span class="sxs-lookup"><span data-stu-id="47ace-147">Service Fabric can deploy services as containers or as plain processes.</span></span> <span data-ttu-id="47ace-148">Puede incluso combinar servicios en procesos con servicios en contenedores dentro de la misma aplicación y el mismo clúster.</span><span class="sxs-lookup"><span data-stu-id="47ace-148">It can even mix services in processes with services in containers within the same application and cluster.</span></span> <br/> <br/> <span data-ttu-id="47ace-149">Los clústeres de *Service Fabric* pueden implementarse en Azure, de forma local o en cualquier nube.</span><span class="sxs-lookup"><span data-stu-id="47ace-149">*Service Fabric* clusters can be deployed in Azure, on-premises or in any cloud.</span></span> <span data-ttu-id="47ace-150">Con todo, la implementación se simplifica en Azure con un enfoque administrado.</span><span class="sxs-lookup"><span data-stu-id="47ace-150">However, deployment in Azure is simplified with a managed approach.</span></span> <br/> <br/> <span data-ttu-id="47ace-151">*Service Fabric* proporciona [modelos de programación de Service Fabric](https://azure.microsoft.com/documentation/articles/service-fabric-choose-framework/) prescriptivos adicionales y opcionales como [servicios con estado](https://azure.microsoft.com/documentation/articles/service-fabric-reliable-services-introduction/) y [Reliable Actors](https://azure.microsoft.com/documentation/articles/service-fabric-reliable-actors-introduction/).</span><span class="sxs-lookup"><span data-stu-id="47ace-151">*Service Fabric* provides additional and optional prescriptive [Service Fabric programming models](https://azure.microsoft.com/documentation/articles/service-fabric-choose-framework/) like [stateful services](https://azure.microsoft.com/documentation/articles/service-fabric-reliable-services-introduction/) and [Reliable Actors](https://azure.microsoft.com/documentation/articles/service-fabric-reliable-actors-introduction/).</span></span> <br/> <br/> <span data-ttu-id="47ace-152">*Service Fabric* está más desarrollado en Windows (con años de evolución en Windows) que en Linux.</span><span class="sxs-lookup"><span data-stu-id="47ace-152">*Service Fabric* is mature in Windows (years evolving in Windows), less mature in Linux.</span></span> <br/> <br/> <span data-ttu-id="47ace-153">Tanto los contenedores de Linux como los de Windows son compatibles con Service Fabric desde 2017.</span><span class="sxs-lookup"><span data-stu-id="47ace-153">Both Linux and Windows containers are supported in Service Fabric since 2017.</span></span> |
| <span data-ttu-id="47ace-154">**Azure Service Fabric Mesh**</span><span class="sxs-lookup"><span data-stu-id="47ace-154">**Azure Service Fabric Mesh**</span></span> <br/> <span data-ttu-id="47ace-155">![Logotipo de Azure Service Fabric Mesh](./media/azure-service-fabric-mesh-logo.png)</span><span class="sxs-lookup"><span data-stu-id="47ace-155">![Azure Service Fabric Mesh Logo](./media/azure-service-fabric-mesh-logo.png)</span></span> | <span data-ttu-id="47ace-156">[*Azure Service Fabric Mesh*](https://docs.microsoft.com/azure/service-fabric-mesh/service-fabric-mesh-overview) ofrece el mismo nivel de fiabilidad, rendimiento crítico y escala que Service Fabric, pero también proporciona una plataforma totalmente administrada y sin servidor.</span><span class="sxs-lookup"><span data-stu-id="47ace-156">[*Azure Service Fabric Mesh*](https://docs.microsoft.com/azure/service-fabric-mesh/service-fabric-mesh-overview) offers the same reliability, mission-critical performance and scale as Service Fabric, but also offers a fully managed and serverless platform.</span></span> <span data-ttu-id="47ace-157">No es necesario administrar un clúster, las máquinas virtuales, el almacenamiento o la configuración de red.</span><span class="sxs-lookup"><span data-stu-id="47ace-157">You don't need to manage a cluster, VMs, storage or networking configuration.</span></span> <span data-ttu-id="47ace-158">Puede centrarse en el desarrollo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="47ace-158">You just focus on your application's development.</span></span> <br/> <br/> <span data-ttu-id="47ace-159">*Service Fabric Mesh* admite contenedores de Windows y Linux, lo que permite desarrollar con cualquier lenguaje de programación y marco de trabajo que elija.</span><span class="sxs-lookup"><span data-stu-id="47ace-159">*Service Fabric Mesh* supports both Windows and Linux containers, allowing you to develop with any programming language and framework of your choice.</span></span>

## <a name="using-container-based-orchestrators-in-azure"></a><span data-ttu-id="47ace-160">Uso de orquestadores basados en contenedor en Azure</span><span class="sxs-lookup"><span data-stu-id="47ace-160">Using container-based orchestrators in Azure</span></span>

<span data-ttu-id="47ace-161">Existen varios proveedores de nube que ofrecen compatibilidad con contenedores de Docker más compatibilidad con la orquestación y los clústeres de Docker, como Azure, Amazon EC2 Container Service y Google Container Engine.</span><span class="sxs-lookup"><span data-stu-id="47ace-161">Several cloud vendors offer Docker containers support plus Docker clusters and orchestration support, including Azure, Amazon EC2 Container Service, and Google Container Engine.</span></span> <span data-ttu-id="47ace-162">Azure proporciona compatibilidad con el orquestador y el clúster de Docker a través de Azure Kubernetes Service (AKS), Azure Service Fabric y Azure Service Fabric Mesh.</span><span class="sxs-lookup"><span data-stu-id="47ace-162">Azure provides Docker cluster and orchestrator support through Azure Kubernetes Service (AKS), Azure Service Fabric, and Azure Service Fabric Mesh.</span></span>

## <a name="using-azure-kubernetes-service"></a><span data-ttu-id="47ace-163">Uso de Azure Kubernetes Service</span><span class="sxs-lookup"><span data-stu-id="47ace-163">Using Azure Kubernetes Service</span></span>

<span data-ttu-id="47ace-164">Un clúster de Kubernetes agrupa varios hosts de Docker y los expone como un único host virtual de Docker, lo que permite implementar varios contenedores en el clúster y escalar horizontalmente con cualquier número de instancias de contenedor.</span><span class="sxs-lookup"><span data-stu-id="47ace-164">A Kubernetes cluster pools several Docker hosts and exposes them as a single virtual Docker host, so you can deploy multiple containers into the cluster and scale-out with any number of container instances.</span></span> <span data-ttu-id="47ace-165">El clúster controlará toda la mecánica de administración compleja, como la escalabilidad, el estado, etc.</span><span class="sxs-lookup"><span data-stu-id="47ace-165">The cluster will handle all the complex management plumbing, like scalability, health, and so forth.</span></span>

<span data-ttu-id="47ace-166">AKS proporciona una manera de simplificar la creación, la configuración y la administración de un clúster de máquinas virtuales en Azure que están preconfiguradas para ejecutar aplicaciones en contenedores.</span><span class="sxs-lookup"><span data-stu-id="47ace-166">AKS provides a way to simplify the creation, configuration, and management of a cluster of virtual machines in Azure that are preconfigured to run containerized applications.</span></span> <span data-ttu-id="47ace-167">Al utilizar una configuración optimizada de herramientas de orquestación y programación de código abierto populares, AKS le permite usar sus habilidades existentes o aprovechar un gran corpus creciente de conocimientos de la comunidad para implementar y administrar aplicaciones basadas en contenedor en Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="47ace-167">Using an optimized configuration of popular open-source scheduling and orchestration tools, AKS enables you to use your existing skills or draw on a large and growing body of community expertise to deploy and manage container-based applications on Microsoft Azure.</span></span>

<span data-ttu-id="47ace-168">Azure Kubernetes Service optimiza la configuración de tecnologías y herramientas populares de código abierto de agrupación en clústeres de Docker específicamente para Azure.</span><span class="sxs-lookup"><span data-stu-id="47ace-168">Azure Kubernetes Service optimizes the configuration of popular Docker clustering open-source tools and technologies specifically for Azure.</span></span> <span data-ttu-id="47ace-169">Se trata de una solución abierta que ofrece la portabilidad de los contenedores y la configuración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="47ace-169">You get an open solution that offers portability for both your containers and your application configuration.</span></span> <span data-ttu-id="47ace-170">Seleccione el tamaño, el número de hosts y las herramientas de orquestador, y AKS se encarga de todo lo demás.</span><span class="sxs-lookup"><span data-stu-id="47ace-170">You select the size, the number of hosts, and the orchestrator tools, and AKS handles everything else.</span></span>

![Estructura de un clúster de Kubernetes: hay un nodo maestro que controla el DNS, el programador, el proxy, etc., y varios nodos de trabajo, que hospedan los contenedores.](media/image36.png)

<span data-ttu-id="47ace-172">**Figura 4-7**.</span><span class="sxs-lookup"><span data-stu-id="47ace-172">**Figure 4-7**.</span></span> <span data-ttu-id="47ace-173">Topología y estructura simplificada del clúster de Kubernetes</span><span class="sxs-lookup"><span data-stu-id="47ace-173">Kubernetes cluster's simplified structure and topology</span></span>

<span data-ttu-id="47ace-174">En la figura 4-7 se muestra la estructura de un clúster de Kubernetes, donde un nodo maestro (VM) controla la mayor parte de la coordinación del clúster y puede implementar contenedores en el resto de los nodos que se administran como un único grupo desde el punto de vista de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="47ace-174">Figure 4-7 shows the structure of a Kubernetes cluster where a master node (VM) controls most of the coordination of the cluster, and you can deploy containers to the rest of the nodes that are managed as a single pool from an application point of view.</span></span> <span data-ttu-id="47ace-175">Esto le permite escalar a miles o incluso a decenas de miles de contenedores.</span><span class="sxs-lookup"><span data-stu-id="47ace-175">This allows you to scale to thousands or even tens of thousands of containers.</span></span>

## <a name="development-environment-for-kubernetes"></a><span data-ttu-id="47ace-176">Entorno de desarrollo para Kubernetes</span><span class="sxs-lookup"><span data-stu-id="47ace-176">Development environment for Kubernetes</span></span>

<span data-ttu-id="47ace-177">En el entorno de desarrollo, [Docker anunció en julio de 2018](https://blog.docker.com/2018/07/kubernetes-is-now-available-in-docker-desktop-stable-channel/) que Kubernetes también puede ejecutarse en un único equipo de desarrollo (Windows 10 o macOS). Basta con instalar [Docker Desktop](https://www.docker.com/community-edition).</span><span class="sxs-lookup"><span data-stu-id="47ace-177">In the development environment that [Docker announced in July 2018](https://blog.docker.com/2018/07/kubernetes-is-now-available-in-docker-desktop-stable-channel/), Kubernetes can also run in a single development machine (Windows 10 or macOS) by just installing [Docker Desktop](https://www.docker.com/community-edition).</span></span> <span data-ttu-id="47ace-178">Puede implementar posteriormente en la nube (AKS) para obtener más pruebas de integración, como se muestra en la figura 4-8.</span><span class="sxs-lookup"><span data-stu-id="47ace-178">You can later deploy to the cloud (AKS) for further integration tests, as shown in figure 4-8.</span></span>

![En julio de 2018, Docker anunció asistencia del equipo de desarrollo para los clústeres de Kubernetes con Docker Desktop.](media/kubernetes-development-environment.png)

<span data-ttu-id="47ace-180">**Figura 4-8**.</span><span class="sxs-lookup"><span data-stu-id="47ace-180">**Figure 4-8**.</span></span> <span data-ttu-id="47ace-181">Ejecución de Kubernetes en el equipo de desarrollo y la nube</span><span class="sxs-lookup"><span data-stu-id="47ace-181">Running Kubernetes in dev machine and the cloud</span></span>

## <a name="get-started-with-azure-kubernetes-service-aks"></a><span data-ttu-id="47ace-182">Introducción a Azure Kubernetes Service (AKS)</span><span class="sxs-lookup"><span data-stu-id="47ace-182">Get started with Azure Kubernetes Service (AKS)</span></span>

<span data-ttu-id="47ace-183">Para empezar a usar AKS, implemente un clúster de AKS desde Azure Portal o mediante la CLI.</span><span class="sxs-lookup"><span data-stu-id="47ace-183">To begin using AKS, you deploy an AKS cluster from the Azure portal or by using the CLI.</span></span> <span data-ttu-id="47ace-184">Para obtener más información sobre la implementación de un clúster de Kubernetes en Azure, vea [Inicio rápido: Implementación de un clúster de Azure Kubernetes Service (AKS)](https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal).</span><span class="sxs-lookup"><span data-stu-id="47ace-184">For more information on deploying a Kubernetes cluster to Azure, see [Deploy an Azure Kubernetes Service (AKS) cluster](https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal).</span></span>

<span data-ttu-id="47ace-185">No hay cuotas para el software instalado de forma predeterminada como parte de AKS.</span><span class="sxs-lookup"><span data-stu-id="47ace-185">There are no fees for any of the software installed by default as part of AKS.</span></span> <span data-ttu-id="47ace-186">Todas las opciones predeterminadas se implementan con el software de código abierto.</span><span class="sxs-lookup"><span data-stu-id="47ace-186">All default options are implemented with open-source software.</span></span> <span data-ttu-id="47ace-187">AKS está disponible en varias máquinas virtuales en Azure.</span><span class="sxs-lookup"><span data-stu-id="47ace-187">AKS is available for multiple virtual machines in Azure.</span></span> <span data-ttu-id="47ace-188">Se cobra únicamente por las instancias de proceso que se elijan, así como por los otros recursos subyacentes de la infraestructura que se utilicen como, por ejemplo, la red y el almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="47ace-188">You're charged only for the compute instances you choose, as well as the other underlying infrastructure resources consumed, such as storage and networking.</span></span> <span data-ttu-id="47ace-189">No hay ningún cargo incremental para AKS.</span><span class="sxs-lookup"><span data-stu-id="47ace-189">There are no incremental charges for AKS itself.</span></span>

<span data-ttu-id="47ace-190">Para obtener más información de implementación sobre la implementación en Kubernetes en función de `kubectl` y archivos `.yaml` originales, vea la publicación [Setting eShopOnContainers up in AKS (Azure Kubernetes Service)](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.-Setting-the-solution-up-in-AKS-(Azure-Kubernetes-Service)) (Configuración de eShopOnContainers en AKS [Azure Kubernetes Service]).</span><span class="sxs-lookup"><span data-stu-id="47ace-190">For further implementation information on deployment to Kubernetes based on `kubectl` and original `.yaml` files, see the post on [Setting eShopOnContainers up in AKS (Azure Kubernetes Service)](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.-Setting-the-solution-up-in-AKS-(Azure-Kubernetes-Service)).</span></span>

## <a name="deploy-with-helm-charts-into-kubernetes-clusters"></a><span data-ttu-id="47ace-191">Implementación con gráficos de Helm en clústeres de Kubernetes</span><span class="sxs-lookup"><span data-stu-id="47ace-191">Deploy with Helm charts into Kubernetes clusters</span></span>

<span data-ttu-id="47ace-192">Al implementar una aplicación en un clúster de Kubernetes, puede usar la herramienta de CLI `kubectl.exe` original mediante archivos de implementación basados en el formato nativo (archivos `.yaml`), como ya se mencionó en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="47ace-192">When deploying an application to a Kubernetes cluster, you can use the original `kubectl.exe` CLI tool using deployment files based on the native format (`.yaml` files), as already mentioned in the previous section.</span></span> <span data-ttu-id="47ace-193">Pero, para aplicaciones de Kubernetes más complejas, como al implementar aplicaciones complejas basadas en microservicios, se recomienda usar [Helm](https://helm.sh/).</span><span class="sxs-lookup"><span data-stu-id="47ace-193">However, for more complex Kubernetes applications such as when deploying complex microservice-based applications, it's recommended to use [Helm](https://helm.sh/).</span></span>

<span data-ttu-id="47ace-194">Los gráficos de Helm le ayudan a definir, establecer la versión, instalar, compartir, actualizar o revertir incluso la aplicación más compleja de Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="47ace-194">Helm Charts helps you define, version, install, share, upgrade, or rollback even the most complex Kubernetes application.</span></span>

<span data-ttu-id="47ace-195">Adicionalmente, el uso de Helm se recomienda porque otros entornos de Kubernetes en Azure, como [Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces), también se basan en los gráficos de Helm.</span><span class="sxs-lookup"><span data-stu-id="47ace-195">Going further, Helm usage is also recommended because additional Kubernetes environments in Azure, such as [Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces) are also based on Helm charts.</span></span>

<span data-ttu-id="47ace-196">La [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) mantiene Helm en colaboración con Microsoft, Google, Bitnami y la comunidad de colaboradores de Helm.</span><span class="sxs-lookup"><span data-stu-id="47ace-196">Helm is maintained by the [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) in collaboration with Microsoft, Google, Bitnami, and the Helm contributor community.</span></span>

<span data-ttu-id="47ace-197">Para obtener más información sobre la implementación de gráficos de Helm y Kubernetes, vea la entrada de blog [Using Helm Charts to deploy eShopOnContainers to AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.1-Deploying-to-AKS-using-Helm-Charts) (Uso de gráficos de Helm para implementar eShopOnContainers en AKS).</span><span class="sxs-lookup"><span data-stu-id="47ace-197">For further implementation information on Helm charts and Kubernetes, see the post on [Using Helm Charts to deploy eShopOnContainers to AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.1-Deploying-to-AKS-using-Helm-Charts).</span></span>

## <a name="use-azure-dev-spaces-for-you-kubernetes-application-lifecycle"></a><span data-ttu-id="47ace-198">Uso de Azure Dev Spaces para el ciclo de vida de la aplicación de Kubernetes</span><span class="sxs-lookup"><span data-stu-id="47ace-198">Use Azure Dev Spaces for you Kubernetes application lifecycle</span></span>

<span data-ttu-id="47ace-199">[Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces) proporciona una experiencia de desarrollo de Kubernetes rápida e iterativa para los equipos.</span><span class="sxs-lookup"><span data-stu-id="47ace-199">[Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces) provides a rapid, iterative Kubernetes development experience for teams.</span></span> <span data-ttu-id="47ace-200">Con una configuración de máquina de desarrollo mínima, puede ejecutar y depurar contenedores de forma iterativa directamente en Azure Kubernetes Service (AKS).</span><span class="sxs-lookup"><span data-stu-id="47ace-200">With minimal dev machine setup, you can iteratively run and debug containers directly in Azure Kubernetes Service (AKS).</span></span> <span data-ttu-id="47ace-201">Puede desarrollar en Windows, Mac o Linux mediante herramientas familiares como Visual Studio, Visual Studio Code o la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="47ace-201">You can develop on Windows, Mac, or Linux using familiar tools like Visual Studio, Visual Studio Code, or the command line.</span></span>

<span data-ttu-id="47ace-202">Como ya se ha mencionado, Azure Dev Spaces usa gráficos de Helm al implementar aplicaciones basadas en contenedores.</span><span class="sxs-lookup"><span data-stu-id="47ace-202">As mentioned, Azure Dev Spaces uses Helm charts when deploying container-based applications.</span></span>

<span data-ttu-id="47ace-203">Azure Dev Spaces ayuda a los equipos de desarrollo a ser más productivos en Kubernetes porque permite iterar con rapidez y depurar código directamente en un clúster de Kubernetes global en Azure simplemente mediante el uso de Visual Studio 2017 o Visual Studio Code.</span><span class="sxs-lookup"><span data-stu-id="47ace-203">Azure Dev Spaces helps development teams be more productive on Kubernetes because it allows you to rapidly iterate and debug code directly in a global Kubernetes cluster in Azure by just using Visual Studio 2017 or Visual Studio Code.</span></span> <span data-ttu-id="47ace-204">Ese clúster de Kubernetes en Azure es un clúster de Kubernetes administrado compartido, por lo que su equipo puede colaborar.</span><span class="sxs-lookup"><span data-stu-id="47ace-204">That Kubernetes cluster in Azure is a shared managed Kubernetes cluster, so your team can collaboratively work together.</span></span> <span data-ttu-id="47ace-205">Puede desarrollar código de forma aislada, después implementarlo en el clúster global y realizar pruebas de un extremo a otro con otros componentes sin tener que replicar ni simular dependencias.</span><span class="sxs-lookup"><span data-stu-id="47ace-205">You can develop your code in isolation, then deploy to the global cluster and do end-to-end testing with other components without replicating or mocking up dependencies.</span></span>

<span data-ttu-id="47ace-206">Como se muestra en la figura 4-9, la característica distintiva de Azure Dev Spaces es la capacidad de crear "espacios" que se pueden ejecutar integrados al resto de la implementación global en el clúster.</span><span class="sxs-lookup"><span data-stu-id="47ace-206">As shown in figure 4-9, the most differentiating feature in Azure Dev Spaces is the capability of creating 'spaces' that can run integrated to the rest of the global deployment in the cluster.</span></span>

![Azure Dev Spaces puede mezclar y combinar de forma transparente los microservicios de producción con la instancia de contenedor de desarrollo para facilitar las pruebas de nuevas versiones.](media/image38.png)

<span data-ttu-id="47ace-208">**Figura 4-9**.</span><span class="sxs-lookup"><span data-stu-id="47ace-208">**Figure 4-9**.</span></span> <span data-ttu-id="47ace-209">Uso de varios espacios en Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="47ace-209">Using multiple spaces in Azure Dev Spaces</span></span>

<span data-ttu-id="47ace-210">Básicamente, puede configurar un espacio de desarrollo compartido en Azure.</span><span class="sxs-lookup"><span data-stu-id="47ace-210">Basically, you can set up a shared dev space in Azure.</span></span> <span data-ttu-id="47ace-211">Así, cada programador se puede centrar exclusivamente en su parte de la aplicación y desarrollar de forma iterativa código previo a la confirmación en un espacio de desarrollo que ya contenga todos los demás servicios y recursos en la nube de los que sus escenarios dependen.</span><span class="sxs-lookup"><span data-stu-id="47ace-211">Each developer can focus on just their part of the application, and can iteratively develop "pre-committed" code in a dev space that already contains all the other services and cloud resources that their scenarios depend on.</span></span> <span data-ttu-id="47ace-212">Las dependencias siempre estarán actualizadas y los desarrolladores trabajarán de una manera que se asemeja bastante a un entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="47ace-212">Dependencies are always up-to-date, and developers are working in a way that mirrors production.</span></span>

<span data-ttu-id="47ace-213">En Azure Dev Spaces existe el concepto de espacio, que permite trabajar de manera aislada y sin riesgo de romper el código de los miembros del equipo.</span><span class="sxs-lookup"><span data-stu-id="47ace-213">Azure Dev Spaces provides the concept of a space, which allows you to work in isolation and without the fear of breaking your team members.</span></span> <span data-ttu-id="47ace-214">Esta característica se basa en prefijos de dirección URL. Si usa un prefijo de espacio de desarrollo en la dirección URL para la solicitud de un contenedor, Azure Dev Spaces ejecutará una versión especial del contenedor que se implementa para ese espacio, si existe.</span><span class="sxs-lookup"><span data-stu-id="47ace-214">This feature is based on URL prefixes; if you use a dev space prefix in the URL for a container's request, Azure Dev Spaces runs a special version of the container that it deployed for that space, if one exists.</span></span> <span data-ttu-id="47ace-215">En caso contrario, se ejecutará la versión global o consolidada.</span><span class="sxs-lookup"><span data-stu-id="47ace-215">Otherwise, it will run the global/consolidated version.</span></span>

<span data-ttu-id="47ace-216">Puede ver la [página wiki de eShopOnContainers en Azure Dev Spaces](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.2-Using-Azure-Dev-Spaces-and-AKS) para obtener una vista práctica en un ejemplo concreto.</span><span class="sxs-lookup"><span data-stu-id="47ace-216">You can see the [eShopOnContainers wiki page on Azure Dev Spaces](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.2-Using-Azure-Dev-Spaces-and-AKS) to get a practical view on a concrete example.</span></span>

<span data-ttu-id="47ace-217">Para obtener más información, vea el artículo [Desarrollo en equipo con Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/team-development-netcore).</span><span class="sxs-lookup"><span data-stu-id="47ace-217">For further information, see the article on [Team Development with Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/team-development-netcore).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="47ace-218">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="47ace-218">Additional resources</span></span>

- <span data-ttu-id="47ace-219">**Guía de inicio rápido: Implementación de un clúster de Azure Kubernetes Service (AKS)**  </span><span class="sxs-lookup"><span data-stu-id="47ace-219">**Getting started with Azure Kubernetes Service (AKS)** </span></span>\
  <https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal>

- <span data-ttu-id="47ace-220">**Azure Dev Spaces** </span><span class="sxs-lookup"><span data-stu-id="47ace-220">**Azure Dev Spaces** </span></span>\
  <https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces>

- <span data-ttu-id="47ace-221">**Kubernetes.**</span><span class="sxs-lookup"><span data-stu-id="47ace-221">**Kubernetes.**</span></span> <span data-ttu-id="47ace-222">Sitio oficial.</span><span class="sxs-lookup"><span data-stu-id="47ace-222">The official site.</span></span> \
  <https://kubernetes.io/>

## <a name="using-azure-service-fabric"></a><span data-ttu-id="47ace-223">Uso de Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="47ace-223">Using Azure Service Fabric</span></span>

<span data-ttu-id="47ace-224">Azure Service Fabric surgió de la transición que Microsoft realizó al dejar de ofrecer productos empaquetados, que normalmente tenían un estilo monolítico, para ofrecer servicios.</span><span class="sxs-lookup"><span data-stu-id="47ace-224">Azure Service Fabric arose from Microsoft's transition from delivering "box" products, which were typically monolithic in style, to delivering services.</span></span> <span data-ttu-id="47ace-225">La experiencia de crear y usar servicios de gran tamaño a escala, como Azure SQL Database, Azure Cosmos DB, Azure Service Bus o Backend de Cortana, definió el formato de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="47ace-225">The experience of building and operating large services at scale, such as Azure SQL Database, Azure Cosmos DB, Azure Service Bus, or Cortana's Backend, shaped Service Fabric.</span></span> <span data-ttu-id="47ace-226">La plataforma evolucionó con el tiempo, a medida que la adoptaron cada vez más servicios.</span><span class="sxs-lookup"><span data-stu-id="47ace-226">The platform evolved over time as more and more services adopted it.</span></span> <span data-ttu-id="47ace-227">Cabe destacar que Service Fabric tuvo que ejecutarse no solo en Azure sino también en implementaciones independientes de Windows Server.</span><span class="sxs-lookup"><span data-stu-id="47ace-227">Importantly, Service Fabric had to run not only in Azure but also in standalone Windows Server deployments.</span></span>

<span data-ttu-id="47ace-228">El objetivo de Service Fabric es solucionar los arduos problemas de compilar y ejecutar un servicio y usar recursos de infraestructura de forma eficaz, de manera que los equipos puedan resolver problemas empresariales con un enfoque de microservicios.</span><span class="sxs-lookup"><span data-stu-id="47ace-228">The aim of Service Fabric is to solve the hard problems of building and running a service and utilizing infrastructure resources efficiently, so that teams can solve business problems using a microservices approach.</span></span>

<span data-ttu-id="47ace-229">Service Fabric proporciona dos áreas generales para ayudarlo a crear aplicaciones que usan un enfoque de microservicios:</span><span class="sxs-lookup"><span data-stu-id="47ace-229">Service Fabric provides two broad areas to help you build applications that use a microservices approach:</span></span>

- <span data-ttu-id="47ace-230">Una plataforma que proporciona servicios de sistema para implementar, escalar, actualizar, detectar y reiniciar servicios erróneos, detectar la ubicación del servicio, administrar el estado y supervisar el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="47ace-230">A platform that provides system services to deploy, scale, upgrade, detect, and restart failed services, discover service location, manage state, and monitor health.</span></span> <span data-ttu-id="47ace-231">Estos servicios de sistema efectivamente habilitan muchas de las características de microservicios descritas anteriormente.</span><span class="sxs-lookup"><span data-stu-id="47ace-231">These system services in effect enable many of the characteristics of microservices described previously.</span></span>

- <span data-ttu-id="47ace-232">Programar API, o marcos, para ayudarlo a crear aplicaciones como microservicios: [actores fiables y servicios de confianza](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework).</span><span class="sxs-lookup"><span data-stu-id="47ace-232">Programming APIs, or frameworks, to help you build applications as microservices: [reliable actors and reliable services](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework).</span></span> <span data-ttu-id="47ace-233">Puede elegir cualquier código para generar el microservicio, pero estas API facilitan el trabajo y se integran con la plataforma a un nivel más profundo.</span><span class="sxs-lookup"><span data-stu-id="47ace-233">You can choose any code to build your microservice, but these APIs make the job more straightforward, and they integrate with the platform at a deeper level.</span></span> <span data-ttu-id="47ace-234">De este modo, puede obtener información de mantenimiento y diagnóstico o puede sacar partido de la administración de estado confiable.</span><span class="sxs-lookup"><span data-stu-id="47ace-234">This way you can get health and diagnostics information, or you can take advantage of reliable state management.</span></span>

<span data-ttu-id="47ace-235">Para crear su servicio puede usar cualquier tecnología ya que Service Fabric no interviene en el proceso.</span><span class="sxs-lookup"><span data-stu-id="47ace-235">Service Fabric is agnostic with respect to how you build your service, and you can use any technology.</span></span> <span data-ttu-id="47ace-236">Sin embargo, proporciona API de programación integradas que facilitan la creación de microservicios.</span><span class="sxs-lookup"><span data-stu-id="47ace-236">However, it provides built-in programming APIs that make it easier to build microservices.</span></span>

<span data-ttu-id="47ace-237">Como se muestra en la figura 4-10, puede crear y ejecutar microservicios en Service Fabric como procesos simples o como contenedores de Docker.</span><span class="sxs-lookup"><span data-stu-id="47ace-237">As shown in Figure 4-10, you can create and run microservices in Service Fabric either as simple processes or as Docker containers.</span></span> <span data-ttu-id="47ace-238">También es posible mezclar microservicios basados en contenedores con microservicios basados en procesos en el mismo clúster de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="47ace-238">It's also possible to mix container-based microservices with process-based microservices within the same Service Fabric cluster.</span></span>

![Comparación de clústeres de Azure Service Fabric: microservicios como procesos, donde cada nodo ejecuta un proceso para cada microservicio; microservicios como contenedores, donde cada nodo ejecuta Docker con varios contenedores, un contenedor por microservicio.](./media/azure-service-fabric-cluster-types.png)

<span data-ttu-id="47ace-240">**Figura 4-10**.</span><span class="sxs-lookup"><span data-stu-id="47ace-240">**Figure 4-10**.</span></span> <span data-ttu-id="47ace-241">Implementar microservicios como procesos o como contenedores en Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="47ace-241">Deploying microservices as processes or as containers in Azure Service Fabric</span></span>

<span data-ttu-id="47ace-242">Los clústeres de Service Fabric basados en hosts de Linux y Windows pueden ejecutar contenedores de Docker Linux y Windows, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="47ace-242">Service Fabric clusters based on Linux and Windows hosts can run Docker Linux containers and Windows Containers, respectively.</span></span>

<span data-ttu-id="47ace-243">Para más información actualizada sobre la compatibilidad con contenedores en Azure Service Fabric, vea [Service Fabric y contenedores](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span><span class="sxs-lookup"><span data-stu-id="47ace-243">For up-to-date information about containers support in Azure Service Fabric, see [Service Fabric and containers](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span></span>

<span data-ttu-id="47ace-244">Service Fabric es un buen ejemplo de una plataforma en la que puede definir una arquitectura lógica diferente (microservicios empresariales o contextos limitados) de la implementación física.</span><span class="sxs-lookup"><span data-stu-id="47ace-244">Service Fabric is a good example of a platform where you can define a different logical architecture (business microservices or Bounded Contexts) than the physical implementation.</span></span> <span data-ttu-id="47ace-245">Por ejemplo, si implementa en [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview) los [servicios de confianza con estado](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction), que se describen más adelante en la sección [Microservicios sin estado frente a microservicios con estado](#stateless-versus-stateful-microservices), puede tener un concepto de microservicio empresarial con varios servicios físicos.</span><span class="sxs-lookup"><span data-stu-id="47ace-245">For example, if you implement [Stateful Reliable Services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) in [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview), which are introduced in the next section, "[Stateless versus stateful microservices](#stateless-versus-stateful-microservices)," you have a business microservice concept with multiple physical services.</span></span>

<span data-ttu-id="47ace-246">Como se muestra en la figura 4-10, y bajo una perspectiva de microservicio lógico o empresarial, al implementar un servicio de confianza con estado de Service Fabric, normalmente deberá implementar dos niveles de servicios.</span><span class="sxs-lookup"><span data-stu-id="47ace-246">As shown in Figure 4-10, and thinking from a logical/business microservice perspective, when implementing a Service Fabric Stateful Reliable Service, you usually will need to implement two tiers of services.</span></span> <span data-ttu-id="47ace-247">El primero es el servicio de confianza con estado back-end, que administra varias particiones (cada partición es un servicio con estado).</span><span class="sxs-lookup"><span data-stu-id="47ace-247">The first is the back-end stateful reliable service, which handles multiple partitions (each partition is a stateful service).</span></span> <span data-ttu-id="47ace-248">El segundo es el servicio front-end, o servicio de puerta de enlace, que se encarga del enrutamiento y de la agregación de datos en varias particiones o instancias de servicio con estado.</span><span class="sxs-lookup"><span data-stu-id="47ace-248">The second is the front-end service, or Gateway service, in charge of routing and data aggregation across multiple partitions or stateful service instances.</span></span> <span data-ttu-id="47ace-249">Este servicio de puerta de enlace también controla la comunicación del lado cliente con los bucles de reintento que acceden al servicio back-end.</span><span class="sxs-lookup"><span data-stu-id="47ace-249">That Gateway service also handles client-side communication with retry loops accessing the back-end service.</span></span> <span data-ttu-id="47ace-250">Se denomina servicio de puerta de enlace si implementa el servicio personalizado, pero alternativamente también puede usar el [proxy inverso](https://docs.microsoft.com/azure/service-fabric/service-fabric-reverseproxy) estándar de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="47ace-250">It's called a Gateway service if you implement your custom service, or alternatively you can also use the out-of-the-box Service Fabric [reverse proxy](https://docs.microsoft.com/azure/service-fabric/service-fabric-reverseproxy).</span></span>

![Service Fabric está recomendado para admitir varios servicios de confianza con estado en contenedores.](./media/service-fabric-stateful-business-microservice.png)

<span data-ttu-id="47ace-252">**Figura 4-11**.</span><span class="sxs-lookup"><span data-stu-id="47ace-252">**Figure 4-11**.</span></span> <span data-ttu-id="47ace-253">Microservicio de negocio con varias instancias de servicio con estado y un front-end con puerta de enlace personalizado</span><span class="sxs-lookup"><span data-stu-id="47ace-253">Business microservice with several stateful service instances and a custom gateway front end</span></span>

<span data-ttu-id="47ace-254">En cualquier caso, al usar servicios de confianza con estado de Service Fabric, también dispone de un microservicio lógico o empresarial (contexto limitado) que se compone de varios servicios físicos.</span><span class="sxs-lookup"><span data-stu-id="47ace-254">In any case, when you use Service Fabric Stateful Reliable Services, you also have a logical or business microservice (Bounded Context) that's composed of multiple physical services.</span></span> <span data-ttu-id="47ace-255">Cada uno de ellos, el servicio de puerta de enlace y el servicio de partición podrían implementarse como servicios ASP.NET Web API, como se muestra en la figura 4-11.</span><span class="sxs-lookup"><span data-stu-id="47ace-255">Each of them, the Gateway service, and Partition service could be implemented as ASP.NET Web API services, as shown in Figure 4-11.</span></span>

<span data-ttu-id="47ace-256">En Service Fabric, puede agrupar e implementar grupos de servicios como una [aplicación de Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-model), que es la unidad de empaquetado e implementación para el orquestador o clúster.</span><span class="sxs-lookup"><span data-stu-id="47ace-256">In Service Fabric, you can group and deploy groups of services as a [Service Fabric Application](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-model), which is the unit of packaging and deployment for the orchestrator or cluster.</span></span> <span data-ttu-id="47ace-257">Por tanto, la aplicación de Service Fabric también podría asignarse a este límite de microservicio o contexto limitado lógico y empresarial autónomo, por lo que podría implementar estos servicios de forma autónoma.</span><span class="sxs-lookup"><span data-stu-id="47ace-257">Therefore, the Service Fabric Application could be mapped to this autonomous business and logical microservice boundary or Bounded Context, as well, so you could deploy these services autonomously.</span></span>

### <a name="service-fabric-and-containers"></a><span data-ttu-id="47ace-258">Service Fabric y contenedores</span><span class="sxs-lookup"><span data-stu-id="47ace-258">Service Fabric and containers</span></span>

<span data-ttu-id="47ace-259">Con respecto a los contenedores de Service Fabric, también puede implementar servicios en las imágenes de contenedor dentro de un clúster de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="47ace-259">With regard to containers in Service Fabric, you can also deploy services in container images within a Service Fabric cluster.</span></span> <span data-ttu-id="47ace-260">Como se muestra en la figura 4-12, la mayoría de las veces solo habrá un contenedor por cada servicio.</span><span class="sxs-lookup"><span data-stu-id="47ace-260">As Figure 4-12 shows, most of the time there will only be one container per service.</span></span>

![Una aplicación de Service Fabric puede ejecutar varios contenedores que acceden a una base de datos externa y el conjunto completo sería el límite lógico de un microservicio empresarial.](./media/azure-service-fabric-business-microservice.png)

<span data-ttu-id="47ace-262">**Figura 4-12**.</span><span class="sxs-lookup"><span data-stu-id="47ace-262">**Figure 4-12**.</span></span> <span data-ttu-id="47ace-263">Microservicio empresarial con varios servicios (contenedores) en Service Fabric</span><span class="sxs-lookup"><span data-stu-id="47ace-263">Business microservice with several services (containers) in Service Fabric</span></span>

<span data-ttu-id="47ace-264">Pero los contenedores llamados "asociados" (dos contenedores que deben implementarse conjuntamente como parte de un servicio lógico) también son posibles en Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="47ace-264">However, so-called "sidecar" containers (two containers that must be deployed together as part of a logical service) are also possible in Service Fabric.</span></span> <span data-ttu-id="47ace-265">Lo importante es que un microservicio empresarial sea el límite lógico alrededor de varios elementos cohesivos.</span><span class="sxs-lookup"><span data-stu-id="47ace-265">The important thing is that a business microservice is the logical boundary around several cohesive elements.</span></span> <span data-ttu-id="47ace-266">En muchos casos, puede que sea un único servicio con un solo modelo de datos, pero en otros casos también es posible que tenga varios servicios físicos.</span><span class="sxs-lookup"><span data-stu-id="47ace-266">In many cases, it might be a single service with a single data model, but in some other cases you might have several physical services as well.</span></span>

<span data-ttu-id="47ace-267">Tenga en cuenta que se pueden combinar servicios en procesos y servicios en contenedores en la misma aplicación de Service Fabric, como se muestra en la figura 4-13.</span><span class="sxs-lookup"><span data-stu-id="47ace-267">Note that you can mix services in processes, and services in containers, in the same Service Fabric application, as shown in Figure 4-13.</span></span>

![Una aplicación de Service Fabric ejecuta servicios y contenedores en el mismo nodo.](./media/business-microservice-mapped-to-service-fabric-application.png)

<span data-ttu-id="47ace-269">**Figura 4-13**.</span><span class="sxs-lookup"><span data-stu-id="47ace-269">**Figure 4-13**.</span></span> <span data-ttu-id="47ace-270">Microservicio empresarial asignado a una aplicación de Service Fabric con contenedores y servicios con estado</span><span class="sxs-lookup"><span data-stu-id="47ace-270">Business microservice mapped to a Service Fabric application with containers and stateful services</span></span>

<span data-ttu-id="47ace-271">Para más información sobre la compatibilidad de contenedor en Azure Service Fabric, vea [Service Fabric y contenedores](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span><span class="sxs-lookup"><span data-stu-id="47ace-271">For more information about container support in Azure Service Fabric, see [Service Fabric and containers](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span></span>

## <a name="stateless-versus-stateful-microservices"></a><span data-ttu-id="47ace-272">Microservicios sin estado frente a microservicios con estado</span><span class="sxs-lookup"><span data-stu-id="47ace-272">Stateless versus stateful microservices</span></span>

<span data-ttu-id="47ace-273">Como se ha mencionado anteriormente, cada microservicio (contexto limitado lógico) debe tener su modelo de dominio (datos y lógica).</span><span class="sxs-lookup"><span data-stu-id="47ace-273">As mentioned earlier, each microservice (logical Bounded Context) must own its domain model (data and logic).</span></span> <span data-ttu-id="47ace-274">En el caso de los microservicios sin estado, las bases de datos serán externas y se usarán opciones relacionales, como SQL Server, u opciones de NoSQL, como MongoDB o Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="47ace-274">In the case of stateless microservices, the databases will be external, employing relational options like SQL Server, or NoSQL options like Azure Cosmos DB or MongoDB.</span></span>

<span data-ttu-id="47ace-275">Pero los propios servicios también pueden ser con estado en Service Fabric, lo que significa que los datos se encuentran en el microservicio.</span><span class="sxs-lookup"><span data-stu-id="47ace-275">But the services themselves can also be stateful in Service Fabric, which means that the data resides within the microservice.</span></span> <span data-ttu-id="47ace-276">Estos datos pueden existir no solo en el mismo servidor, sino dentro del proceso del microservicio, en memoria, conservados en discos duros y replicados en otros nodos.</span><span class="sxs-lookup"><span data-stu-id="47ace-276">This data might exist not just on the same server, but within the microservice process, in memory and persisted on hard drives and replicated to other nodes.</span></span> <span data-ttu-id="47ace-277">En la figura 4-14 se muestran los distintos enfoques.</span><span class="sxs-lookup"><span data-stu-id="47ace-277">Figure 4-14 shows the different approaches.</span></span>

![En los servicios sin estado, el estado (persistencia, base de datos) se mantiene fuera del microservicio.](./media/stateless-vs-stateful-microservices.png)

<span data-ttu-id="47ace-280">**Figura 4-14**.</span><span class="sxs-lookup"><span data-stu-id="47ace-280">**Figure 4-14**.</span></span> <span data-ttu-id="47ace-281">Microservicios sin estado frente a microservicios con estado</span><span class="sxs-lookup"><span data-stu-id="47ace-281">Stateless versus stateful microservices</span></span>

<span data-ttu-id="47ace-282">Un enfoque sin estado es perfectamente válido y es más fácil de implementar que los microservicios con estado, ya que el enfoque es similar a los patrones tradicionales y conocidos.</span><span class="sxs-lookup"><span data-stu-id="47ace-282">A stateless approach is perfectly valid and is easier to implement than stateful microservices, since the approach is similar to traditional and well-known patterns.</span></span> <span data-ttu-id="47ace-283">Pero los microservicios sin estado imponen latencia entre el proceso y los orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="47ace-283">But stateless microservices impose latency between the process and data sources.</span></span> <span data-ttu-id="47ace-284">También implican más piezas móviles cuando se intenta mejorar el rendimiento con memoria caché y colas adicionales.</span><span class="sxs-lookup"><span data-stu-id="47ace-284">They also involve more moving pieces when you're trying to improve performance with additional cache and queues.</span></span> <span data-ttu-id="47ace-285">El resultado es que puede acabar con arquitecturas complejas que tienen demasiados niveles.</span><span class="sxs-lookup"><span data-stu-id="47ace-285">The result is that you can end up with complex architectures that have too many tiers.</span></span>

<span data-ttu-id="47ace-286">Por el contrario, los [microservicios con estado](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) pueden destacar en escenarios avanzados, ya que no hay latencia entre los datos y la lógica del dominio.</span><span class="sxs-lookup"><span data-stu-id="47ace-286">In contrast, [stateful microservices](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) can excel in advanced scenarios, because there's no latency between the domain logic and data.</span></span> <span data-ttu-id="47ace-287">El procesamiento intenso de datos, los back-ends de juegos, las bases de datos como servicio y otros escenarios con baja latencia se benefician de los servicios con estado, que habilitan el estado local para un acceso más rápido.</span><span class="sxs-lookup"><span data-stu-id="47ace-287">Heavy data processing, gaming back ends, databases as a service, and other low-latency scenarios all benefit from stateful services, which enable local state for faster access.</span></span>

<span data-ttu-id="47ace-288">Los servicios sin estado y los servicios con estado se complementan.</span><span class="sxs-lookup"><span data-stu-id="47ace-288">Stateless and stateful services are complementary.</span></span> <span data-ttu-id="47ace-289">Por ejemplo, como puede ver en el diagrama de la derecha en la figura 4-14, un servicio con estado se puede dividir en varias particiones.</span><span class="sxs-lookup"><span data-stu-id="47ace-289">For instance, as you can see in the right diagram in Figure 4-14, a stateful service can be split into multiple partitions.</span></span> <span data-ttu-id="47ace-290">Para acceder a esas particiones, es posible que deba contar con un servicio sin estado que actúe como un servicio de puerta de enlace que sepa cómo dirigirse a cada partición en función de las claves de partición.</span><span class="sxs-lookup"><span data-stu-id="47ace-290">To access those partitions, you might need a stateless service acting as a gateway service that knows how to address each partition based on partition keys.</span></span>

<span data-ttu-id="47ace-291">Los servicios con estado tienen diversos inconvenientes.</span><span class="sxs-lookup"><span data-stu-id="47ace-291">Stateful services do have drawbacks.</span></span> <span data-ttu-id="47ace-292">Imponen un alto nivel de complejidad en el escalado horizontal. Las funciones que normalmente se implementarían mediante sistemas de bases de datos externas se debe abordar en tareas como la replicación de datos a través de microservicios con estado y la creación de particiones de datos.</span><span class="sxs-lookup"><span data-stu-id="47ace-292">They impose a high complexity level to be scaled out. Functionality that would usually be implemented by external database systems must be addressed for tasks such as data replication across stateful microservices and data partitioning.</span></span> <span data-ttu-id="47ace-293">Sin embargo, esta es una de las áreas en que un orquestador como [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-platform-architecture) con sus [servicios de confianza con estado](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) puede ayudar al máximo, ya que simplifica el desarrollo y el ciclo de vida de los microservicios con estado mediante la [API de Reliable Services](https://docs.microsoft.com/azure/service-fabric/service-fabric-work-with-reliable-collections) y [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span><span class="sxs-lookup"><span data-stu-id="47ace-293">However, this is one of the areas where an orchestrator like [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-platform-architecture) with its [stateful reliable services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) can help the most—by simplifying the development and lifecycle of stateful microservices using the [Reliable Services API](https://docs.microsoft.com/azure/service-fabric/service-fabric-work-with-reliable-collections) and [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span></span>

<span data-ttu-id="47ace-294">Otros marcos de microservicio que permiten los servicios con estado, que admiten el patrón de actor y que mejoran la tolerancia a errores y la latencia entre la lógica y los datos empresariales son Microsoft [Orleans](https://github.com/dotnet/orleans), de Microsoft Research, y [ Akka.NET](https://getakka.net/).</span><span class="sxs-lookup"><span data-stu-id="47ace-294">Other microservice frameworks that allow stateful services, that support the Actor pattern, and that improve fault tolerance and latency between business logic and data are Microsoft [Orleans](https://github.com/dotnet/orleans), from Microsoft Research, and [Akka.NET](https://getakka.net/).</span></span> <span data-ttu-id="47ace-295">Actualmente, ambos marcos están mejorando su compatibilidad con Docker.</span><span class="sxs-lookup"><span data-stu-id="47ace-295">Both frameworks are currently improving their support for Docker.</span></span>

<span data-ttu-id="47ace-296">Recuerde que los contenedores de Docker son sin estado.</span><span class="sxs-lookup"><span data-stu-id="47ace-296">Remember that Docker containers are themselves stateless.</span></span> <span data-ttu-id="47ace-297">Si quiere implementar un servicio con estado, debe contar con uno de los marcos prescriptivos y de nivel superior adicionales que se han indicado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="47ace-297">If you want to implement a stateful service, you need one of the additional prescriptive and higher-level frameworks noted earlier.</span></span>

## <a name="using-azure-service-fabric-mesh"></a><span data-ttu-id="47ace-298">Uso de Azure Service Fabric Mesh</span><span class="sxs-lookup"><span data-stu-id="47ace-298">Using Azure Service Fabric Mesh</span></span>

<span data-ttu-id="47ace-299">Azure Service Fabric Mesh es un servicio totalmente administrado que permite a los desarrolladores compilar e implementar aplicaciones críticas sin tener que administrar ninguna infraestructura.</span><span class="sxs-lookup"><span data-stu-id="47ace-299">Azure Service Fabric Mesh is a fully managed service that enables developers to build and deploy mission critical applications without managing any infrastructure.</span></span> <span data-ttu-id="47ace-300">Utilice Service Fabric Mesh para compilar y ejecutar aplicaciones de microservicios seguras y distribuidas que se escalan a petición.</span><span class="sxs-lookup"><span data-stu-id="47ace-300">Use Service Fabric Mesh to build and run secure, distributed microservices applications that scale on demand.</span></span>

<span data-ttu-id="47ace-301">Como se muestra en la figura 4-15, las aplicaciones hospedadas en Service Fabric Mesh se ejecutan y escalan sin preocuparse por la infraestructura de la que dependen.</span><span class="sxs-lookup"><span data-stu-id="47ace-301">As shown in figure 4-15, applications hosted on Service Fabric Mesh run and scale without you worrying about the infrastructure powering it.</span></span>

![Una aplicación de varios contenedores que se ejecuta en Docker Desktop puede implementarse en Azure Service Fabric Mesh sin preocuparse por la infraestructura.](media/image39.png)

<span data-ttu-id="47ace-303">**Figura 4-15**.</span><span class="sxs-lookup"><span data-stu-id="47ace-303">**Figure 4-15**.</span></span> <span data-ttu-id="47ace-304">Implementación de una aplicación de microservicios/contenedores en Service Fabric Mesh</span><span class="sxs-lookup"><span data-stu-id="47ace-304">Deploying a microservice/containers application to Service Fabric Mesh</span></span>

<span data-ttu-id="47ace-305">En segundo plano, Service Fabric Mesh consta de clústeres de miles de máquinas.</span><span class="sxs-lookup"><span data-stu-id="47ace-305">Under the covers, Service Fabric Mesh consists of clusters of thousands of machines.</span></span> <span data-ttu-id="47ace-306">Todas las operaciones de clúster se ocultan a los desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="47ace-306">All cluster operations are hidden from the developer.</span></span> <span data-ttu-id="47ace-307">Basta con cargar los contenedores y especificar los recursos necesarios, los requisitos de disponibilidad y los límites de recursos.</span><span class="sxs-lookup"><span data-stu-id="47ace-307">You simply need to upload your containers and specify resources you need, availability requirements, and resource limits.</span></span> <span data-ttu-id="47ace-308">Service Fabric Mesh asigna automáticamente la infraestructura solicitada por la implementación de la aplicación y también controla los errores de infraestructura, asegurándose de que las aplicaciones tienen una alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="47ace-308">Service Fabric Mesh automatically allocates the infrastructure requested by your application deployment and also handles infrastructure failures, making sure your applications are highly available.</span></span> <span data-ttu-id="47ace-309">Solo necesita preocuparse del estado y de la capacidad de respuesta de la aplicación, nunca de la infraestructura.</span><span class="sxs-lookup"><span data-stu-id="47ace-309">You only need to care about the health and responsiveness of your application, not the infrastructure.</span></span>

<span data-ttu-id="47ace-310">Para obtener más información, vea la [documentación de Service Fabric Mesh](https://docs.microsoft.com/azure/service-fabric-mesh/).</span><span class="sxs-lookup"><span data-stu-id="47ace-310">For further information, see the [Service Fabric Mesh documentation](https://docs.microsoft.com/azure/service-fabric-mesh/).</span></span>

## <a name="choosing-orchestrators-in-azure"></a><span data-ttu-id="47ace-311">Elección de orquestadores en Azure</span><span class="sxs-lookup"><span data-stu-id="47ace-311">Choosing orchestrators in Azure</span></span>

<span data-ttu-id="47ace-312">En la siguiente tabla se proporcionan instrucciones sobre qué orquestador se debe usar en función de las cargas de trabajo y el foco del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="47ace-312">The following table provides guidance on what orchestrator to use depending on workloads and OS focus.</span></span>

![Azure Kubernetes Services está más desarrollado en Linux que en Windows y se usa principalmente para la implementación de microservicios basados en contenedores.](media/image40.png)

<span data-ttu-id="47ace-315">**Figura 4-16**.</span><span class="sxs-lookup"><span data-stu-id="47ace-315">**Figure 4-16**.</span></span> <span data-ttu-id="47ace-316">Selección del orquestador en instrucciones de Azure</span><span class="sxs-lookup"><span data-stu-id="47ace-316">Orchestrator selection in Azure guidance</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="47ace-317">[Anterior](soa-applications.md)
>[Siguiente](deploy-azure-kubernetes-service.md)</span><span class="sxs-lookup"><span data-stu-id="47ace-317">[Previous](soa-applications.md)
[Next](deploy-azure-kubernetes-service.md)</span></span>
