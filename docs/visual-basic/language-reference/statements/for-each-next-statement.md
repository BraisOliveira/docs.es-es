---
title: Instrucción For Each...Next (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.ForEach
- vb.ForEachNext
- vb.Each
- ForEachNext
helpviewer_keywords:
- infinite loops
- Next statement [Visual Basic], For Each...Next
- endless loops
- loop structures [Visual Basic], For Each...Next
- loops, endless
- Each keyword [Visual Basic]
- instructions, repeating
- For Each statement [Visual Basic]
- collections, instruction repetition
- loops, infinite
- For Each...Next statements
- For keyword [Visual Basic], For Each...Next statements
- Exit statement [Visual Basic], For Each...Next statements
- iteration
ms.assetid: ebce3120-95c3-42b1-b70b-fa7da40c75e2
ms.openlocfilehash: 5081f80ad0da738ebb950bcd649af7a593582356
ms.sourcegitcommit: bce0586f0cccaae6d6cbd625d5a7b824d1d3de4b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/02/2019
ms.locfileid: "58824354"
---
# <a name="for-eachnext-statement-visual-basic"></a><span data-ttu-id="501a6-102">Instrucción For Each...Next (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="501a6-102">For Each...Next Statement (Visual Basic)</span></span>
<span data-ttu-id="501a6-103">Repite un grupo de instrucciones para cada elemento de una colección.</span><span class="sxs-lookup"><span data-stu-id="501a6-103">Repeats a group of statements for each element in a collection.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="501a6-104">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="501a6-104">Syntax</span></span>  
  
```  
For Each element [ As datatype ] In group  
    [ statements ]  
    [ Continue For ]  
    [ statements ]  
    [ Exit For ]  
    [ statements ]  
Next [ element ]  
```  
  
## <a name="parts"></a><span data-ttu-id="501a6-105">Elementos</span><span class="sxs-lookup"><span data-stu-id="501a6-105">Parts</span></span>  
  
|<span data-ttu-id="501a6-106">Término</span><span class="sxs-lookup"><span data-stu-id="501a6-106">Term</span></span>|<span data-ttu-id="501a6-107">de esquema JSON</span><span class="sxs-lookup"><span data-stu-id="501a6-107">Definition</span></span>|  
|---|---|  
|`element`|<span data-ttu-id="501a6-108">Necesario en el `For Each` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-108">Required in the `For Each` statement.</span></span> <span data-ttu-id="501a6-109">Opcional en el `Next` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-109">Optional in the `Next` statement.</span></span> <span data-ttu-id="501a6-110">Variable.</span><span class="sxs-lookup"><span data-stu-id="501a6-110">Variable.</span></span> <span data-ttu-id="501a6-111">Se utiliza para recorrer en iteración los elementos de la colección.</span><span class="sxs-lookup"><span data-stu-id="501a6-111">Used to iterate through the elements of the collection.</span></span>|  
|`datatype`|<span data-ttu-id="501a6-112">Es necesario si `element` ya no está declarado.</span><span class="sxs-lookup"><span data-stu-id="501a6-112">Required if `element` isn't already declared.</span></span> <span data-ttu-id="501a6-113">Tipo de datos de `element`.</span><span class="sxs-lookup"><span data-stu-id="501a6-113">Data type of `element`.</span></span>|  
|`group`|<span data-ttu-id="501a6-114">Obligatorio.</span><span class="sxs-lookup"><span data-stu-id="501a6-114">Required.</span></span> <span data-ttu-id="501a6-115">Una variable con un tipo que es un tipo de colección o el objeto.</span><span class="sxs-lookup"><span data-stu-id="501a6-115">A variable with a type that's a collection type or Object.</span></span> <span data-ttu-id="501a6-116">Hace referencia a la colección en el que el `statements` a repetirse.</span><span class="sxs-lookup"><span data-stu-id="501a6-116">Refers to the collection over which the `statements` are to be repeated.</span></span>|  
|`statements`|<span data-ttu-id="501a6-117">Opcional.</span><span class="sxs-lookup"><span data-stu-id="501a6-117">Optional.</span></span> <span data-ttu-id="501a6-118">Una o varias instrucciones entre `For Each` y `Next` que se ejecutan en cada elemento de `group`.</span><span class="sxs-lookup"><span data-stu-id="501a6-118">One or more statements between `For Each` and `Next` that run on each item in `group`.</span></span>|  
|`Continue For`|<span data-ttu-id="501a6-119">Opcional.</span><span class="sxs-lookup"><span data-stu-id="501a6-119">Optional.</span></span> <span data-ttu-id="501a6-120">Transfiere el control al principio de la `For Each` bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-120">Transfers control to the start of the `For Each` loop.</span></span>|  
|`Exit For`|<span data-ttu-id="501a6-121">Opcional.</span><span class="sxs-lookup"><span data-stu-id="501a6-121">Optional.</span></span> <span data-ttu-id="501a6-122">Transfiere el control fuera de la `For Each` bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-122">Transfers control out of the `For Each` loop.</span></span>|  
|`Next`|<span data-ttu-id="501a6-123">Obligatorio.</span><span class="sxs-lookup"><span data-stu-id="501a6-123">Required.</span></span> <span data-ttu-id="501a6-124">Termina la definición de la `For Each` bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-124">Terminates the definition of the `For Each` loop.</span></span>|  
  
## <a name="simple-example"></a><span data-ttu-id="501a6-125">Ejemplo sencillo</span><span class="sxs-lookup"><span data-stu-id="501a6-125">Simple Example</span></span>  
 <span data-ttu-id="501a6-126">Use un `For Each`... `Next` bucle cuando desea repetir un conjunto de instrucciones para cada elemento de una colección o matriz.</span><span class="sxs-lookup"><span data-stu-id="501a6-126">Use a `For Each`...`Next` loop when you want to repeat a set of statements for each element of a collection or array.</span></span>  
  
> [!TIP]
>  <span data-ttu-id="501a6-127">Un [para... Instrucción Next](../../../visual-basic/language-reference/statements/for-next-statement.md) funciona bien cuando puede asociar cada iteración de un bucle a una variable de control y determinar los valores inicial y final de la variable.</span><span class="sxs-lookup"><span data-stu-id="501a6-127">A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values.</span></span> <span data-ttu-id="501a6-128">Sin embargo, cuando se trata de una colección, el concepto de valores iniciales y finales no es significativo y no necesariamente saber cuántos elementos tiene la colección.</span><span class="sxs-lookup"><span data-stu-id="501a6-128">However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has.</span></span> <span data-ttu-id="501a6-129">En este tipo de caso, un `For Each`... `Next` bucle suele ser una opción mejor.</span><span class="sxs-lookup"><span data-stu-id="501a6-129">In this kind of case, a `For Each`...`Next` loop is often a better choice.</span></span>  
  
 <span data-ttu-id="501a6-130">En el ejemplo siguiente, la `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="501a6-130">In the following example, the `For Each`…`Next`</span></span> <span data-ttu-id="501a6-131">instrucción recorre en iteración todos los elementos de una colección de lista.</span><span class="sxs-lookup"><span data-stu-id="501a6-131">statement iterates through all the elements of a List collection.</span></span>  
  
 [!code-vb[VbVbalrStatements#121](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#121)]  
  
 <span data-ttu-id="501a6-132">Para obtener más ejemplos, vea [colecciones](../../../standard/collections/index.md) y [matrices](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="501a6-132">For more examples, see [Collections](../../../standard/collections/index.md) and [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span>  
  
## <a name="nested-loops"></a><span data-ttu-id="501a6-133">Bucles anidados</span><span class="sxs-lookup"><span data-stu-id="501a6-133">Nested Loops</span></span>  
 <span data-ttu-id="501a6-134">Puede anidar `For Each` bucles colocando un bucle dentro de otro.</span><span class="sxs-lookup"><span data-stu-id="501a6-134">You can nest `For Each` loops by putting one loop within another.</span></span>  
  
 <span data-ttu-id="501a6-135">En el ejemplo siguiente se muestra anidada `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="501a6-135">The following example demonstrates nested `For Each`…`Next`</span></span> <span data-ttu-id="501a6-136">estructuras.</span><span class="sxs-lookup"><span data-stu-id="501a6-136">structures.</span></span>  
  
 [!code-vb[VbVbalrStatements#122](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#122)]  
  
 <span data-ttu-id="501a6-137">Al anidar bucles, cada bucle debe tener un único `element` variable.</span><span class="sxs-lookup"><span data-stu-id="501a6-137">When you nest loops, each loop must have a unique `element` variable.</span></span>  
  
 <span data-ttu-id="501a6-138">También puede anidar diferentes tipos de estructuras de control entre sí.</span><span class="sxs-lookup"><span data-stu-id="501a6-138">You can also nest different kinds of control structures within each other.</span></span> <span data-ttu-id="501a6-139">Para obtener más información, consulte [estructuras de Control anidadas](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span><span class="sxs-lookup"><span data-stu-id="501a6-139">For more information, see [Nested Control Structures](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span></span>  
  
## <a name="exit-for-and-continue-for"></a><span data-ttu-id="501a6-140">Salir de y continuar para</span><span class="sxs-lookup"><span data-stu-id="501a6-140">Exit For and Continue For</span></span>  
 <span data-ttu-id="501a6-141">El [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) instrucción provoca la ejecución al salir el `For`...`Next`</span><span class="sxs-lookup"><span data-stu-id="501a6-141">The [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) statement causes execution to exit the `For`…`Next`</span></span> <span data-ttu-id="501a6-142">bucle y transfiere el control a la instrucción que sigue la `Next` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-142">loop and transfers control to the statement that follows the `Next` statement.</span></span>  
  
 <span data-ttu-id="501a6-143">El `Continue For` instrucción transfiere el control inmediatamente a la siguiente iteración del bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-143">The `Continue For` statement transfers control immediately to the next iteration of the loop.</span></span> <span data-ttu-id="501a6-144">Para obtener más información, consulte [instrucción Continue](../../../visual-basic/language-reference/statements/continue-statement.md).</span><span class="sxs-lookup"><span data-stu-id="501a6-144">For more information, see [Continue Statement](../../../visual-basic/language-reference/statements/continue-statement.md).</span></span>  
  
 <span data-ttu-id="501a6-145">El ejemplo siguiente muestra cómo usar el `Continue For` y `Exit For` instrucciones.</span><span class="sxs-lookup"><span data-stu-id="501a6-145">The following example shows how to use the `Continue For` and `Exit For` statements.</span></span>  
  
 [!code-vb[VbVbalrStatements#123](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#123)]  
  
 <span data-ttu-id="501a6-146">Puede colocar cualquier número de `Exit For` instrucciones en un `For Each` bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-146">You can put any number of `Exit For` statements in a `For Each` loop.</span></span> <span data-ttu-id="501a6-147">Cuando se usa dentro de anidar `For Each` bucles, `Exit For` provoca la ejecución al salir del bucle y transfiere el control más interno al siguiente nivel más alto de anidamiento.</span><span class="sxs-lookup"><span data-stu-id="501a6-147">When used within nested `For Each` loops, `Exit For` causes execution to exit the innermost loop and transfers control to the next higher level of nesting.</span></span>  
  
 <span data-ttu-id="501a6-148">`Exit For` a menudo se usa después de una evaluación de alguna condición, por ejemplo, en un `If`... `Then`... `Else` estructura.</span><span class="sxs-lookup"><span data-stu-id="501a6-148">`Exit For` is often used after an evaluation of some condition, for example, in an `If`...`Then`...`Else` structure.</span></span> <span data-ttu-id="501a6-149">Desea usar `Exit For` para las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="501a6-149">You might want to use `Exit For` for the following conditions:</span></span>  
  
-   <span data-ttu-id="501a6-150">Continuar recorrer en iteración es innecesarios o imposible.</span><span class="sxs-lookup"><span data-stu-id="501a6-150">Continuing to iterate is unnecessary or impossible.</span></span> <span data-ttu-id="501a6-151">Esto podría deberse a un valor erróneo o una solicitud de finalización.</span><span class="sxs-lookup"><span data-stu-id="501a6-151">This might be caused by an erroneous value or a termination request.</span></span>  
  
-   <span data-ttu-id="501a6-152">Se detectó una excepción en un `Try`... `Catch`... `Finally`. Puede usar `Exit For` al final de la `Finally` bloque.</span><span class="sxs-lookup"><span data-stu-id="501a6-152">An exception is caught in a `Try`...`Catch`...`Finally`. You might use `Exit For` at the end of the `Finally` block.</span></span>  
  
-   <span data-ttu-id="501a6-153">Hay un bucle sin fin, que es un bucle que podría ejecutar un número grande o incluso infinito de veces.</span><span class="sxs-lookup"><span data-stu-id="501a6-153">There an endless loop, which is a loop that could run a large or even infinite number of times.</span></span> <span data-ttu-id="501a6-154">Si se detecta una condición de ese tipo, puede usar `Exit For` para salir del bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-154">If you detect such a condition, you can use `Exit For` to escape the loop.</span></span> <span data-ttu-id="501a6-155">Para obtener más información, consulte [hacer... Instrucción de bucle](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span><span class="sxs-lookup"><span data-stu-id="501a6-155">For more information, see [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span></span>  
  
## <a name="iterators"></a><span data-ttu-id="501a6-156">Iterators</span><span class="sxs-lookup"><span data-stu-id="501a6-156">Iterators</span></span>  
 <span data-ttu-id="501a6-157">Usa un *iterador* para realizar una iteración personalizada en una colección.</span><span class="sxs-lookup"><span data-stu-id="501a6-157">You use an *iterator* to perform a custom iteration over a collection.</span></span> <span data-ttu-id="501a6-158">Un iterador puede ser una función o un `Get` descriptor de acceso.</span><span class="sxs-lookup"><span data-stu-id="501a6-158">An iterator can be a function or a `Get` accessor.</span></span> <span data-ttu-id="501a6-159">Usa un `Yield` instrucción para devolver cada elemento de la colección a la vez.</span><span class="sxs-lookup"><span data-stu-id="501a6-159">It uses a `Yield` statement to return each element of the collection one at a time.</span></span>  
  
 <span data-ttu-id="501a6-160">Llame a un iterador mediante una `For Each...Next` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-160">You call an iterator by using a `For Each...Next` statement.</span></span> <span data-ttu-id="501a6-161">Cada iteración del bucle `For Each` llama al iterador.</span><span class="sxs-lookup"><span data-stu-id="501a6-161">Each iteration of the `For Each` loop calls the iterator.</span></span> <span data-ttu-id="501a6-162">Cuando un `Yield` se alcanza la instrucción en el iterador, la expresión en el `Yield` instrucción se devuelve y se conserva la ubicación actual en el código.</span><span class="sxs-lookup"><span data-stu-id="501a6-162">When a `Yield` statement is reached in the iterator, the expression in the `Yield` statement is returned, and the current location in code is retained.</span></span> <span data-ttu-id="501a6-163">La ejecución se reinicia desde esa ubicación la próxima vez que se llama al iterador.</span><span class="sxs-lookup"><span data-stu-id="501a6-163">Execution is restarted from that location the next time that the iterator is called.</span></span>  
  
 <span data-ttu-id="501a6-164">El ejemplo siguiente usa una función de iterador.</span><span class="sxs-lookup"><span data-stu-id="501a6-164">The following example uses an iterator function.</span></span> <span data-ttu-id="501a6-165">La función de iterador tiene una `Yield` instrucción que está dentro de un [para... Siguiente](../../../visual-basic/language-reference/statements/for-next-statement.md) bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-165">The iterator function has a `Yield` statement that's inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop.</span></span> <span data-ttu-id="501a6-166">En el `ListEvenNumbers` método, cada iteración de la `For Each` cuerpo de la instrucción crea una llamada a la función de iterador, que continúa con la siguiente `Yield` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-166">In the `ListEvenNumbers` method, each iteration of the `For Each` statement body creates a call to the iterator function, which proceeds to the next `Yield` statement.</span></span>  
  
 [!code-vb[VbVbalrStatements#127](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#127)]  
  
 <span data-ttu-id="501a6-167">Para obtener más información, consulte [iteradores](../../programming-guide/concepts/iterators.md), [instrucción Yield](../../../visual-basic/language-reference/statements/yield-statement.md), y [iterador](../../../visual-basic/language-reference/modifiers/iterator.md).</span><span class="sxs-lookup"><span data-stu-id="501a6-167">For more information, see [Iterators](../../programming-guide/concepts/iterators.md), [Yield Statement](../../../visual-basic/language-reference/statements/yield-statement.md), and [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md).</span></span>  
  
## <a name="technical-implementation"></a><span data-ttu-id="501a6-168">Implementación técnica</span><span class="sxs-lookup"><span data-stu-id="501a6-168">Technical Implementation</span></span>  
 <span data-ttu-id="501a6-169">Cuando un `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="501a6-169">When a `For Each`…`Next`</span></span> <span data-ttu-id="501a6-170">instrucción se ejecuta, Visual Basic se evalúa como la colección de solo una vez, antes de que comience el bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-170">statement runs, Visual Basic evaluates the collection only one time, before the loop starts.</span></span> <span data-ttu-id="501a6-171">Si cambia el bloque de instrucciones `element` o `group`, estos cambios no afectan a la iteración del bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-171">If your statement block changes `element` or `group`, these changes don't affect the iteration of the loop.</span></span>  
  
 <span data-ttu-id="501a6-172">Cuando todos los elementos de la colección se ha asignado correctamente a `element`, `For Each` bucle se detiene y el control pasa a la instrucción que sigue la `Next` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-172">When all the elements in the collection have been successively assigned to `element`, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span>  
  
 <span data-ttu-id="501a6-173">Si `element` aún no se ha declarado fuera de este bucle, se debe declarar en el `For Each` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-173">If `element` hasn't been declared outside this loop, you must declare it in the `For Each` statement.</span></span> <span data-ttu-id="501a6-174">Se puede declarar el tipo de `element` explícitamente mediante una `As` instrucción, o bien puede basarse en la inferencia de tipos para asignar el tipo.</span><span class="sxs-lookup"><span data-stu-id="501a6-174">You can declare the type of `element` explicitly by using an `As` statement, or you can rely on type inference to assign the type.</span></span> <span data-ttu-id="501a6-175">En cualquier caso, el ámbito de `element` es el cuerpo del bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-175">In either case, the scope of `element` is the body of the loop.</span></span> <span data-ttu-id="501a6-176">Sin embargo, no puede declarar `element` fuera y dentro del bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-176">However, you cannot declare `element` both outside and inside the loop.</span></span>  
  
 <span data-ttu-id="501a6-177">Opcionalmente, puede especificar `element` en el `Next` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-177">You can optionally specify `element` in the `Next` statement.</span></span> <span data-ttu-id="501a6-178">Esto mejora la legibilidad del programa, especialmente si ha anidado `For Each` bucles.</span><span class="sxs-lookup"><span data-stu-id="501a6-178">This improves the readability of your program, especially if you have nested `For Each` loops.</span></span> <span data-ttu-id="501a6-179">Debe especificar la misma variable que aparecerá en las correspondientes `For Each` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-179">You must specify the same variable as the one that appears in the corresponding `For Each` statement.</span></span>  
  
 <span data-ttu-id="501a6-180">Desea evitar cambiar el valor de `element` dentro de un bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-180">You might want to avoid changing the value of `element` inside a loop.</span></span> <span data-ttu-id="501a6-181">Esto puede hacer más difícil de leer y depurar el código.</span><span class="sxs-lookup"><span data-stu-id="501a6-181">Doing this can make it more difficult to read and debug your code.</span></span> <span data-ttu-id="501a6-182">Cambiar el valor de `group` no afecta a la colección o sus elementos, que se han determinado cuando el bucle se introdujo en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="501a6-182">Changing the value of `group` doesn't affect the collection or its elements, which were determined when the loop was first entered.</span></span>  
  
 <span data-ttu-id="501a6-183">Cuando está anidar bucles, si un `Next` instrucción de un nivel de anidamiento externo se encuentra antes del `Next` de un nivel interno, el compilador señala un error.</span><span class="sxs-lookup"><span data-stu-id="501a6-183">When you're nesting loops, if a `Next` statement of an outer nesting level is encountered before the `Next` of an inner level, the compiler signals an error.</span></span> <span data-ttu-id="501a6-184">Sin embargo, el compilador puede detectar esta superposición de error únicamente si se especifica `element` en cada `Next` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-184">However, the compiler can detect this overlapping error only if you specify `element` in every `Next` statement.</span></span>  
  
 <span data-ttu-id="501a6-185">Si el código depende de recorrido de una colección en un orden determinado, un `For Each`... `Next` bucle no es la mejor opción, a menos que conozca las características del objeto enumerador que expone la colección.</span><span class="sxs-lookup"><span data-stu-id="501a6-185">If your code depends on traversing a collection in a particular order, a `For Each`...`Next` loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes.</span></span> <span data-ttu-id="501a6-186">No se determina el orden del recorrido por Visual Basic, sino por la <xref:System.Collections.IEnumerator.MoveNext%2A> método del objeto enumerador.</span><span class="sxs-lookup"><span data-stu-id="501a6-186">The order of traversal isn't determined by Visual Basic, but by the <xref:System.Collections.IEnumerator.MoveNext%2A> method of the enumerator object.</span></span> <span data-ttu-id="501a6-187">Por lo tanto, es posible que no pueda predecir qué elemento de la colección es el primero que se devolverán en `element`, o que es el siguiente que se devuelve después de un elemento determinado.</span><span class="sxs-lookup"><span data-stu-id="501a6-187">Therefore, you might not be able to predict which element of the collection is the first to be returned in `element`, or which is the next to be returned after a given element.</span></span> <span data-ttu-id="501a6-188">Puede conseguir resultados más confiables con una estructura de bucle diferente, como `For`... `Next` o `Do`... `Loop`.</span><span class="sxs-lookup"><span data-stu-id="501a6-188">You might achieve more reliable results using a different loop structure, such as `For`...`Next` or `Do`...`Loop`.</span></span>  
  
 <span data-ttu-id="501a6-189">Tipo de datos de `element` será tal que el tipo de datos de los elementos de `group` se pueden convertir a él.</span><span class="sxs-lookup"><span data-stu-id="501a6-189">The data type of `element` must be such that the data type of the elements of `group` can be converted to it.</span></span>  
  
 <span data-ttu-id="501a6-190">Tipo de datos de `group` debe ser un tipo de referencia que hace referencia a una colección o una matriz que es enumerable.</span><span class="sxs-lookup"><span data-stu-id="501a6-190">The data type of `group` must be a reference type that refers to a collection or an array that's enumerable.</span></span> <span data-ttu-id="501a6-191">Normalmente, esto significa que `group` hace referencia a un objeto que implementa el <xref:System.Collections.IEnumerable> interfaz de la `System.Collections` espacio de nombres o el <xref:System.Collections.Generic.IEnumerable%601> interfaz de la `System.Collections.Generic` espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="501a6-191">Most commonly this means that `group` refers to an object that implements the <xref:System.Collections.IEnumerable> interface of the `System.Collections` namespace or the <xref:System.Collections.Generic.IEnumerable%601> interface of the `System.Collections.Generic` namespace.</span></span> <span data-ttu-id="501a6-192">`System.Collections.IEnumerable` define el <xref:System.Collections.IEnumerable.GetEnumerator%2A> método, que devuelve un objeto enumerador para la colección.</span><span class="sxs-lookup"><span data-stu-id="501a6-192">`System.Collections.IEnumerable` defines the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method, which returns an enumerator object for the collection.</span></span> <span data-ttu-id="501a6-193">El objeto de enumerador implementa el `System.Collections.IEnumerator` interfaz de la `System.Collections` espacio de nombres y expone el <xref:System.Collections.IEnumerator.Current%2A> propiedad y el <xref:System.Collections.IEnumerator.Reset%2A> y <xref:System.Collections.IEnumerator.MoveNext%2A> métodos.</span><span class="sxs-lookup"><span data-stu-id="501a6-193">The enumerator object implements the `System.Collections.IEnumerator` interface of the `System.Collections` namespace and exposes the <xref:System.Collections.IEnumerator.Current%2A> property and the <xref:System.Collections.IEnumerator.Reset%2A> and <xref:System.Collections.IEnumerator.MoveNext%2A> methods.</span></span> <span data-ttu-id="501a6-194">Visual Basic utiliza estos para recorrer la colección.</span><span class="sxs-lookup"><span data-stu-id="501a6-194">Visual Basic uses these to traverse the collection.</span></span>  
  
### <a name="narrowing-conversions"></a><span data-ttu-id="501a6-195">conversiones de restricción</span><span class="sxs-lookup"><span data-stu-id="501a6-195">Narrowing Conversions</span></span>  
 <span data-ttu-id="501a6-196">Cuando `Option Strict` está establecido en `On`, las conversiones de restricción suelen provocan errores del compilador.</span><span class="sxs-lookup"><span data-stu-id="501a6-196">When `Option Strict` is set to `On`, narrowing conversions ordinarily cause compiler errors.</span></span> <span data-ttu-id="501a6-197">En un `For Each` instrucción, sin embargo, las conversiones de los elementos de `group` a `element` se evalúan y se realiza en tiempo de ejecución y se suprimen los errores del compilador causados por las conversiones de restricción.</span><span class="sxs-lookup"><span data-stu-id="501a6-197">In a `For Each` statement, however, conversions from the elements in `group` to `element` are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.</span></span>  
  
 <span data-ttu-id="501a6-198">En el ejemplo siguiente, la asignación de `m` como valor inicial para `n` no se compila cuando `Option Strict` está activado porque la conversión de un `Long` a un `Integer` es una conversión de restricción.</span><span class="sxs-lookup"><span data-stu-id="501a6-198">In the following example, the assignment of `m` as the initial value for `n` doesn't compile when `Option Strict` is on because the conversion of a `Long` to an `Integer` is a narrowing conversion.</span></span> <span data-ttu-id="501a6-199">En el `For Each` instrucción, sin embargo, ningún error del compilador es notificado, aunque la asignación a `number` requiere la misma conversión desde `Long` a `Integer`.</span><span class="sxs-lookup"><span data-stu-id="501a6-199">In the `For Each` statement, however, no compiler error is reported, even though the assignment to `number` requires the same conversion from `Long` to `Integer`.</span></span> <span data-ttu-id="501a6-200">En el `For Each` instrucción que contiene un número grande, que se produce un error en tiempo de ejecución cuando <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> se aplica a la gran cantidad.</span><span class="sxs-lookup"><span data-stu-id="501a6-200">In the `For Each` statement that contains a large number, a run-time error occurs when <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> is applied to the large number.</span></span>  
  
 [!code-vb[VbVbalrStatements#89](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class3.vb#89)]  
  
### <a name="ienumerator-calls"></a><span data-ttu-id="501a6-201">Llamadas de IEnumerator</span><span class="sxs-lookup"><span data-stu-id="501a6-201">IEnumerator Calls</span></span>  
 <span data-ttu-id="501a6-202">Cuando la ejecución de un `For Each`... `Next` bucle inicia, Visual Basic comprueba que `group` hace referencia a un objeto de colección válido.</span><span class="sxs-lookup"><span data-stu-id="501a6-202">When execution of a `For Each`...`Next` loop starts, Visual Basic verifies that `group` refers to a valid collection object.</span></span> <span data-ttu-id="501a6-203">Si no es así, produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="501a6-203">If not, it throws an exception.</span></span> <span data-ttu-id="501a6-204">De lo contrario, llama el <xref:System.Collections.IEnumerator.MoveNext%2A> método y el <xref:System.Collections.IEnumerator.Current%2A> propiedad del objeto enumerador para devolver el primer elemento.</span><span class="sxs-lookup"><span data-stu-id="501a6-204">Otherwise, it calls the <xref:System.Collections.IEnumerator.MoveNext%2A> method and the <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object to return the first element.</span></span> <span data-ttu-id="501a6-205">Si `MoveNext` no indica que no existe ningún elemento siguiente, es decir, si la colección está vacía, el `For Each` bucle se detiene y el control pasa a la instrucción que sigue la `Next` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-205">If `MoveNext` indicates that there is no next element, that is, if the collection is empty, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span> <span data-ttu-id="501a6-206">En caso contrario, Visual Basic establece `element` para el primer elemento y se ejecuta el bloque de instrucciones.</span><span class="sxs-lookup"><span data-stu-id="501a6-206">Otherwise, Visual Basic sets `element` to the first element and runs the statement block.</span></span>  
  
 <span data-ttu-id="501a6-207">Cada vez que Visual Basic encuentra la `Next` instrucción, devuelve a la `For Each` instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-207">Each time Visual Basic encounters the `Next` statement, it returns to the `For Each` statement.</span></span> <span data-ttu-id="501a6-208">Llama de nuevo `MoveNext` y `Current` para devolver el elemento siguiente y, nuevamente uno ejecuta el bloque o detiene el bucle según el resultado.</span><span class="sxs-lookup"><span data-stu-id="501a6-208">Again it calls `MoveNext` and `Current` to return the next element, and again it either runs the block or stops the loop depending on the result.</span></span> <span data-ttu-id="501a6-209">Este proceso continúa hasta que `MoveNext` indica que no hay ningún elemento siguiente o `Exit For` se encuentra la instrucción.</span><span class="sxs-lookup"><span data-stu-id="501a6-209">This process continues until `MoveNext` indicates that there is no next element or an `Exit For` statement is encountered.</span></span>  
  
 <span data-ttu-id="501a6-210">**Modificar la colección.**</span><span class="sxs-lookup"><span data-stu-id="501a6-210">**Modifying the Collection.**</span></span> <span data-ttu-id="501a6-211">El objeto de enumerador devuelto por <xref:System.Collections.IEnumerable.GetEnumerator%2A> normalmente no le permite cambiar la colección agregando, eliminando, reemplazando o reordenar los elementos.</span><span class="sxs-lookup"><span data-stu-id="501a6-211">The enumerator object returned by <xref:System.Collections.IEnumerable.GetEnumerator%2A> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements.</span></span> <span data-ttu-id="501a6-212">Si cambia la colección después de haber iniciado una `For Each`... `Next` bucle, el objeto de enumerador deja de ser válido y el siguiente intento de acceder a un elemento hace que un <xref:System.InvalidOperationException> excepción.</span><span class="sxs-lookup"><span data-stu-id="501a6-212">If you change the collection after you have initiated a `For Each`...`Next` loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="501a6-213">Sin embargo, este bloqueo de modificación no está determinado por Visual Basic, pero por la implementación de la <xref:System.Collections.IEnumerable> interfaz.</span><span class="sxs-lookup"><span data-stu-id="501a6-213">However, this blocking of modification isn't determined by Visual Basic, but rather by the implementation of the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="501a6-214">Es posible implementar `IEnumerable` de forma que permite la modificación durante la iteración.</span><span class="sxs-lookup"><span data-stu-id="501a6-214">It is possible to implement `IEnumerable` in a way that allows for modification during iteration.</span></span> <span data-ttu-id="501a6-215">Si se va a realizar dicha modificación dinámica, asegúrese de que comprende las características de la `IEnumerable` implementación en la colección que está utilizando.</span><span class="sxs-lookup"><span data-stu-id="501a6-215">If you are considering doing such dynamic modification, make sure that you understand the characteristics of the `IEnumerable` implementation on the collection you are using.</span></span>  
  
 <span data-ttu-id="501a6-216">**Modificar elementos de la colección.**</span><span class="sxs-lookup"><span data-stu-id="501a6-216">**Modifying Collection Elements.**</span></span> <span data-ttu-id="501a6-217">El <xref:System.Collections.IEnumerator.Current%2A> es propiedad del objeto enumerador [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), y devuelve una copia local de cada elemento de la colección.</span><span class="sxs-lookup"><span data-stu-id="501a6-217">The <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object is [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), and it returns a local copy of each collection element.</span></span> <span data-ttu-id="501a6-218">Esto significa que no se puede modificar los propios elementos en un `For Each`... `Next` bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-218">This means that you cannot modify the elements themselves in a `For Each`...`Next` loop.</span></span> <span data-ttu-id="501a6-219">Cualquier modificación realizada afecta solo a la copia local de `Current` y no se reflejan en la colección subyacente.</span><span class="sxs-lookup"><span data-stu-id="501a6-219">Any modification you make affects only the local copy from `Current` and isn't reflected back into the underlying collection.</span></span> <span data-ttu-id="501a6-220">Sin embargo, si un elemento es un tipo de referencia, puede modificar los miembros de la instancia a la que señala.</span><span class="sxs-lookup"><span data-stu-id="501a6-220">However, if an element is a reference type, you can modify the members of the instance to which it points.</span></span> <span data-ttu-id="501a6-221">En el ejemplo siguiente se modifica el `BackColor` miembro de cada `thisControl` elemento.</span><span class="sxs-lookup"><span data-stu-id="501a6-221">The following example modifies the `BackColor` member of each `thisControl` element.</span></span> <span data-ttu-id="501a6-222">Sin embargo, no es posible, modificar `thisControl` propio.</span><span class="sxs-lookup"><span data-stu-id="501a6-222">You cannot, however, modify `thisControl` itself.</span></span>  
  
```vb  
Sub lightBlueBackground(ByVal thisForm As System.Windows.Forms.Form)  
    For Each thisControl As System.Windows.Forms.Control In thisForm.Controls  
        thisControl.BackColor = System.Drawing.Color.LightBlue  
    Next thisControl  
End Sub  
```  
  
 <span data-ttu-id="501a6-223">En el ejemplo anterior se puede modificar el `BackColor` miembro de cada `thisControl` elemento, aunque no puede modificar `thisControl` propio.</span><span class="sxs-lookup"><span data-stu-id="501a6-223">The previous example can modify the `BackColor` member of each `thisControl` element, although it cannot modify `thisControl` itself.</span></span>  
  
 <span data-ttu-id="501a6-224">**Recorrer las matrices.**</span><span class="sxs-lookup"><span data-stu-id="501a6-224">**Traversing Arrays.**</span></span> <span data-ttu-id="501a6-225">Dado que el <xref:System.Array> la clase implementa la <xref:System.Collections.IEnumerable> exponen todas las matrices de interfaz, el <xref:System.Array.GetEnumerator%2A> método.</span><span class="sxs-lookup"><span data-stu-id="501a6-225">Because the <xref:System.Array> class implements the <xref:System.Collections.IEnumerable> interface, all arrays expose the <xref:System.Array.GetEnumerator%2A> method.</span></span> <span data-ttu-id="501a6-226">Esto significa que puede iterar a través de una matriz con un `For Each`... `Next` bucle.</span><span class="sxs-lookup"><span data-stu-id="501a6-226">This means that you can iterate through an array with a `For Each`...`Next` loop.</span></span> <span data-ttu-id="501a6-227">Sin embargo, solo puede leer los elementos de matriz.</span><span class="sxs-lookup"><span data-stu-id="501a6-227">However, you can only read the array elements.</span></span> <span data-ttu-id="501a6-228">No se pueden cambiar.</span><span class="sxs-lookup"><span data-stu-id="501a6-228">You cannot change them.</span></span>  
  
## <a name="example"></a><span data-ttu-id="501a6-229">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="501a6-229">Example</span></span>  
 <span data-ttu-id="501a6-230">En el ejemplo siguiente se enumeran todas las carpetas en el directorio C:\ utilizando la <xref:System.IO.DirectoryInfo> clase.</span><span class="sxs-lookup"><span data-stu-id="501a6-230">The following example lists all the folders in the C:\ directory by using the <xref:System.IO.DirectoryInfo> class.</span></span>  
  
 [!code-vb[VbVbalrStatements#124](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#124)]  
  
## <a name="example"></a><span data-ttu-id="501a6-231">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="501a6-231">Example</span></span>  
 <span data-ttu-id="501a6-232">En el ejemplo siguiente se muestra un procedimiento para ordenar una colección.</span><span class="sxs-lookup"><span data-stu-id="501a6-232">The following example illustrates a procedure for sorting a collection.</span></span> <span data-ttu-id="501a6-233">El ejemplo ordena las instancias de un `Car` clase que se almacenan en un <xref:System.Collections.Generic.List%601>.</span><span class="sxs-lookup"><span data-stu-id="501a6-233">The example sorts instances of a `Car` class that are stored in a <xref:System.Collections.Generic.List%601>.</span></span> <span data-ttu-id="501a6-234">La clase `Car` implementa la interfaz <xref:System.IComparable%601>, que requiere implementar el método <xref:System.IComparable%601.CompareTo%2A>.</span><span class="sxs-lookup"><span data-stu-id="501a6-234">The `Car` class implements the <xref:System.IComparable%601> interface, which requires that the <xref:System.IComparable%601.CompareTo%2A> method be implemented.</span></span>  
  
 <span data-ttu-id="501a6-235">Cada llamada a la <xref:System.IComparable%601.CompareTo%2A> método realiza una comparación única que se utiliza para ordenar.</span><span class="sxs-lookup"><span data-stu-id="501a6-235">Each call to the <xref:System.IComparable%601.CompareTo%2A> method makes a single comparison that's used for sorting.</span></span> <span data-ttu-id="501a6-236">El código escrito por el usuario en el método `CompareTo` devuelve un valor para cada comparación del objeto actual con otro objeto.</span><span class="sxs-lookup"><span data-stu-id="501a6-236">User-written code in the `CompareTo` method returns a value for each comparison of the current object with another object.</span></span> <span data-ttu-id="501a6-237">El valor devuelto es menor que cero si el objeto actual es menor que el otro objeto, mayor que cero si el objeto actual es mayor que el otro objeto y cero si son iguales.</span><span class="sxs-lookup"><span data-stu-id="501a6-237">The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal.</span></span> <span data-ttu-id="501a6-238">Esto permite definir en el código los criterios de mayor que, menor que e igual.</span><span class="sxs-lookup"><span data-stu-id="501a6-238">This enables you to define in code the criteria for greater than, less than, and equal.</span></span>  
  
 <span data-ttu-id="501a6-239">En el método `ListCars`, la instrucción `cars.Sort()` ordena la lista.</span><span class="sxs-lookup"><span data-stu-id="501a6-239">In the `ListCars` method, the `cars.Sort()` statement sorts the list.</span></span> <span data-ttu-id="501a6-240">Esta llamada al método <xref:System.Collections.Generic.List%601.Sort%2A> de <xref:System.Collections.Generic.List%601> hace que se llame automáticamente al método `CompareTo` para los objetos `Car` de `List`.</span><span class="sxs-lookup"><span data-stu-id="501a6-240">This call to the <xref:System.Collections.Generic.List%601.Sort%2A> method of the <xref:System.Collections.Generic.List%601> causes the `CompareTo` method to be called automatically for the `Car` objects in the `List`.</span></span>  
  
 [!code-vb[VbVbalrStatements#125](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#125)]  
  
## <a name="see-also"></a><span data-ttu-id="501a6-241">Vea también</span><span class="sxs-lookup"><span data-stu-id="501a6-241">See also</span></span>

- [<span data-ttu-id="501a6-242">Colecciones</span><span class="sxs-lookup"><span data-stu-id="501a6-242">Collections</span></span>](../../../standard/collections/index.md)
- [<span data-ttu-id="501a6-243">For...Next (instrucción)</span><span class="sxs-lookup"><span data-stu-id="501a6-243">For...Next Statement</span></span>](../../../visual-basic/language-reference/statements/for-next-statement.md)
- [<span data-ttu-id="501a6-244">Estructuras de bucle</span><span class="sxs-lookup"><span data-stu-id="501a6-244">Loop Structures</span></span>](../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)
- [<span data-ttu-id="501a6-245">While...End While (instrucción)</span><span class="sxs-lookup"><span data-stu-id="501a6-245">While...End While Statement</span></span>](../../../visual-basic/language-reference/statements/while-end-while-statement.md)
- [<span data-ttu-id="501a6-246">Do...Loop (instrucción)</span><span class="sxs-lookup"><span data-stu-id="501a6-246">Do...Loop Statement</span></span>](../../../visual-basic/language-reference/statements/do-loop-statement.md)
- [<span data-ttu-id="501a6-247">Conversiones de ampliación y de restricción</span><span class="sxs-lookup"><span data-stu-id="501a6-247">Widening and Narrowing Conversions</span></span>](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)
- [<span data-ttu-id="501a6-248">Inicializadores de objeto: Tipos con nombre y anónimos</span><span class="sxs-lookup"><span data-stu-id="501a6-248">Object Initializers: Named and Anonymous Types</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="501a6-249">Inicializadores de colección</span><span class="sxs-lookup"><span data-stu-id="501a6-249">Collection Initializers</span></span>](../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)
- [<span data-ttu-id="501a6-250">Matrices</span><span class="sxs-lookup"><span data-stu-id="501a6-250">Arrays</span></span>](../../../visual-basic/programming-guide/language-features/arrays/index.md)
