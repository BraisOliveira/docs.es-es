---
title: Modo virtual del control DataGridView de formularios Windows Forms
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], virtual mode
ms.assetid: feae5d43-2848-4b1a-8ea7-77085dc415b5
ms.openlocfilehash: f284835578221ad1fe859f260e37bb829cd64b2d
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/08/2019
ms.locfileid: "59124727"
---
# <a name="virtual-mode-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="96503-102">Modo virtual del control DataGridView de formularios Windows Forms</span><span class="sxs-lookup"><span data-stu-id="96503-102">Virtual Mode in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="96503-103">Con el modo virtual, puede administrar la interacción entre el <xref:System.Windows.Forms.DataGridView> control y una memoria caché de datos personalizados.</span><span class="sxs-lookup"><span data-stu-id="96503-103">With virtual mode, you can manage the interaction between the <xref:System.Windows.Forms.DataGridView> control and a custom data cache.</span></span> <span data-ttu-id="96503-104">Para implementar el modo virtual, establezca el <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> propiedad `true` y controle uno o varios de los eventos descritos en este tema.</span><span class="sxs-lookup"><span data-stu-id="96503-104">To implement virtual mode, set the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property to `true` and handle one or more of the events described in this topic.</span></span> <span data-ttu-id="96503-105">Normalmente controlará al menos el `CellValueNeeded` eventos, lo que permite el control buscar valores en la caché de datos.</span><span class="sxs-lookup"><span data-stu-id="96503-105">You will typically handle at least the `CellValueNeeded` event, which enables the control look up values in the data cache.</span></span>  
  
## <a name="bound-mode-and-virtual-mode"></a><span data-ttu-id="96503-106">Modo de enlace y el modo Virtual</span><span class="sxs-lookup"><span data-stu-id="96503-106">Bound Mode and Virtual Mode</span></span>  
 <span data-ttu-id="96503-107">Modo virtual sólo es necesario cuando se necesita complementar o reemplazar el modo de enlace.</span><span class="sxs-lookup"><span data-stu-id="96503-107">Virtual mode is necessary only when you need to supplement or replace bound mode.</span></span> <span data-ttu-id="96503-108">En el modo de enlace, se establecen el <xref:System.Windows.Forms.DataGridView.DataSource%2A> propiedad y el control automáticamente carga los datos del origen especificado y envía el usuario cambia a ella.</span><span class="sxs-lookup"><span data-stu-id="96503-108">In bound mode, you set the <xref:System.Windows.Forms.DataGridView.DataSource%2A> property and the control automatically loads the data from the specified source and submits user changes back to it.</span></span> <span data-ttu-id="96503-109">Puede controlar cuál de las columnas enlazadas se muestran y el propio origen de datos normalmente controla las operaciones como la ordenación.</span><span class="sxs-lookup"><span data-stu-id="96503-109">You can control which of the bound columns are displayed, and the data source itself typically handles operations such as sorting.</span></span>  
  
## <a name="supplementing-bound-mode"></a><span data-ttu-id="96503-110">Complementar el modo de enlace</span><span class="sxs-lookup"><span data-stu-id="96503-110">Supplementing Bound Mode</span></span>  
 <span data-ttu-id="96503-111">Puede complementar el modo de enlace mostrando las columnas sin enlazar junto con las columnas enlazadas.</span><span class="sxs-lookup"><span data-stu-id="96503-111">You can supplement bound mode by displaying unbound columns along with the bound columns.</span></span> <span data-ttu-id="96503-112">Esto se denomina "modo mixto" y es útil para mostrar cosas como controla los valores calculados o interfaz de usuario (UI).</span><span class="sxs-lookup"><span data-stu-id="96503-112">This is sometimes called "mixed mode" and is useful for displaying things like calculated values or user-interface (UI) controls.</span></span>  
  
 <span data-ttu-id="96503-113">Dado que las columnas sin enlazar están fuera del origen de datos, se omiten las operaciones de ordenación del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="96503-113">Because unbound columns are outside the data source, they are ignored by the data source's sorting operations.</span></span> <span data-ttu-id="96503-114">Por lo tanto, al habilitar la ordenación en modo mixto, debe administrar los datos sin enlazar en una caché local e implementar el modo virtual para permitir que el <xref:System.Windows.Forms.DataGridView> control interactuar con él.</span><span class="sxs-lookup"><span data-stu-id="96503-114">Therefore, when you enable sorting in mixed mode, you must manage the unbound data in a local cache and implement virtual mode to let the <xref:System.Windows.Forms.DataGridView> control interact with it.</span></span>  
  
 <span data-ttu-id="96503-115">Para obtener más información sobre cómo usar el modo virtual para mantener los valores de columnas sin enlazar, vea los ejemplos en los <xref:System.Windows.Forms.DataGridViewCheckBoxColumn.ThreeState%2A?displayProperty=nameWithType> propiedad y <xref:System.Windows.Forms.DataGridViewComboBoxColumn?displayProperty=nameWithType> temas de referencia de la clase.</span><span class="sxs-lookup"><span data-stu-id="96503-115">For more information about using virtual mode to maintain the values in unbound columns, see the examples in the <xref:System.Windows.Forms.DataGridViewCheckBoxColumn.ThreeState%2A?displayProperty=nameWithType> property and <xref:System.Windows.Forms.DataGridViewComboBoxColumn?displayProperty=nameWithType> class reference topics.</span></span>  
  
## <a name="replacing-bound-mode"></a><span data-ttu-id="96503-116">Reemplazar el modo de enlace</span><span class="sxs-lookup"><span data-stu-id="96503-116">Replacing Bound Mode</span></span>  
 <span data-ttu-id="96503-117">Si el modo de enlace no satisfacen sus necesidades de rendimiento, puede administrar todos sus datos en una caché personalizada a través de los controladores de eventos de modo virtual.</span><span class="sxs-lookup"><span data-stu-id="96503-117">If bound mode does not meet your performance needs, you can manage all your data in a custom cache through virtual-mode event handlers.</span></span> <span data-ttu-id="96503-118">Por ejemplo, puede usar el modo virtual para implementar un mecanismo que recupera solo de carga de datos just-in-time todos los datos de una base de datos en red es necesario para un rendimiento óptimo.</span><span class="sxs-lookup"><span data-stu-id="96503-118">For example, you can use virtual mode to implement a just-in-time data loading mechanism that retrieves only as much data from a networked database as is necessary for optimal performance.</span></span> <span data-ttu-id="96503-119">Este escenario es especialmente útil cuando se trabaja con grandes cantidades de datos a través de una conexión de red lenta o con los equipos cliente que tienen una cantidad limitada de memoria RAM o espacio de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="96503-119">This scenario is particularly useful when working with large amounts of data over a slow network connection or with client machines that have a limited amount of RAM or storage space.</span></span>  
  
 <span data-ttu-id="96503-120">Para obtener más información sobre cómo usar el modo virtual en un escenario just-in-time, vea [implementar el modo Virtual con la carga de datos Just In Time en el DataGridView Control de formularios de Windows](implementing-virtual-mode-jit-data-loading-in-the-datagrid.md).</span><span class="sxs-lookup"><span data-stu-id="96503-120">For more information about using virtual mode in a just-in-time scenario, see [Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](implementing-virtual-mode-jit-data-loading-in-the-datagrid.md).</span></span>  
  
## <a name="virtual-mode-events"></a><span data-ttu-id="96503-121">Eventos en modo virtual</span><span class="sxs-lookup"><span data-stu-id="96503-121">Virtual-Mode Events</span></span>  
 <span data-ttu-id="96503-122">Si los datos están de solo lectura, el `CellValueNeeded` evento puede ser el único evento, deberá controlar.</span><span class="sxs-lookup"><span data-stu-id="96503-122">If your data is read-only, the `CellValueNeeded` event may be the only event you will need to handle.</span></span> <span data-ttu-id="96503-123">Eventos de modo virtual adicionales permiten habilitar funciones específicas, como las modificaciones del usuario, adición de fila y la eliminación y las transacciones de nivel de fila.</span><span class="sxs-lookup"><span data-stu-id="96503-123">Additional virtual-mode events let you enable specific functionality like user edits, row addition and deletion, and row-level transactions.</span></span>  
  
 <span data-ttu-id="96503-124">Algunos estándar <xref:System.Windows.Forms.DataGridView> eventos (por ejemplo, los eventos que se producen cuando los usuarios agregarán o eliminan filas o cuando los valores de celda se editado, analiza, validados o con formato) son útiles en modo virtual.</span><span class="sxs-lookup"><span data-stu-id="96503-124">Some standard <xref:System.Windows.Forms.DataGridView> events (such as events that occur when users add or delete rows, or when cell values are edited, parsed, validated, or formatted) are useful in virtual mode, as well.</span></span> <span data-ttu-id="96503-125">También puede controlar los eventos que le permiten mantener los valores no suelen almacenados en un origen de datos enlazados, como datos de alto de fila, celda y texto de error de fila, celda y datos de menú contextual de fila y texto de información sobre herramientas de la celda.</span><span class="sxs-lookup"><span data-stu-id="96503-125">You can also handle events that let you maintain values not typically stored in a bound data source, such as cell ToolTip text, cell and row error text, cell and row shortcut menu data, and row height data.</span></span>  
  
 <span data-ttu-id="96503-126">Para obtener más información acerca de cómo implementar el modo virtual para administrar los datos de lectura/escritura con un ámbito de confirmación de nivel de fila, vea [Tutorial: Implementar el modo Virtual en el Windows Forms DataGridView Control](implementing-virtual-mode-wf-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="96503-126">For more information about implementing virtual mode to manage read/write data with a row-level commit scope, see [Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control](implementing-virtual-mode-wf-datagridview-control.md).</span></span>  
  
 <span data-ttu-id="96503-127">Para obtener un ejemplo que implementa el modo virtual con un ámbito de confirmación de nivel de celda, vea el <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> tema de referencia de propiedad.</span><span class="sxs-lookup"><span data-stu-id="96503-127">For an example that implements virtual mode with a cell-level commit scope, see the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property reference topic.</span></span>  
  
 <span data-ttu-id="96503-128">Los siguientes eventos se producen solo cuando el <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> propiedad está establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="96503-128">The following events occur only when the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property is set to `true`.</span></span>  
  
|<span data-ttu-id="96503-129">evento</span><span class="sxs-lookup"><span data-stu-id="96503-129">Event</span></span>|<span data-ttu-id="96503-130">Descripción</span><span class="sxs-lookup"><span data-stu-id="96503-130">Description</span></span>|  
|-----------|-----------------|  
|<xref:System.Windows.Forms.DataGridView.CellValueNeeded>|<span data-ttu-id="96503-131">Usa el control para recuperar un valor de celda de la caché de datos para su presentación.</span><span class="sxs-lookup"><span data-stu-id="96503-131">Used by the control to retrieve a cell value from the data cache for display.</span></span> <span data-ttu-id="96503-132">Este evento se produce solo para las celdas de las columnas sin enlazar.</span><span class="sxs-lookup"><span data-stu-id="96503-132">This event occurs only for cells in unbound columns.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellValuePushed>|<span data-ttu-id="96503-133">Utilizado por el control para confirmar la entrada del usuario para una celda en la caché de datos.</span><span class="sxs-lookup"><span data-stu-id="96503-133">Used by the control to commit user input for a cell to the data cache.</span></span> <span data-ttu-id="96503-134">Este evento se produce solo para las celdas de las columnas sin enlazar.</span><span class="sxs-lookup"><span data-stu-id="96503-134">This event occurs only for cells in unbound columns.</span></span><br /><br /> <span data-ttu-id="96503-135">Llame a la <xref:System.Windows.Forms.DataGridView.UpdateCellValue%2A> método cuando se cambia un valor almacenado en caché fuera de un <xref:System.Windows.Forms.DataGridView.CellValuePushed> controlador de eventos para asegurarse de que el valor actual se muestra en el control y aplicar los modos de ajuste de tamaño automático actualmente en vigor.</span><span class="sxs-lookup"><span data-stu-id="96503-135">Call the <xref:System.Windows.Forms.DataGridView.UpdateCellValue%2A> method when changing a cached value outside of a <xref:System.Windows.Forms.DataGridView.CellValuePushed> event handler to ensure that the current value is displayed in the control and to apply any automatic sizing modes currently in effect.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.NewRowNeeded>|<span data-ttu-id="96503-136">Utilizado por el control para indicar la necesidad de una nueva fila en la caché de datos.</span><span class="sxs-lookup"><span data-stu-id="96503-136">Used by the control to indicate the need for a new row in the data cache.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowDirtyStateNeeded>|<span data-ttu-id="96503-137">Usa el control para determinar si una fila tiene cambios sin confirmar.</span><span class="sxs-lookup"><span data-stu-id="96503-137">Used by the control to determine whether a row has any uncommitted changes.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CancelRowEdit>|<span data-ttu-id="96503-138">Utilizado por el control para indicar que una fila debería revertirse a sus valores almacenados en caché.</span><span class="sxs-lookup"><span data-stu-id="96503-138">Used by the control to indicate that a row should revert to its cached values.</span></span>|  
  
 <span data-ttu-id="96503-139">Los eventos siguientes son útiles en modo virtual, pero se puede usar con independencia de la <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> configuración de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="96503-139">The following events are useful in virtual mode, but can be used regardless of the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property setting.</span></span>  
  
|<span data-ttu-id="96503-140">Eventos</span><span class="sxs-lookup"><span data-stu-id="96503-140">Events</span></span>|<span data-ttu-id="96503-141">Descripción</span><span class="sxs-lookup"><span data-stu-id="96503-141">Description</span></span>|  
|------------|-----------------|  
|<xref:System.Windows.Forms.DataGridView.UserDeletingRow><br /><br /> <xref:System.Windows.Forms.DataGridView.UserDeletedRow><br /><br /> <xref:System.Windows.Forms.DataGridView.RowsRemoved><br /><br /> <xref:System.Windows.Forms.DataGridView.RowsAdded>|<span data-ttu-id="96503-142">Usa el control para indicar cuándo se eliminan las filas o agregado, lo que permite actualizar la caché de datos en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="96503-142">Used by the control to indicate when rows are deleted or added, letting you update the data cache accordingly.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellFormatting><br /><br /> <xref:System.Windows.Forms.DataGridView.CellParsing><br /><br /> <xref:System.Windows.Forms.DataGridView.CellValidating><br /><br /> <xref:System.Windows.Forms.DataGridView.CellValidated><br /><br /> <xref:System.Windows.Forms.DataGridView.RowValidating><br /><br /> <xref:System.Windows.Forms.DataGridView.RowValidated>|<span data-ttu-id="96503-143">Utilizado por el control a los valores de celda de formato para mostrar y para analizar y validar la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="96503-143">Used by the control to format cell values for display and to parse and validate user input.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded>|<span data-ttu-id="96503-144">Utilizado por el control para recuperar el texto de información sobre herramientas de la celda cuando el <xref:System.Windows.Forms.DataGridView.DataSource%2A> se establece la propiedad o el <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> propiedad es `true`.</span><span class="sxs-lookup"><span data-stu-id="96503-144">Used by the control to retrieve cell ToolTip text when the <xref:System.Windows.Forms.DataGridView.DataSource%2A> property is set or the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property is `true`.</span></span><br /><br /> <span data-ttu-id="96503-145">Información sobre herramientas de celda se muestra solo cuando el <xref:System.Windows.Forms.DataGridView.ShowCellToolTips%2A> es el valor de propiedad `true`.</span><span class="sxs-lookup"><span data-stu-id="96503-145">Cell ToolTips are displayed only when the <xref:System.Windows.Forms.DataGridView.ShowCellToolTips%2A> property value is `true`.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellErrorTextNeeded><br /><br /> <xref:System.Windows.Forms.DataGridView.RowErrorTextNeeded>|<span data-ttu-id="96503-146">Utilizado por el control para recuperar el texto de error de celda o fila cuando la <xref:System.Windows.Forms.DataGridView.DataSource%2A> se establece la propiedad o el <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> propiedad es `true`.</span><span class="sxs-lookup"><span data-stu-id="96503-146">Used by the control to retrieve cell or row error text when the <xref:System.Windows.Forms.DataGridView.DataSource%2A> property is set or the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property is `true`.</span></span><br /><br /> <span data-ttu-id="96503-147">Llame a la <xref:System.Windows.Forms.DataGridView.UpdateCellErrorText%2A> método o la <xref:System.Windows.Forms.DataGridView.UpdateRowErrorText%2A> método cuando se cambia el texto de error de celda o fila para asegurarse de que el valor actual se muestra en el control.</span><span class="sxs-lookup"><span data-stu-id="96503-147">Call the <xref:System.Windows.Forms.DataGridView.UpdateCellErrorText%2A> method or the <xref:System.Windows.Forms.DataGridView.UpdateRowErrorText%2A> method when you change the cell or row error text to ensure that the current value is displayed in the control.</span></span><br /><br /> <span data-ttu-id="96503-148">Se muestran los glifos de error de fila y celda cuando la <xref:System.Windows.Forms.DataGridView.ShowCellErrors%2A> y <xref:System.Windows.Forms.DataGridView.ShowRowErrors%2A> son los valores de propiedad `true`.</span><span class="sxs-lookup"><span data-stu-id="96503-148">Cell and row error glyphs are displayed when the <xref:System.Windows.Forms.DataGridView.ShowCellErrors%2A> and <xref:System.Windows.Forms.DataGridView.ShowRowErrors%2A> property values are `true`.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded><br /><br /> <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded>|<span data-ttu-id="96503-149">Utilizado por el control para recuperar una celda o fila <xref:System.Windows.Forms.ContextMenuStrip> cuando el control <xref:System.Windows.Forms.DataGridView.DataSource%2A> se establece la propiedad o el <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> propiedad es `true`.</span><span class="sxs-lookup"><span data-stu-id="96503-149">Used by the control to retrieve a cell or row <xref:System.Windows.Forms.ContextMenuStrip> when the control <xref:System.Windows.Forms.DataGridView.DataSource%2A> property is set or the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowHeightInfoNeeded><br /><br /> <xref:System.Windows.Forms.DataGridView.RowHeightInfoPushed>|<span data-ttu-id="96503-150">Utiliza el control para recuperar o almacenar información de alto de fila en la caché de datos.</span><span class="sxs-lookup"><span data-stu-id="96503-150">Used by the control to retrieve or store row height information in the data cache.</span></span> <span data-ttu-id="96503-151">Llame a la <xref:System.Windows.Forms.DataGridView.UpdateRowHeightInfo%2A> método cuando se cambia la información de alto de fila almacenada en caché fuera de un <xref:System.Windows.Forms.DataGridView.RowHeightInfoPushed> controlador de eventos para asegurarse de que se usa el valor actual en la presentación del control.</span><span class="sxs-lookup"><span data-stu-id="96503-151">Call the <xref:System.Windows.Forms.DataGridView.UpdateRowHeightInfo%2A> method when changing the cached row height information outside of a <xref:System.Windows.Forms.DataGridView.RowHeightInfoPushed> event handler to ensure that the current value is used in the display of the control.</span></span>|  
  
## <a name="best-practices-in-virtual-mode"></a><span data-ttu-id="96503-152">Procedimientos recomendados en modo Virtual</span><span class="sxs-lookup"><span data-stu-id="96503-152">Best Practices in Virtual Mode</span></span>  
 <span data-ttu-id="96503-153">Si está implementando el modo virtual con el fin de trabajar eficazmente con grandes cantidades de datos, también deberá asegurarse de que está trabajando eficazmente con el <xref:System.Windows.Forms.DataGridView> propio control.</span><span class="sxs-lookup"><span data-stu-id="96503-153">If you are implementing virtual mode in order to work efficiently with large amounts of data, you will also want to ensure that you are working efficiently with the <xref:System.Windows.Forms.DataGridView> control itself.</span></span> <span data-ttu-id="96503-154">Para obtener más información sobre el uso eficaz de estilos de celda, ajuste de tamaño automático, las selecciones y compartir filas, vea [mejores prácticas para escalar el DataGridView Control de Windows Forms](best-practices-for-scaling-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="96503-154">For more information about the efficient use of cell styles, automatic sizing, selections, and row sharing, see [Best Practices for Scaling the Windows Forms DataGridView Control](best-practices-for-scaling-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="96503-155">Vea también</span><span class="sxs-lookup"><span data-stu-id="96503-155">See also</span></span>

- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridView.VirtualMode%2A>
- [<span data-ttu-id="96503-156">Ajuste del rendimiento del control DataGridView en formularios Windows Forms</span><span class="sxs-lookup"><span data-stu-id="96503-156">Performance Tuning in the Windows Forms DataGridView Control</span></span>](performance-tuning-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="96503-157">Procedimientos recomendados para ajustar la escala del control DataGridView en formularios Windows Forms</span><span class="sxs-lookup"><span data-stu-id="96503-157">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>](best-practices-for-scaling-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="96503-158">Tutorial: Implementar el modo virtual en el control DataGridView de formularios Windows Forms</span><span class="sxs-lookup"><span data-stu-id="96503-158">Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control</span></span>](implementing-virtual-mode-wf-datagridview-control.md)
- [<span data-ttu-id="96503-159">Implementar el modo virtual mediante la carga de datos Just-In-Time en el control DataGridView de formularios Windows Forms</span><span class="sxs-lookup"><span data-stu-id="96503-159">Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>](implementing-virtual-mode-jit-data-loading-in-the-datagrid.md)
