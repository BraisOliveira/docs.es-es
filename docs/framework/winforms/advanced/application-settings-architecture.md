---
title: Arquitectura de configuración de la aplicación
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- application settings [Windows Forms], architecture
ms.assetid: c8eb2ad0-fac6-4ea2-9140-675a4a44d562
ms.openlocfilehash: c9cb40cb318bd044cb9204ba2ed384b41b475d57
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2019
ms.locfileid: "64625771"
---
# <a name="application-settings-architecture"></a><span data-ttu-id="f9293-102">Arquitectura de configuración de la aplicación</span><span class="sxs-lookup"><span data-stu-id="f9293-102">Application Settings Architecture</span></span>
<span data-ttu-id="f9293-103">Este tema describe cómo funciona la arquitectura de la configuración de la aplicación y explora las características avanzadas de la arquitectura, como valores de configuración agrupados y claves de configuración.</span><span class="sxs-lookup"><span data-stu-id="f9293-103">This topic describes how the Application Settings architecture works, and explores advanced features of the architecture, such as grouped settings and settings keys.</span></span>  
  
 <span data-ttu-id="f9293-104">La arquitectura de configuración de la aplicación admite la definición de parámetros de configuración fuertemente tipados tanto de ámbito de aplicación como de usuario, así como la conservación de dichos parámetros entre las sesiones de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f9293-104">The application settings architecture supports defining strongly typed settings with either application or user scope, and persisting the settings between application sessions.</span></span> <span data-ttu-id="f9293-105">La arquitectura proporciona un motor de persistencia predeterminado para guardar la configuración en el sistema de archivos local y cargarla después desde este.</span><span class="sxs-lookup"><span data-stu-id="f9293-105">The architecture provides a default persistence engine for saving settings to and loading them from the local file system.</span></span> <span data-ttu-id="f9293-106">La arquitectura también define las interfaces para proporcionar un motor de persistencia personalizado.</span><span class="sxs-lookup"><span data-stu-id="f9293-106">The architecture also defines interfaces for supplying a custom persistence engine.</span></span>  
  
 <span data-ttu-id="f9293-107">Las interfaces se proporcionan para habilitar los componentes personalizados con el fin de que conserven su propia configuración cuando se hospedan en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f9293-107">Interfaces are provided that enable custom components to persist their own settings when they are hosted in an application.</span></span> <span data-ttu-id="f9293-108">Mediante el uso de claves de configuración, los componentes pueden conservar la configuración para varias instancias del componente independiente.</span><span class="sxs-lookup"><span data-stu-id="f9293-108">By using settings keys, components can keep settings for multiple instances of the component separate.</span></span>  
  
## <a name="defining-settings"></a><span data-ttu-id="f9293-109">Definir la configuración</span><span class="sxs-lookup"><span data-stu-id="f9293-109">Defining Settings</span></span>  
 <span data-ttu-id="f9293-110">La arquitectura de configuración de la aplicación se utiliza en [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] y en Windows Forms, y contiene un número de clases base que comparten ambos entornos.</span><span class="sxs-lookup"><span data-stu-id="f9293-110">The application settings architecture is used within both [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] and Windows Forms, and it contains a number of base classes that are shared across both environments.</span></span> <span data-ttu-id="f9293-111">Lo más importante es <xref:System.Configuration.SettingsBase>, que proporciona acceso a la configuración a través de una colección y proporciona métodos de bajo nivel para cargar y guardar la configuración.</span><span class="sxs-lookup"><span data-stu-id="f9293-111">The most important is <xref:System.Configuration.SettingsBase>, which provides access to settings through a collection, and provides low-level methods for loading and saving settings.</span></span> <span data-ttu-id="f9293-112">Cada entorno implementa su propia clase derivada de <xref:System.Configuration.SettingsBase> para proporcionar funcionalidad de configuración adicional para ese entorno.</span><span class="sxs-lookup"><span data-stu-id="f9293-112">Each environment implements its own class derived from <xref:System.Configuration.SettingsBase> to provide additional settings functionality for that environment.</span></span> <span data-ttu-id="f9293-113">En una aplicación basada en Windows Forms, toda la configuración de aplicación debe definirse en una clase derivada de la <xref:System.Configuration.ApplicationSettingsBase> (clase), que agrega la siguiente funcionalidad a la clase base:</span><span class="sxs-lookup"><span data-stu-id="f9293-113">In a Windows Forms-based application, all application settings must be defined on a class derived from the <xref:System.Configuration.ApplicationSettingsBase> class, which adds the following functionality to the base class:</span></span>  
  
- <span data-ttu-id="f9293-114">Operaciones de almacenamiento y de carga de nivel superior</span><span class="sxs-lookup"><span data-stu-id="f9293-114">Higher-level loading and saving operations</span></span>  
  
- <span data-ttu-id="f9293-115">Compatibilidad de la configuración de ámbito de usuario</span><span class="sxs-lookup"><span data-stu-id="f9293-115">Support for user-scoped settings</span></span>  
  
- <span data-ttu-id="f9293-116">Revertir la configuración de un usuario a los valores predeterminados</span><span class="sxs-lookup"><span data-stu-id="f9293-116">Reverting a user's settings to the predefined defaults</span></span>  
  
- <span data-ttu-id="f9293-117">Actualizar la configuración de una versión de aplicación anterior</span><span class="sxs-lookup"><span data-stu-id="f9293-117">Upgrading settings from a previous application version</span></span>  
  
- <span data-ttu-id="f9293-118">Validar la configuración antes de modificarla o después de guardarla</span><span class="sxs-lookup"><span data-stu-id="f9293-118">Validating settings, either before they are changed or before they are saved</span></span>  
  
 <span data-ttu-id="f9293-119">La configuración se puede describir utilizando varios atributos definidos dentro de la <xref:System.Configuration> espacio de nombres; estos se describen en [Application Settings Attributes](application-settings-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="f9293-119">The settings can be described using a number of attributes defined within the <xref:System.Configuration> namespace; these are described in [Application Settings Attributes](application-settings-attributes.md).</span></span> <span data-ttu-id="f9293-120">Al definir una configuración, debe aplicar con cualquiera <xref:System.Configuration.ApplicationScopedSettingAttribute> o <xref:System.Configuration.UserScopedSettingAttribute>, que describe si la configuración se aplica a toda la aplicación o sólo para el usuario actual.</span><span class="sxs-lookup"><span data-stu-id="f9293-120">When you define a setting, you must apply it with either <xref:System.Configuration.ApplicationScopedSettingAttribute> or <xref:System.Configuration.UserScopedSettingAttribute>, which describes whether the setting applies to the entire application or just to the current user.</span></span>  
  
 <span data-ttu-id="f9293-121">En el ejemplo de código siguiente se define una clase de configuración personalizada con una configuración única, `BackgroundColor`.</span><span class="sxs-lookup"><span data-stu-id="f9293-121">The following code example defines a custom settings class with a single setting, `BackgroundColor`.</span></span>  
  
 [!code-csharp[ApplicationSettings.Create#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Create/CS/MyAppSettings.cs#1)]
 [!code-vb[ApplicationSettings.Create#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Create/VB/MyAppSettings.vb#1)]  
  
## <a name="settings-persistence"></a><span data-ttu-id="f9293-122">Conservar la configuración</span><span class="sxs-lookup"><span data-stu-id="f9293-122">Settings Persistence</span></span>  
 <span data-ttu-id="f9293-123">El <xref:System.Configuration.ApplicationSettingsBase> clase no propio guardar o cargar la configuración; este trabajo lo realiza el proveedor de configuración, una clase que deriva de <xref:System.Configuration.SettingsProvider>.</span><span class="sxs-lookup"><span data-stu-id="f9293-123">The <xref:System.Configuration.ApplicationSettingsBase> class does not itself persist or load settings; this job falls to the settings provider, a class that derives from <xref:System.Configuration.SettingsProvider>.</span></span> <span data-ttu-id="f9293-124">Si una clase derivada de <xref:System.Configuration.ApplicationSettingsBase> no especifica un proveedor de configuración a través de la <xref:System.Configuration.SettingsProviderAttribute>, a continuación, el proveedor predeterminado, <xref:System.Configuration.LocalFileSettingsProvider>, se utiliza.</span><span class="sxs-lookup"><span data-stu-id="f9293-124">If a derived class of <xref:System.Configuration.ApplicationSettingsBase> does not specify a settings provider through the <xref:System.Configuration.SettingsProviderAttribute>, then the default provider, <xref:System.Configuration.LocalFileSettingsProvider>, is used.</span></span>  
  
 <span data-ttu-id="f9293-125">El sistema de configuración incluido originalmente en [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] admite proporcionar datos de configuración de la aplicación estáticos mediante un archivo machine.config del equipo local o dentro de un archivo `app.`exe.config que implemente con su aplicación.</span><span class="sxs-lookup"><span data-stu-id="f9293-125">The configuration system that was originally released with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] supports providing static application configuration data through either the local computer's machine.config file or within an `app.`exe.config file that you deploy with your application.</span></span> <span data-ttu-id="f9293-126">La <xref:System.Configuration.LocalFileSettingsProvider> clase expande esta compatibilidad nativa de las maneras siguientes:</span><span class="sxs-lookup"><span data-stu-id="f9293-126">The <xref:System.Configuration.LocalFileSettingsProvider> class expands this native support in the following ways:</span></span>  
  
- <span data-ttu-id="f9293-127">La configuración de ámbito de aplicación se puede almacenar en los archivos machine.config o `app.`.exe.config.</span><span class="sxs-lookup"><span data-stu-id="f9293-127">Application-scoped settings can be stored in either the machine.config or `app.`exe.config files.</span></span> <span data-ttu-id="f9293-128">Machine.config siempre es de solo lectura, mientras que `app`.exe.config está restringido por razones de seguridad a solo lectura para la mayoría de las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="f9293-128">Machine.config is always read-only, while `app`.exe.config is restricted by security considerations to read-only for most applications.</span></span>  
  
- <span data-ttu-id="f9293-129">La configuración de ámbito de usuario se puede almacenar en archivos `app`.exe.config, en cuyo caso se tratan como valores predeterminados estáticos.</span><span class="sxs-lookup"><span data-stu-id="f9293-129">User-scoped settings can be stored in `app`.exe.config files, in which case they are treated as static defaults.</span></span>  
  
- <span data-ttu-id="f9293-130">La configuración de ámbito de usuario no predeterminada se almacena en un nuevo archivo, *usuario*.config, donde *usuario* es el nombre de usuario de la persona que actualmente ejecuta la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f9293-130">Non-default user-scoped settings are stored in a new file, *user*.config, where *user* is the user name of the person currently executing the application.</span></span> <span data-ttu-id="f9293-131">Puede especificar un valor predeterminado para una configuración con ámbito de usuario con <xref:System.Configuration.DefaultSettingValueAttribute>.</span><span class="sxs-lookup"><span data-stu-id="f9293-131">You can specify a default for a user-scoped setting with <xref:System.Configuration.DefaultSettingValueAttribute>.</span></span> <span data-ttu-id="f9293-132">Puesto que la configuración de ámbito de usuario cambia a menudo durante la ejecución de la aplicación, `user`.config siempre es de lectura y escritura.</span><span class="sxs-lookup"><span data-stu-id="f9293-132">Because user-scoped settings often change during application execution, `user`.config is always read/write.</span></span>  
  
 <span data-ttu-id="f9293-133">Los tres archivos de configuración almacenan la configuración en formato XML.</span><span class="sxs-lookup"><span data-stu-id="f9293-133">All three configuration files store settings in XML format.</span></span> <span data-ttu-id="f9293-134">El elemento XML de nivel superior para la configuración de ámbito de la aplicación es `<appSettings>`, mientras que `<userSettings>` se utiliza para la configuración de ámbito de usuario.</span><span class="sxs-lookup"><span data-stu-id="f9293-134">The top-level XML element for application-scoped settings is `<appSettings>`, while `<userSettings>` is used for user-scoped settings.</span></span> <span data-ttu-id="f9293-135">Un archivo `app`.exe.config que contiene la configuración de ámbito de la aplicación y los valores predeterminados para la configuración de ámbito de usuario tendría el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="f9293-135">An `app`.exe.config file which contains both application-scoped settings and defaults for user-scoped settings would look like this:</span></span>  
  
```xml  
<?xml version="1.0" encoding="utf-8" ?>  
<configuration>  
    <configSections>  
        <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >  
            <section name="WindowsApplication1.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />  
        </sectionGroup>  
        <sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >  
            <section name="WindowsApplication1.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" />  
        </sectionGroup>  
    </configSections>  
    <applicationSettings>  
        <WindowsApplication1.Properties.Settings>  
            <setting name="Cursor" serializeAs="String">  
                <value>Default</value>  
            </setting>  
            <setting name="DoubleBuffering" serializeAs="String">  
                <value>False</value>  
            </setting>  
        </WindowsApplication1.Properties.Settings>  
    </applicationSettings>  
    <userSettings>  
        <WindowsApplication1.Properties.Settings>  
            <setting name="FormTitle" serializeAs="String">  
                <value>Form1</value>  
            </setting>  
            <setting name="FormSize" serializeAs="String">  
                <value>595, 536</value>  
            </setting>  
        </WindowsApplication1.Properties.Settings>  
    </userSettings>  
</configuration>  
```  
  
 <span data-ttu-id="f9293-136">Para obtener una definición de los elementos incluidos en la sección de configuración de aplicación de un archivo de configuración, consulte [Esquema de la configuración de la aplicación](../../configure-apps/file-schema/application-settings-schema.md).</span><span class="sxs-lookup"><span data-stu-id="f9293-136">For a definition of the elements within the application settings section of a configuration file, see [Application Settings Schema](../../configure-apps/file-schema/application-settings-schema.md).</span></span>  
  
### <a name="settings-bindings"></a><span data-ttu-id="f9293-137">Enlaces de configuración</span><span class="sxs-lookup"><span data-stu-id="f9293-137">Settings Bindings</span></span>  
 <span data-ttu-id="f9293-138">La configuración de aplicación utiliza la arquitectura de enlace de datos de Windows Forms para proporcionar una comunicación bidireccional de actualizaciones de parámetros de configuración entre el objeto de configuración y los componentes.</span><span class="sxs-lookup"><span data-stu-id="f9293-138">Application settings uses the Windows Forms data binding architecture to provide two-way communication of settings updates between the settings object and components.</span></span> <span data-ttu-id="f9293-139">Si utiliza Visual Studio para crear configuraciones de aplicación y asignarlas a las propiedades de componente, estos enlaces se generarán automáticamente.</span><span class="sxs-lookup"><span data-stu-id="f9293-139">If you use Visual Studio to create application settings and assign them to component properties, these bindings are generated automatically.</span></span>  
  
 <span data-ttu-id="f9293-140">Configuración de la aplicación sólo puede enlazar a un componente que admita el <xref:System.Windows.Forms.IBindableComponent> interfaz.</span><span class="sxs-lookup"><span data-stu-id="f9293-140">You can only bind an application setting to a component that supports the <xref:System.Windows.Forms.IBindableComponent> interface.</span></span> <span data-ttu-id="f9293-141">Además, el componente debe implementar un evento de cambio de propiedad enlazada a un determinado, o notificar a la configuración que ha cambiado la propiedad a través de la <xref:System.ComponentModel.INotifyPropertyChanged> interfaz.</span><span class="sxs-lookup"><span data-stu-id="f9293-141">Also, the component must implement a change event for a specific bound property, or notify application settings that the property has changed through the <xref:System.ComponentModel.INotifyPropertyChanged> interface.</span></span> <span data-ttu-id="f9293-142">Si el componente no implementa <xref:System.Windows.Forms.IBindableComponent> y enlaza a través de Visual Studio, las propiedades enlazadas se establecerán la primera vez, pero no se actualizarán.</span><span class="sxs-lookup"><span data-stu-id="f9293-142">If the component does not implement <xref:System.Windows.Forms.IBindableComponent> and you are binding through Visual Studio, the bound properties will be set the first time, but will not update.</span></span> <span data-ttu-id="f9293-143">Si el componente implementa <xref:System.Windows.Forms.IBindableComponent> pero las notificaciones de cambios de propiedad de soporte técnico no, el enlace no se actualizará en el archivo de configuración cuando se cambia la propiedad.</span><span class="sxs-lookup"><span data-stu-id="f9293-143">If the component implements <xref:System.Windows.Forms.IBindableComponent> but does not support property change notifications, the binding will not update in the settings file when the property is changed.</span></span>  
  
 <span data-ttu-id="f9293-144">Algunos componentes de Windows Forms, como <xref:System.Windows.Forms.ToolStripItem>, no se admiten enlaces de configuración.</span><span class="sxs-lookup"><span data-stu-id="f9293-144">Some Windows Forms components, such as <xref:System.Windows.Forms.ToolStripItem>, do not support settings bindings.</span></span>  
  
### <a name="settings-serialization"></a><span data-ttu-id="f9293-145">Serialización de la configuración</span><span class="sxs-lookup"><span data-stu-id="f9293-145">Settings Serialization</span></span>  
 <span data-ttu-id="f9293-146">Cuando <xref:System.Configuration.LocalFileSettingsProvider> debe guardar la configuración en el disco, realiza las acciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="f9293-146">When <xref:System.Configuration.LocalFileSettingsProvider> must save settings to disk, it performs the following actions:</span></span>  
  
1. <span data-ttu-id="f9293-147">Usa la reflexión para examinar todas las propiedades definidas en su <xref:System.Configuration.ApplicationSettingsBase> clase derivada, encontrando aquellas que se aplican con cualquiera <xref:System.Configuration.ApplicationScopedSettingAttribute> o <xref:System.Configuration.UserScopedSettingAttribute>.</span><span class="sxs-lookup"><span data-stu-id="f9293-147">Uses reflection to examine all of the properties defined on your <xref:System.Configuration.ApplicationSettingsBase> derived class, finding those that are applied with either <xref:System.Configuration.ApplicationScopedSettingAttribute> or <xref:System.Configuration.UserScopedSettingAttribute>.</span></span>  
  
2. <span data-ttu-id="f9293-148">Serializa la propiedad en el disco.</span><span class="sxs-lookup"><span data-stu-id="f9293-148">Serializes the property to disk.</span></span> <span data-ttu-id="f9293-149">Primero intenta llamar a la <xref:System.ComponentModel.TypeConverter.ConvertToString%2A> o <xref:System.ComponentModel.TypeConverter.ConvertFromString%2A> en el tipo de asociado del <xref:System.ComponentModel.TypeConverter>.</span><span class="sxs-lookup"><span data-stu-id="f9293-149">It first attempts to call the <xref:System.ComponentModel.TypeConverter.ConvertToString%2A> or <xref:System.ComponentModel.TypeConverter.ConvertFromString%2A> on the type's associated <xref:System.ComponentModel.TypeConverter>.</span></span> <span data-ttu-id="f9293-150">Si esto no tiene éxito, en su lugar utiliza la serialización XML.</span><span class="sxs-lookup"><span data-stu-id="f9293-150">If this does not succeed, it uses XML serialization instead.</span></span>  
  
3. <span data-ttu-id="f9293-151">Determina qué configuración corresponde a cada archivo, basándose en el atributo de la configuración.</span><span class="sxs-lookup"><span data-stu-id="f9293-151">Determines which settings go in which files, based on the setting's attribute.</span></span>  
  
 <span data-ttu-id="f9293-152">Si implementa su propia clase de configuración, puede usar el <xref:System.Configuration.SettingsSerializeAsAttribute> para marcar una configuración para la serialización binaria o personalizada utilizando el <xref:System.Configuration.SettingsSerializeAs> enumeración.</span><span class="sxs-lookup"><span data-stu-id="f9293-152">If you implement your own settings class, you can use the <xref:System.Configuration.SettingsSerializeAsAttribute> to mark a setting for either binary or custom serialization using the <xref:System.Configuration.SettingsSerializeAs> enumeration.</span></span> <span data-ttu-id="f9293-153">Para obtener más información sobre cómo crear su propia clase de configuración en código, vea [Cómo: Crear configuración de la aplicación](how-to-create-application-settings.md).</span><span class="sxs-lookup"><span data-stu-id="f9293-153">For more information on creating your own settings class in code, see [How to: Create Application Settings](how-to-create-application-settings.md).</span></span>  
  
### <a name="settings-file-locations"></a><span data-ttu-id="f9293-154">Ubicaciones del archivo de configuración</span><span class="sxs-lookup"><span data-stu-id="f9293-154">Settings File Locations</span></span>  
 <span data-ttu-id="f9293-155">La ubicación de los archivos `app`.exe.config y *usuario*.config diferirá según cómo se instale la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f9293-155">The location of the `app`.exe.config and *user*.config files will differ based on how the application is installed.</span></span> <span data-ttu-id="f9293-156">Para una aplicación basada en formularios de Windows se copian en el equipo local, `app`. exe.config residirá en el mismo directorio que el directorio base del archivo ejecutable principal de la aplicación, y *usuario*.config residirá en el ubicación especificada por el <xref:System.Windows.Forms.Application.LocalUserAppDataPath%2A?displayProperty=nameWithType> propiedad.</span><span class="sxs-lookup"><span data-stu-id="f9293-156">For a Windows Forms-based application copied onto the local computer, `app`.exe.config will reside in the same directory as the base directory of the application's main executable file, and *user*.config will reside in the location specified by the <xref:System.Windows.Forms.Application.LocalUserAppDataPath%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="f9293-157">Para una aplicación instalada mediante [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)], los dos archivos residirán en el directorio de datos de [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] en %InstallRoot%\Documents and Settings\\*nombreDeUsuario*\Local Settings.</span><span class="sxs-lookup"><span data-stu-id="f9293-157">For an application installed by means of [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)], both of these files will reside in the [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] Data Directory underneath %InstallRoot%\Documents and Settings\\*username*\Local Settings.</span></span>  
  
 <span data-ttu-id="f9293-158">La ubicación de almacenamiento de estos archivos es diferente si un usuario habilita perfiles móviles, lo que permite a dicho usuario definir diferentes configuraciones de aplicación y de Windows cuando utilice otros equipos dentro de un dominio.</span><span class="sxs-lookup"><span data-stu-id="f9293-158">The storage location of these files is slightly different if a user has enabled roaming profiles, which enables a user to define different Windows and application settings when he or she is using other computers within a domain.</span></span> <span data-ttu-id="f9293-159">En ese caso, tanto las aplicaciones de [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] como las que no sean de [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] tendrán archivos `app`.exe.config y *usuario*.config almacenados en %InstallRoot%\Documents and Settings\\*nombreDeUsuario*\Application Data.</span><span class="sxs-lookup"><span data-stu-id="f9293-159">In that case, both [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] applications and non-[!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] applications will have their `app`.exe.config and *user*.config files stored under %InstallRoot%\Documents and Settings\\*username*\Application Data.</span></span>  
  
 <span data-ttu-id="f9293-160">Para más información sobre cómo funciona la característica Configuración de la aplicación con la nueva tecnología de implementación, vea [ClickOnce y configuración de la aplicación](/visualstudio/deployment/clickonce-and-application-settings).</span><span class="sxs-lookup"><span data-stu-id="f9293-160">For more information about how the Application Settings feature works with the new deployment technology, see [ClickOnce and Application Settings](/visualstudio/deployment/clickonce-and-application-settings).</span></span> <span data-ttu-id="f9293-161">Para más información sobre el directorio de datos de [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)], vea [Obtener acceso local o remoto a los datos en aplicaciones ClickOnce](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications).</span><span class="sxs-lookup"><span data-stu-id="f9293-161">For more information about the [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] Data Directory, see [Accessing Local and Remote Data in ClickOnce Applications](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications).</span></span>  
  
## <a name="application-settings-and-security"></a><span data-ttu-id="f9293-162">Configuración de la aplicación y seguridad</span><span class="sxs-lookup"><span data-stu-id="f9293-162">Application Settings and Security</span></span>  
 <span data-ttu-id="f9293-163">La configuración de la aplicación está diseñada para trabajar con confianza parcial, un entorno restringido predeterminado en las aplicaciones de Windows Forms hospedadas en la intranet y en Internet.</span><span class="sxs-lookup"><span data-stu-id="f9293-163">Application settings are designed to work in partial trust, a restricted environment that is the default for Windows Forms applications hosted over the Internet or an intranet.</span></span> <span data-ttu-id="f9293-164">No es necesario ningún permiso especial más allá de la confianza parcial para utilizar la configuración de la aplicación con el proveedor de configuración predeterminado.</span><span class="sxs-lookup"><span data-stu-id="f9293-164">No special permissions beyond partial trust are needed to use application settings with the default settings provider.</span></span>  
  
 <span data-ttu-id="f9293-165">Cuando los parámetros de configuración de la aplicación se utilizan en una aplicación de [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)], el archivo `user`.config se almacena en el directorio de datos de [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f9293-165">When application settings are used in a [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] application, the `user`.config file is stored in the [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] data directory.</span></span> <span data-ttu-id="f9293-166">El tamaño del archivo `user`.config de la aplicación no puede superar la cuota de directorio de datos establecida por [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f9293-166">The size of the application's `user`.config file cannot exceed the data directory quota set by [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)].</span></span> <span data-ttu-id="f9293-167">Para más información, consulte [ClickOnce y configuración de la aplicación](/visualstudio/deployment/clickonce-and-application-settings).</span><span class="sxs-lookup"><span data-stu-id="f9293-167">For more information, see [ClickOnce and Application Settings](/visualstudio/deployment/clickonce-and-application-settings).</span></span>  
  
## <a name="custom-settings-providers"></a><span data-ttu-id="f9293-168">Proveedores de configuración personalizados</span><span class="sxs-lookup"><span data-stu-id="f9293-168">Custom Settings Providers</span></span>  
 <span data-ttu-id="f9293-169">En la arquitectura de configuración de la aplicación, hay una correspondencia imprecisa entre la configuración de aplicaciones clase contenedora, derivado de <xref:System.Configuration.ApplicationSettingsBase>, y el proveedor de configuración asociado o proveedores, deriva <xref:System.Configuration.SettingsProvider>.</span><span class="sxs-lookup"><span data-stu-id="f9293-169">In the Application Settings architecture, there is a loose coupling between the applications settings wrapper class, derived from <xref:System.Configuration.ApplicationSettingsBase>, and the associated settings provider or providers, derived from <xref:System.Configuration.SettingsProvider>.</span></span> <span data-ttu-id="f9293-170">Esta asociación se define únicamente por la <xref:System.Configuration.SettingsProviderAttribute> aplicado a la clase contenedora o a sus propiedades individuales.</span><span class="sxs-lookup"><span data-stu-id="f9293-170">This association is defined only by the <xref:System.Configuration.SettingsProviderAttribute> applied to the wrapper class or its individual properties.</span></span> <span data-ttu-id="f9293-171">Si especifica una configuración de proveedor no está explícitamente, el proveedor predeterminado, <xref:System.Configuration.LocalFileSettingsProvider>, se utiliza.</span><span class="sxs-lookup"><span data-stu-id="f9293-171">If a settings provider is not explicitly specified, the default provider, <xref:System.Configuration.LocalFileSettingsProvider>, is used.</span></span> <span data-ttu-id="f9293-172">Como resultado, esta arquitectura admite la creación y el uso de proveedores de valores de configuración personalizados.</span><span class="sxs-lookup"><span data-stu-id="f9293-172">As a result, this architecture supports creating and using custom settings providers.</span></span>  
  
 <span data-ttu-id="f9293-173">Por ejemplo, suponga que desea desarrollar y utilizar `SqlSettingsProvider`, un proveedor que almacenará todos los valores de configuración en una base de datos de Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f9293-173">For example, suppose that you want to develop and use `SqlSettingsProvider`, a provider that will store all settings data in a Microsoft SQL Server database.</span></span> <span data-ttu-id="f9293-174">Su <xref:System.Configuration.SettingsProvider>-clase derivada recibiría esta información en su `Initialize` método como un parámetro de tipo <xref:System.Collections.Specialized.NameValueCollection?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="f9293-174">Your <xref:System.Configuration.SettingsProvider>-derived class would receive this information in its `Initialize` method as a parameter of type <xref:System.Collections.Specialized.NameValueCollection?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f9293-175">A continuación implementaría el <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> método para recuperar la configuración del almacén de datos, y <xref:System.Configuration.SettingsProvider.SetPropertyValues%2A> para guardarlas.</span><span class="sxs-lookup"><span data-stu-id="f9293-175">You would then implement the <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> method to retrieve your settings from the data store, and <xref:System.Configuration.SettingsProvider.SetPropertyValues%2A> to save them.</span></span> <span data-ttu-id="f9293-176">El proveedor puede usar el <xref:System.Configuration.SettingsPropertyCollection> proporcionado a <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> para determinar el nombre, tipo y ámbito de la propiedad, así como cualquier otro atributo de configuración definidos para esa propiedad.</span><span class="sxs-lookup"><span data-stu-id="f9293-176">Your provider can use the <xref:System.Configuration.SettingsPropertyCollection> supplied to <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> to determine the property's name, type, and scope, as well as any other settings attributes defined for that property.</span></span>  
  
 <span data-ttu-id="f9293-177">El proveedor necesitará implementar una propiedad y un método cuyas implementaciones pueden no ser evidentes.</span><span class="sxs-lookup"><span data-stu-id="f9293-177">Your provider will need to implement one property and one method whose implementations may not be obvious.</span></span> <span data-ttu-id="f9293-178">El <xref:System.Configuration.SettingsProvider.ApplicationName%2A> es una propiedad abstracta del <xref:System.Configuration.SettingsProvider>; debería programarla para devolver lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="f9293-178">The <xref:System.Configuration.SettingsProvider.ApplicationName%2A> property is an abstract property of <xref:System.Configuration.SettingsProvider>; you should program it to return the following:</span></span>  
  
 [!code-csharp[ApplicationSettings.Architecture#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Architecture/CS/DummyClass.cs#2)]
 [!code-vb[ApplicationSettings.Architecture#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Architecture/VB/DummyProviderClass.vb#2)]  
  
 <span data-ttu-id="f9293-179">Su clase derivada también debe implementar un método `Initialize` que no toma ningún argumento y no devuelve ningún valor.</span><span class="sxs-lookup"><span data-stu-id="f9293-179">Your derived class must also implement an `Initialize` method that takes no arguments and returns no value.</span></span> <span data-ttu-id="f9293-180">Este método no está definido por <xref:System.Configuration.SettingsProvider>.</span><span class="sxs-lookup"><span data-stu-id="f9293-180">This method is not defined by <xref:System.Configuration.SettingsProvider>.</span></span>  
  
 <span data-ttu-id="f9293-181">Finalmente, implemente <xref:System.Configuration.IApplicationSettingsProvider> en su proveedor para proporcionar compatibilidad para actualizar la configuración, revertiendo la configuración a sus valores predeterminados y actualizar la configuración de la versión de una aplicación a otro.</span><span class="sxs-lookup"><span data-stu-id="f9293-181">Finally, you implement <xref:System.Configuration.IApplicationSettingsProvider> on your provider to provide support for refreshing settings, reverting settings to their defaults, and upgrading settings from one application version to another.</span></span>  
  
 <span data-ttu-id="f9293-182">Una vez implementado y compilado su proveedor, es necesario indicar a su clase de configuración que debe utilizar este proveedor en lugar del predeterminado.</span><span class="sxs-lookup"><span data-stu-id="f9293-182">Once you have implemented and compiled your provider, you need to instruct your settings class to use this provider instead of the default.</span></span> <span data-ttu-id="f9293-183">Para ello, a través de la <xref:System.Configuration.SettingsProviderAttribute>.</span><span class="sxs-lookup"><span data-stu-id="f9293-183">You accomplish this through the <xref:System.Configuration.SettingsProviderAttribute>.</span></span> <span data-ttu-id="f9293-184">Si se aplica a una clase de configuración completa, se utiliza el proveedor para cada configuración que define la clase; Si se aplica a configuraciones independientes, arquitectura de configuración de la aplicación utiliza ese proveedor para ver esas configuraciones solo y utiliza <xref:System.Configuration.LocalFileSettingsProvider> para el resto.</span><span class="sxs-lookup"><span data-stu-id="f9293-184">If applied to an entire settings class, the provider is used for each setting that the class defines; if applied to individual settings, Application Settings architecture uses that provider for those settings only, and uses <xref:System.Configuration.LocalFileSettingsProvider> for the rest.</span></span> <span data-ttu-id="f9293-185">El ejemplo de código siguiente muestra cómo indicar a la clase de configuración que utilice su proveedor personalizado.</span><span class="sxs-lookup"><span data-stu-id="f9293-185">The following code example shows how to instruct the settings class to use your custom provider.</span></span>  
  
 [!code-csharp[ApplicationSettings.Architecture#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Architecture/CS/DummyClass.cs#1)]
 [!code-vb[ApplicationSettings.Architecture#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Architecture/VB/DummyProviderClass.vb#1)]  
  
 <span data-ttu-id="f9293-186">Se puede llamar a un proveedor simultáneamente desde varios subprocesos, pero siempre se escribe en la misma ubicación de almacenamiento; por tanto, la arquitectura de la Configuración de la aplicación solo creará una única instancia de la clase del proveedor.</span><span class="sxs-lookup"><span data-stu-id="f9293-186">A provider may be called from multiple threads simultaneously, but it will always write to the same storage location; therefore, the Application Settings architecture will only ever instantiate a single instance of your provider class.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="f9293-187">Debería asegurarse de que su proveedor es seguro para subprocesos y que solo permite un subproceso al mismo tiempo que escribe en los archivos de configuración.</span><span class="sxs-lookup"><span data-stu-id="f9293-187">You should ensure that your provider is thread-safe, and only allows one thread at a time to write to the configuration files.</span></span>  
  
 <span data-ttu-id="f9293-188">El proveedor no necesita admitir todos los valores de atributos definidos en el <xref:System.Configuration?displayProperty=nameWithType> espacio de nombres, aunque debe un soporte mínimo <xref:System.Configuration.ApplicationScopedSettingAttribute> y <xref:System.Configuration.UserScopedSettingAttribute>y también debe admitir <xref:System.Configuration.DefaultSettingValueAttribute>.</span><span class="sxs-lookup"><span data-stu-id="f9293-188">Your provider does not need to support all of the settings attributes defined in the <xref:System.Configuration?displayProperty=nameWithType> namespace, though it must at a minimum support <xref:System.Configuration.ApplicationScopedSettingAttribute> and <xref:System.Configuration.UserScopedSettingAttribute>, and should also support <xref:System.Configuration.DefaultSettingValueAttribute>.</span></span> <span data-ttu-id="f9293-189">Para esos atributos que no admite, el proveedor solo debería enviar un mensaje de error sin notificación, no producir una excepción.</span><span class="sxs-lookup"><span data-stu-id="f9293-189">For those attributes that it does not support, your provider should just fail without notification; it should not throw an exception.</span></span> <span data-ttu-id="f9293-190">Si la clase de configuración utiliza una combinación no válida de atributos, sin embargo, como la aplicación <xref:System.Configuration.ApplicationScopedSettingAttribute> y <xref:System.Configuration.UserScopedSettingAttribute> a la misma configuración, el proveedor debe producir una excepción y dejara de funcionar.</span><span class="sxs-lookup"><span data-stu-id="f9293-190">If the settings class uses an invalid combination of attributes, however — such as applying <xref:System.Configuration.ApplicationScopedSettingAttribute> and <xref:System.Configuration.UserScopedSettingAttribute> to the same setting — your provider should throw an exception and cease operation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f9293-191">Vea también</span><span class="sxs-lookup"><span data-stu-id="f9293-191">See also</span></span>

- <xref:System.Configuration.ApplicationSettingsBase>
- <xref:System.Configuration.SettingsProvider>
- <xref:System.Configuration.LocalFileSettingsProvider>
- [<span data-ttu-id="f9293-192">Introducción a la configuración de la aplicación</span><span class="sxs-lookup"><span data-stu-id="f9293-192">Application Settings Overview</span></span>](application-settings-overview.md)
- [<span data-ttu-id="f9293-193">Application Settings for Custom Controls</span><span class="sxs-lookup"><span data-stu-id="f9293-193">Application Settings for Custom Controls</span></span>](application-settings-for-custom-controls.md)
- [<span data-ttu-id="f9293-194">ClickOnce y la configuración de la aplicación</span><span class="sxs-lookup"><span data-stu-id="f9293-194">ClickOnce and Application Settings</span></span>](/visualstudio/deployment/clickonce-and-application-settings)
- [<span data-ttu-id="f9293-195">Esquema de la configuración de la aplicación</span><span class="sxs-lookup"><span data-stu-id="f9293-195">Application Settings Schema</span></span>](../../configure-apps/file-schema/application-settings-schema.md)
