---
title: Contadores de rendimiento y aplicaciones en paralelo en proceso
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- performance counters
- performance counters,and in-process side-by-side applications
- performance,.NET Framework applications
- performance monitoring,counters
ms.assetid: 6888f9be-c65b-4b03-a07b-df7ebdee2436
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 3c583e9568a55b994f0516af2dcdf29f0d0f21fb
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/22/2019
ms.locfileid: "69967274"
---
# <a name="performance-counters-and-in-process-side-by-side-applications"></a><span data-ttu-id="7aabd-102">Contadores de rendimiento y aplicaciones en paralelo en proceso</span><span class="sxs-lookup"><span data-stu-id="7aabd-102">Performance Counters and In-Process Side-By-Side Applications</span></span>
<span data-ttu-id="7aabd-103">Con el Monitor de rendimiento (Perfmon.exe), es posible diferenciar los contadores de rendimiento por tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="7aabd-103">Using the Performance Monitor (Perfmon.exe), it is possible to differentiate the performance counters on a per-runtime basis.</span></span> <span data-ttu-id="7aabd-104">En este tema se describe el cambio del Registro necesario para habilitar esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="7aabd-104">This topic describes the registry change needed to enable this functionality.</span></span>  
  
## <a name="the-default-behavior"></a><span data-ttu-id="7aabd-105">El comportamiento predeterminado</span><span class="sxs-lookup"><span data-stu-id="7aabd-105">The Default Behavior</span></span>  
 <span data-ttu-id="7aabd-106">De forma predeterminada, el Monitor de rendimiento muestra los contadores de rendimiento según cada aplicación.</span><span class="sxs-lookup"><span data-stu-id="7aabd-106">By default, the Performance Monitor displays performance counters on a per-application basis.</span></span> <span data-ttu-id="7aabd-107">Pero hay dos escenarios en los que esto es problemático:</span><span class="sxs-lookup"><span data-stu-id="7aabd-107">However, there are two scenarios in which this is problematic:</span></span>  
  
- <span data-ttu-id="7aabd-108">Al supervisar dos aplicaciones que tienen el mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="7aabd-108">When you monitor two applications that have the same name.</span></span> <span data-ttu-id="7aabd-109">Por ejemplo, si ambas aplicaciones se denominan myapp.exe, una se mostrará como **myapp** y la otra como **myapp#1** en la columna **Instance**.</span><span class="sxs-lookup"><span data-stu-id="7aabd-109">For example, if both applications are named myapp.exe, one will be displayed as **myapp** and the other as **myapp#1** in the **Instance** column.</span></span> <span data-ttu-id="7aabd-110">En este caso, es difícil que un contador de rendimiento coincida con una aplicación determinada.</span><span class="sxs-lookup"><span data-stu-id="7aabd-110">In this case, it is difficult to match a performance counter to a particular application.</span></span> <span data-ttu-id="7aabd-111">No está claro si los datos recopilados para **myapp#1** hacen referencia a la primera myapp.exe o a la segunda.</span><span class="sxs-lookup"><span data-stu-id="7aabd-111">It is not clear whether the data collected for **myapp#1** refers to the first myapp.exe or the second myapp.exe.</span></span>  
  
- <span data-ttu-id="7aabd-112">Cuando una aplicación usa varias instancias de Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="7aabd-112">When an application uses multiple instances of the common language runtime.</span></span> <span data-ttu-id="7aabd-113">El .NET Framework 4 admite escenarios de hospedaje en paralelo en el proceso; es decir, un único proceso o aplicación puede cargar varias instancias del Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="7aabd-113">The .NET Framework 4 supports in-process side-by-side hosting scenarios; that is, a single process or application can load multiple instances of the common language runtime.</span></span> <span data-ttu-id="7aabd-114">Si una aplicación denominada myapp.exe carga dos instancias de tiempo de ejecución, se designarán en la columna **Instance** como **myapp** y **myapp#1** de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="7aabd-114">If a single application named myapp.exe loads two runtime instances, by default, they will be designated in the **Instance** column as **myapp** and **myapp#1**.</span></span> <span data-ttu-id="7aabd-115">En este caso, no está claro si **myapp** y **myapp#1** hacen referencia a dos aplicaciones con el mismo nombre, o a la misma aplicación con dos tiempos de ejecución.</span><span class="sxs-lookup"><span data-stu-id="7aabd-115">In this case, it is not clear whether **myapp** and **myapp#1** refer to two applications with the same name, or to the same application with two runtimes.</span></span> <span data-ttu-id="7aabd-116">Si varias aplicaciones con el mismo nombre cargan varios tiempos de ejecución, la ambigüedad es incluso mayor.</span><span class="sxs-lookup"><span data-stu-id="7aabd-116">If multiple applications with the same name load multiple runtimes, the ambiguity is even greater.</span></span>  
  
 <span data-ttu-id="7aabd-117">Puede establecer una clave del Registro para eliminar esta ambigüedad.</span><span class="sxs-lookup"><span data-stu-id="7aabd-117">You can set a registry key to eliminate this ambiguity.</span></span> <span data-ttu-id="7aabd-118">En el caso de las aplicaciones desarrolladas con el .NET Framework 4, este cambio del registro agrega un identificador de proceso seguido de un identificador de instancia en tiempo de ejecución al nombre de la aplicación en la columna **instancia** .</span><span class="sxs-lookup"><span data-stu-id="7aabd-118">For applications developed using the .NET Framework 4, this registry change adds a process identifier followed by a runtime instance identifier to the application name in the **Instance** column.</span></span> <span data-ttu-id="7aabd-119">En lugar de *aplicación* o *aplicación*#1, la aplicación ahora se identifica como *aplicación*_`p`*ID_proceso*\_`r`*ID_tiempo de ejecución* en la columna **Instance**.</span><span class="sxs-lookup"><span data-stu-id="7aabd-119">Instead of *application* or *application*#1, the application is now identified as *application*_`p`*processID*\_`r`*runtimeID* in the **Instance** column.</span></span> <span data-ttu-id="7aabd-120">Si una aplicación se desarrolló con una versión anterior del Common Language Runtime, esa instancia se representa como*processID* de *aplicación\_* `p`, siempre que esté instalado el .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="7aabd-120">If an application was developed using a previous version of the common language runtime, that instance is represented as *application\_*`p`*processID* provided that the .NET Framework 4 is installed.</span></span>  
  
## <a name="performance-counters-for-in-process-side-by-side-applications"></a><span data-ttu-id="7aabd-121">Contadores de rendimiento para aplicaciones en paralelo en proceso</span><span class="sxs-lookup"><span data-stu-id="7aabd-121">Performance Counters for In-Process Side-by-Side Applications</span></span>  
 <span data-ttu-id="7aabd-122">Para administrar los contadores de rendimiento para varias versiones de Common Language Runtime que se hospedan en una sola aplicación, debe cambiar una única clave del Registro, como se muestra en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="7aabd-122">To handle performance counters for multiple common language runtime versions that are hosted in a single application, you must change a single registry key setting, as shown in the following table.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="7aabd-123">Nombre de clave</span><span class="sxs-lookup"><span data-stu-id="7aabd-123">Key name</span></span>|<span data-ttu-id="7aabd-124">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span><span class="sxs-lookup"><span data-stu-id="7aabd-124">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span></span>|  
|<span data-ttu-id="7aabd-125">Nombre del valor</span><span class="sxs-lookup"><span data-stu-id="7aabd-125">Value name</span></span>|<span data-ttu-id="7aabd-126">ProcessNameFormat</span><span class="sxs-lookup"><span data-stu-id="7aabd-126">ProcessNameFormat</span></span>|  
|<span data-ttu-id="7aabd-127">Tipo de valor</span><span class="sxs-lookup"><span data-stu-id="7aabd-127">Value type</span></span>|<span data-ttu-id="7aabd-128">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="7aabd-128">REG_DWORD</span></span>|  
|<span data-ttu-id="7aabd-129">Value</span><span class="sxs-lookup"><span data-stu-id="7aabd-129">Value</span></span>|<span data-ttu-id="7aabd-130">1 (0x00000001)</span><span class="sxs-lookup"><span data-stu-id="7aabd-130">1 (0x00000001)</span></span>|  
  
 <span data-ttu-id="7aabd-131">Un valor de 0 para `ProcessNameFormat` indica que el comportamiento predeterminado está habilitado; es decir, Perfmon.exe muestra los contadores de rendimiento según cada aplicación.</span><span class="sxs-lookup"><span data-stu-id="7aabd-131">A value of 0 for `ProcessNameFormat` indicates that the default behavior is enabled; that is, Perfmon.exe displays performance counters on a per-application basis.</span></span> <span data-ttu-id="7aabd-132">Cuando este valor se establece en 1, Perfmon.exe elimina la ambigüedad de varias versiones de una aplicación y proporciona contadores de rendimiento según cada tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="7aabd-132">When you set this value to 1, Perfmon.exe disambiguates multiple versions of an application and provides performance counters on a per-runtime basis.</span></span> <span data-ttu-id="7aabd-133">Cualquier otro valor para la clave del Registro `ProcessNameFormat` no es compatible y se reserva para uso en el futuro.</span><span class="sxs-lookup"><span data-stu-id="7aabd-133">Any other value for the `ProcessNameFormat` registry key setting is unsupported and reserved for future use.</span></span>  
  
 <span data-ttu-id="7aabd-134">Después de actualizar el valor de la clave del Registro `ProcessNameFormat`, debe reiniciar Perfmon.exe o cualquier otro consumidor de los contadores de rendimiento para que la nueva característica de asignación de nombres de instancia funcione correctamente.</span><span class="sxs-lookup"><span data-stu-id="7aabd-134">After you update the `ProcessNameFormat` registry key setting, you must restart Perfmon.exe or any other consumers of performance counters so that the new instance naming feature works correctly.</span></span>  
  
 <span data-ttu-id="7aabd-135">En el siguiente ejemplo se muestra cómo cambiar el valor `ProcessNameFormat` mediante programación.</span><span class="sxs-lookup"><span data-stu-id="7aabd-135">The following example shows how to change the `ProcessNameFormat` value programmatically.</span></span>  
  
 [!code-csharp[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/cs/regsetting1.cs#1)]
 [!code-vb[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/vb/regsetting1.vb#1)]  
  
 <span data-ttu-id="7aabd-136">Cuando realiza este cambio en el registro, Perfmon. exe muestra los nombres de las aplicaciones que tienen como destinoel .NET Framework`p`4 como Application _*processID*\_`r`*runtimeID*, donde *Application* es el nombre de la aplicación, *processID* es el identificador de proceso de la aplicación y *runtimeID* es un identificador de Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="7aabd-136">When you make this registry change, Perfmon.exe displays the names of applications that target the .NET Framework 4 as *application*_`p`*processID*\_`r`*runtimeID*, where *application* is the name of the application, *processID* is the application's process identifier, and *runtimeID* is a common language runtime identifier.</span></span> <span data-ttu-id="7aabd-137">Por ejemplo, si una aplicación denominada myapp.exe carga dos instancias de Common Language Runtime, Perfmon.exe puede identificar una instancia como myapp_p1416_r10 y la segunda como myapp_p3160_r10.</span><span class="sxs-lookup"><span data-stu-id="7aabd-137">For example, if an application named myapp.exe loads two instances of the common language runtime, Perfmon.exe may identify one instance as myapp_p1416_r10 and the second as myapp_p3160_r10.</span></span> <span data-ttu-id="7aabd-138">El identificador de tiempo de ejecución solo elimina la ambigüedad de los tiempos de ejecución dentro de un proceso; no proporciona ninguna otra información sobre el tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="7aabd-138">The runtime identifier only disambiguates the runtimes within a process; it does not provide any other information about the runtime.</span></span> <span data-ttu-id="7aabd-139">(Por ejemplo, el identificador de tiempo de ejecución no tiene ninguna relación con la versión o la SKU del tiempo de ejecución).</span><span class="sxs-lookup"><span data-stu-id="7aabd-139">(For example, the runtime ID has no relation to the version or the SKU of the runtime.)</span></span>  
  
 <span data-ttu-id="7aabd-140">Si el .NET Framework 4 está instalado, el cambio en el registro también afecta a las aplicaciones desarrolladas con versiones anteriores de la .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="7aabd-140">If the .NET Framework 4 is installed, the registry change also affects applications that were developed using earlier versions of the .NET Framework.</span></span> <span data-ttu-id="7aabd-141">Estas aparecen en Perfmon.exe como *aplicación_* `p`*ID_proceso*, donde *aplicación* es el nombre de la aplicación e *ID_proceso* es el identificador del proceso.</span><span class="sxs-lookup"><span data-stu-id="7aabd-141">These appear in Perfmon.exe as *application_*`p`*processID*, where *application* is the application name and *processID* is the process identifier.</span></span> <span data-ttu-id="7aabd-142">Por ejemplo, si se supervisan los contadores de rendimiento de dos aplicaciones denominadas myapp.exe, es posible que una aparezca como myapp_p23900 y la otra como myapp_p24908.</span><span class="sxs-lookup"><span data-stu-id="7aabd-142">For example, if the performance counters of two applications named myapp.exe are monitored, one might appear as myapp_p23900 and the other as myapp_p24908.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7aabd-143">El identificador de proceso elimina la ambigüedad de resolver dos aplicaciones con el mismo nombre que usan versiones anteriores del tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="7aabd-143">The process identifier eliminates the ambiguity of resolving two applications with the same name that use earlier versions of the runtime.</span></span> <span data-ttu-id="7aabd-144">No se necesita un identificador de tiempo de ejecución para las versiones anteriores, dado que las versiones anteriores de Common Language Runtime no admiten escenarios en paralelo.</span><span class="sxs-lookup"><span data-stu-id="7aabd-144">A runtime identifier is not required for previous versions, because previous versions of the common language runtime do not support side-by-side scenarios.</span></span>  
  
 <span data-ttu-id="7aabd-145">Si el .NET Framework 4 no está presente o se desinstaló, el establecimiento de la clave del registro no tiene ningún efecto.</span><span class="sxs-lookup"><span data-stu-id="7aabd-145">If the .NET Framework 4 is not present or was uninstalled, setting the registry key has no effect.</span></span> <span data-ttu-id="7aabd-146">Esto significa que dos aplicaciones con el mismo nombre seguirán apareciendo en Perfmon.exe como *aplicación* y *application#1* (por ejemplo, como **myapp** y **myapp#1**).</span><span class="sxs-lookup"><span data-stu-id="7aabd-146">This means that two applications with the same name will continue to appear in Perfmon.exe as *application* and *application#1* (for example, as **myapp** and **myapp#1**).</span></span>
