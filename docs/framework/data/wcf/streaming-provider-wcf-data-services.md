---
title: Proveedores de transmisión por secuencias (WCF Data Services)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, providers
- WCF Data Services, binary data
- streaming data provider [WCF Data Services]
- WCF Data Services, streams
ms.assetid: f0978fe4-5f9f-42aa-a5c2-df395d7c9495
ms.openlocfilehash: 19571f3102039176ed4d8fab46a7f8229cbfecbe
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/22/2019
ms.locfileid: "59980543"
---
# <a name="streaming-provider-wcf-data-services"></a><span data-ttu-id="0dee8-102">Proveedores de transmisión por secuencias (WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="0dee8-102">Streaming Provider (WCF Data Services)</span></span>

<span data-ttu-id="0dee8-103">Un servicio de datos puede exponer datos binarios de objetos grandes.</span><span class="sxs-lookup"><span data-stu-id="0dee8-103">A data service can expose large object binary data.</span></span> <span data-ttu-id="0dee8-104">Estos datos binarios pueden representar secuencias de vídeo y audio, imágenes, archivos de documento u otros tipos de medios binarios.</span><span class="sxs-lookup"><span data-stu-id="0dee8-104">This binary data might represent video and audio streams, images, document files, or other types of binary media.</span></span> <span data-ttu-id="0dee8-105">Cuando una entidad del modelo de datos incluye una o más propiedades binarias, el servicio de datos devuelve estos datos binarios codificados en base 64 en la entrada de la fuente de respuesta.</span><span class="sxs-lookup"><span data-stu-id="0dee8-105">When an entity in the data model includes one or more binary properties, the data service returns this binary data encoded as base-64 inside the entry in the response feed.</span></span> <span data-ttu-id="0dee8-106">Dado que carga y la serialización de datos binarios grandes de esta manera pueden afectar al rendimiento, la [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] define un mecanismo para recuperar datos binarios independientemente de la entidad a la que pertenece.</span><span class="sxs-lookup"><span data-stu-id="0dee8-106">Because loading and serializing large binary data in this manner can affect performance, the [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] defines a mechanism for retrieving binary data independent of the entity to which it belongs.</span></span> <span data-ttu-id="0dee8-107">Para ello, se separan los datos binarios de la entidad en uno o varios flujos de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-107">This is accomplished by separating the binary data from the entity into one or more data streams.</span></span>

- <span data-ttu-id="0dee8-108">Recurso multimedia: los datos binarios que pertenecen a una entidad, como vídeo, audio, imagen u otro tipo de flujo de recursos multimedia.</span><span class="sxs-lookup"><span data-stu-id="0dee8-108">Media resource - binary data that belongs to an entity, such as a video, audio, image or other type of media resource stream.</span></span>

- <span data-ttu-id="0dee8-109">Entrada de vínculo multimedia: entidad con una referencia a un flujo de recursos multimedia relacionado.</span><span class="sxs-lookup"><span data-stu-id="0dee8-109">Media link entry - an entity that has a reference to a related media resource stream.</span></span>

<span data-ttu-id="0dee8-110">Con [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], defina un flujo de recursos binarios implementando un proveedor de transmisión de datos por secuencias.</span><span class="sxs-lookup"><span data-stu-id="0dee8-110">With [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], you define a binary resource stream by implementing a streaming data provider.</span></span> <span data-ttu-id="0dee8-111">La implementación del proveedor de transmisión por secuencias proporciona el servicio de datos con la secuencia de recurso multimedia asociada con una entidad concreta como un <xref:System.IO.Stream> objeto.</span><span class="sxs-lookup"><span data-stu-id="0dee8-111">The streaming provider implementation supplies the data service with the media resource stream associated with a specific entity as an <xref:System.IO.Stream> object.</span></span> <span data-ttu-id="0dee8-112">Esta implementación permite que el servicio de datos acepte y devuelva los recursos multimedia a través del protocolo HTTP como flujos de datos binarios de un tipo MIME especificado.</span><span class="sxs-lookup"><span data-stu-id="0dee8-112">This implementation enables the data service to accept and return media resources over HTTP as binary data streams of a specified MIME type.</span></span>

<span data-ttu-id="0dee8-113">La configuración de un servicio de datos para que admita la transmisión por secuencias de datos binarios requiere los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="0dee8-113">Configuring a data service to support the streaming of binary data requires the following steps:</span></span>

1. <span data-ttu-id="0dee8-114">Atribuya una o más entidades del modelo de datos como una entrada de vínculo multimedia.</span><span class="sxs-lookup"><span data-stu-id="0dee8-114">Attribute one or more entities in the data model as a media link entry.</span></span> <span data-ttu-id="0dee8-115">Estas entidades no deben incluir los datos binarios que se van a transmitir por secuencias.</span><span class="sxs-lookup"><span data-stu-id="0dee8-115">These entities should not include the binary data to be streamed.</span></span> <span data-ttu-id="0dee8-116">Las propiedades binarias de una entidad siempre se devuelven en la entrada como datos binarios codificados en base 64.</span><span class="sxs-lookup"><span data-stu-id="0dee8-116">Any binary properties of an entity are always returned in the entry as base-64 encoded binary.</span></span>

2. <span data-ttu-id="0dee8-117">Implemente la interfaz T:System.Data.Services.Providers.IDataServiceStreamProvider.</span><span class="sxs-lookup"><span data-stu-id="0dee8-117">Implement the T:System.Data.Services.Providers.IDataServiceStreamProvider interface.</span></span>

3. <span data-ttu-id="0dee8-118">Defina un servicio de datos que implemente la interfaz <xref:System.IServiceProvider>.</span><span class="sxs-lookup"><span data-stu-id="0dee8-118">Define a data service that implements the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="0dee8-119">El servicio de datos usa la implementación del método <xref:System.IServiceProvider.GetService%2A> para acceder a la implementación del proveedor de transmisión de datos por secuencias.</span><span class="sxs-lookup"><span data-stu-id="0dee8-119">The data service uses the <xref:System.IServiceProvider.GetService%2A> implementation to access the streaming data provider implementation.</span></span> <span data-ttu-id="0dee8-120">Este método devuelve la implementación del proveedor de transmisión por secuencias adecuado.</span><span class="sxs-lookup"><span data-stu-id="0dee8-120">This method returns the appropriate streaming provider implementation.</span></span>

4. <span data-ttu-id="0dee8-121">Habilite flujos de mensajes grandes en la configuración de la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="0dee8-121">Enable large message streams in the Web application configuration.</span></span>

5. <span data-ttu-id="0dee8-122">Habilite el acceso a los recursos binarios en el servidor o en un origen de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-122">Enable access to binary resources on the server or in a data source.</span></span>

<span data-ttu-id="0dee8-123">Los ejemplos de este tema se basan en un ejemplo de servicio de fotografías, que se explica con más detalle en la entrada de transmisión por secuencias [serie de proveedor de transmisión por secuencias de servicios de datos: Implementar un proveedor de transmisión por secuencias (parte 1)](https://go.microsoft.com/fwlink/?LinkID=198989).</span><span class="sxs-lookup"><span data-stu-id="0dee8-123">The examples in this topic are based on a sample streaming photo service, which is discussed in depth in the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](https://go.microsoft.com/fwlink/?LinkID=198989).</span></span> <span data-ttu-id="0dee8-124">El código fuente para este servicio de ejemplo está disponible en el [página de ejemplo de servicio de datos de fotografía de transmisión por secuencias](https://go.microsoft.com/fwlink/?LinkID=198988) en la Galería de código de MSDN.</span><span class="sxs-lookup"><span data-stu-id="0dee8-124">The source code for this sample service is available on the [Streaming Photo Data Service Sample page](https://go.microsoft.com/fwlink/?LinkID=198988) on MSDN Code Gallery.</span></span>

## <a name="defining-a-media-link-entry-in-the-data-model"></a><span data-ttu-id="0dee8-125">Definir una entrada de vínculo multimedia en el modelo de datos</span><span class="sxs-lookup"><span data-stu-id="0dee8-125">Defining a Media Link Entry in the Data Model</span></span>

<span data-ttu-id="0dee8-126">El proveedor del origen de datos determina cómo se define una entidad como entrada de vínculo multimedia en el modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-126">The data source provider determines the way that an entity is defined as a media link entry in the data model.</span></span>

<span data-ttu-id="0dee8-127">**Proveedor de Entity Framework**</span><span class="sxs-lookup"><span data-stu-id="0dee8-127">**Entity Framework Provider**</span></span>

<span data-ttu-id="0dee8-128">Para indicar que una entidad es una entrada de vínculo multimedia, agregue el atributo `HasStream` a la definición del tipo de entidad en el modelo conceptual, como en el siguiente ejemplo:</span><span class="sxs-lookup"><span data-stu-id="0dee8-128">To indicate that an entity is a media link entry, add the `HasStream` attribute to the entity type definition in the conceptual model, as in the following example:</span></span>

[!code-xml[Astoria Photo Streaming Service#HasStream](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria_photo_streaming_service/xml/photodata.edmx#hasstream)]

<span data-ttu-id="0dee8-129">También debe agregar el espacio de nombres `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` a la entidad o a la raíz del archivo .edmx o del archivo .csdl que definen el modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-129">You must also add the namespace `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` either to the entity or to the root of the .edmx or .csdl file that defines the data model.</span></span>

<span data-ttu-id="0dee8-130">Para obtener un ejemplo de un servicio de datos que usa el [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)] proveedor y expone un recurso multimedia, consulte la publicación [serie de proveedor de transmisión por secuencias de servicios de datos: Implementar un proveedor de transmisión por secuencias (parte 1)](https://go.microsoft.com/fwlink/?LinkID=198989).</span><span class="sxs-lookup"><span data-stu-id="0dee8-130">For an example of a data service that uses the [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)] provider and exposes a media resource, see the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](https://go.microsoft.com/fwlink/?LinkID=198989).</span></span>

<span data-ttu-id="0dee8-131">**Proveedor de reflexión**</span><span class="sxs-lookup"><span data-stu-id="0dee8-131">**Reflection Provider**</span></span>

<span data-ttu-id="0dee8-132">Para indicar que una entidad es una entrada de vínculo multimedia, agregue el atributo <xref:System.Data.Services.Common.HasStreamAttribute> a la clase que define el tipo de entidad en el proveedor de reflexión.</span><span class="sxs-lookup"><span data-stu-id="0dee8-132">To indicate that an entity is a media link entry, add the <xref:System.Data.Services.Common.HasStreamAttribute> to the class that defines the entity type in the reflection provider.</span></span>

<span data-ttu-id="0dee8-133">**Proveedor de servicios de datos personalizados**</span><span class="sxs-lookup"><span data-stu-id="0dee8-133">**Custom Data Service Provider**</span></span>

<span data-ttu-id="0dee8-134">Cuando se usan proveedores de servicios personalizados, implemente la interfaz <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> para definir los metadatos del servicio de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-134">When using custom service providers, you implement the <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> interface to define the metadata for your data service.</span></span> <span data-ttu-id="0dee8-135">Para obtener más información, consulte [proveedores de servicios de datos personalizados](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="0dee8-135">For more information, see [Custom Data Service Providers](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md).</span></span> <span data-ttu-id="0dee8-136">Indique que un flujo de recurso binario pertenezca a la clase <xref:System.Data.Services.Providers.ResourceType> estableciendo el valor de la propiedad <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> en `true` en la clase <xref:System.Data.Services.Providers.ResourceType> que representa el tipo de entidad, que es una entrada de vínculo multimedia.</span><span class="sxs-lookup"><span data-stu-id="0dee8-136">You indicate that a binary resource stream belongs to a <xref:System.Data.Services.Providers.ResourceType> by setting the <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> property to `true` on the <xref:System.Data.Services.Providers.ResourceType> that represents the entity type, which is a media link entry.</span></span>

## <a name="implementing-the-idataservicestreamprovider-interface"></a><span data-ttu-id="0dee8-137">Implementar la interfaz IDataServiceStreamProvider</span><span class="sxs-lookup"><span data-stu-id="0dee8-137">Implementing the IDataServiceStreamProvider Interface</span></span>

<span data-ttu-id="0dee8-138">Para crear un servicio de datos que admita flujos de datos binarios, debe implementar la interfaz <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="0dee8-138">To create a data service that supports binary data streams, you must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface.</span></span> <span data-ttu-id="0dee8-139">Esta implementación habilita el servicio de datos para devolver al cliente datos binarios como flujo y utilizar los datos binarios como flujo enviado desde el cliente.</span><span class="sxs-lookup"><span data-stu-id="0dee8-139">This implementation enables the data service to return binary data as a stream to the client and consume binary data as a stream sent from the client.</span></span> <span data-ttu-id="0dee8-140">El servicio de datos crea una instancia de esta interfaz cuando sea necesario para acceder a los datos binarios como flujo.</span><span class="sxs-lookup"><span data-stu-id="0dee8-140">The data service creates an instance of this interface whenever it needs to access binary data as a stream.</span></span> <span data-ttu-id="0dee8-141">La interfaz <xref:System.Data.Services.Providers.IDataServiceStreamProvider> especifica los siguientes miembros:</span><span class="sxs-lookup"><span data-stu-id="0dee8-141">The <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface specifies the following members:</span></span>

|<span data-ttu-id="0dee8-142">Nombre de miembro</span><span class="sxs-lookup"><span data-stu-id="0dee8-142">Member name</span></span>|<span data-ttu-id="0dee8-143">Descripción</span><span class="sxs-lookup"><span data-stu-id="0dee8-143">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>|<span data-ttu-id="0dee8-144">El servicio de datos invoca este método para eliminar el recurso multimedia correspondiente cuando se elimina su entrada de vínculo multimedia.</span><span class="sxs-lookup"><span data-stu-id="0dee8-144">This method is invoked by the data service to delete the corresponding media resource when its media link entry is deleted.</span></span> <span data-ttu-id="0dee8-145">Cuando se implementa <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, este método contiene el código que elimina el recurso multimedia asociado con la entrada de vínculo multimedia proporcionada.</span><span class="sxs-lookup"><span data-stu-id="0dee8-145">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that deletes the media resource associated with the supplied media link entry.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>|<span data-ttu-id="0dee8-146">El servicio de datos invoca este método para devolver un recurso multimedia como un flujo.</span><span class="sxs-lookup"><span data-stu-id="0dee8-146">This method is invoked by the data service to return a media resource as a stream.</span></span> <span data-ttu-id="0dee8-147">Cuando se implementa <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, este método contiene el código que proporciona un flujo que el servicio de datos utiliza para devolver el recurso multimedia que está asociado a la entrada de vínculo multimedia proporcionada.</span><span class="sxs-lookup"><span data-stu-id="0dee8-147">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that provides a stream that is used by the data service to the return media resource that is associated with the provided media link entry.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStreamUri%2A>|<span data-ttu-id="0dee8-148">El servicio de datos invoca este método para devolver el URI que se utiliza para solicitar el recurso multimedia de la entrada de vínculo multimedia.</span><span class="sxs-lookup"><span data-stu-id="0dee8-148">This method is invoked by the data service to return the URI that is used to request the media resource for the media link entry.</span></span> <span data-ttu-id="0dee8-149">Este valor se usa para crear el atributo `src` en el elemento de contenido de la entrada de vínculo multimedia que se utiliza para solicitar el flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-149">This value is used to create the `src` attribute in the content element of the media link entry and that is used to request the data stream.</span></span> <span data-ttu-id="0dee8-150">Cuando este método devuelve `null`, el servicio de datos automáticamente determina el URI.</span><span class="sxs-lookup"><span data-stu-id="0dee8-150">When this method returns `null`, the data service automatically determines the URI.</span></span> <span data-ttu-id="0dee8-151">Use este método cuando deba proporcionar clientes con acceso directo a datos binarios sin usar el proveedor de flujos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-151">Use this method when you need to provide clients with direct access to binary data without using the steam provider.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamContentType%2A>|<span data-ttu-id="0dee8-152">El servicio de datos invoca este método para devolver el valor Content-Type del recurso multimedia asociado con la entrada de vínculo multimedia especificada.</span><span class="sxs-lookup"><span data-stu-id="0dee8-152">This method is invoked by the data service to return the Content-Type value of the media resource that is associated with the specified media link entry.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamETag%2A>|<span data-ttu-id="0dee8-153">El servicio de datos invoca este método para devolver el objeto eTag del flujo de datos que está asociado con la entidad especificada.</span><span class="sxs-lookup"><span data-stu-id="0dee8-153">This method is invoked by the data service to return the eTag of the data stream that is associated with the specified entity.</span></span> <span data-ttu-id="0dee8-154">Este método se utiliza cuando se administra la simultaneidad de los datos binarios.</span><span class="sxs-lookup"><span data-stu-id="0dee8-154">This method is used when you manage concurrency for the binary data.</span></span> <span data-ttu-id="0dee8-155">Cuando este método devuelve null, el servicio de datos no realiza el seguimiento de la simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="0dee8-155">When this method returns null, the data service does not track concurrency.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>|<span data-ttu-id="0dee8-156">El servicio de datos invoca este método para obtener el flujo que se utiliza cuando se recibe el flujo enviado desde el cliente.</span><span class="sxs-lookup"><span data-stu-id="0dee8-156">This method is invoked by the data service to obtain the stream that is used when receiving the stream sent from the client.</span></span> <span data-ttu-id="0dee8-157">Cuando implemente la interfaz <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, debe devolver un flujo grabable en el que el servicio de datos pueda escribir los datos del flujo recibidos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-157">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, you must return a writable stream to which the data service writes received stream data.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.ResolveType%2A>|<span data-ttu-id="0dee8-158">Devuelve un nombre de tipo calificado con el espacio de nombres que representa el tipo que el motor en tiempo de ejecución del servicio de datos debe crear para la entrada de vínculo multimedia asociada al flujo de datos del recurso multimedia que se está insertando.</span><span class="sxs-lookup"><span data-stu-id="0dee8-158">Returns a namespace-qualified type name that represents the type that the data service runtime must create for the media link entry that is associated with the data stream for the media resource that is being inserted.</span></span>|

## <a name="creating-the-streaming-data-service"></a><span data-ttu-id="0dee8-159">Crear el servicio de transmisión de datos por secuencias</span><span class="sxs-lookup"><span data-stu-id="0dee8-159">Creating the Streaming Data Service</span></span>

<span data-ttu-id="0dee8-160">Para proporcionar al motor de tiempo de ejecución de [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] acceso a la implementación de la interfaz <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, el servicio de datos que cree también debe implementar la interfaz <xref:System.IServiceProvider>.</span><span class="sxs-lookup"><span data-stu-id="0dee8-160">To provide the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] runtime with access to the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementation, the data service that you create must also implement the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="0dee8-161">En el siguiente ejemplo se muestra cómo implementar el método <xref:System.IServiceProvider.GetService%2A> para devolver una instancia de la clase `PhotoServiceStreamProvider` que implemente la interfaz <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="0dee8-161">The following example shows how to implement the <xref:System.IServiceProvider.GetService%2A> method to return an instance of the `PhotoServiceStreamProvider` class that implements <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span></span>

[!code-csharp[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_photo_streaming_service/cs/photodata.svc.cs#photoservicestreamingprovider)]
[!code-vb[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_photo_streaming_service/vb/photodata.svc.vb#photoservicestreamingprovider)]

<span data-ttu-id="0dee8-162">Para obtener información general sobre cómo crear un servicio de datos, vea [configurando el servicio de datos](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="0dee8-162">For general information about how to create a data service, see [Configuring the Data Service](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span></span>

## <a name="enabling-large-binary-streams-in-the-hosting-environment"></a><span data-ttu-id="0dee8-163">Habilitar flujos binarios grandes en el entorno de hospedaje</span><span class="sxs-lookup"><span data-stu-id="0dee8-163">Enabling Large Binary Streams in the Hosting Environment</span></span>

<span data-ttu-id="0dee8-164">Al crear un servicio de datos en una aplicación web [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)], Windows Communication Foundation (WCF) se utiliza para proporcionar la implementación del protocolo HTTP.</span><span class="sxs-lookup"><span data-stu-id="0dee8-164">When you create a data service in an [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Web application, Windows Communication Foundation (WCF) is used to provide the HTTP protocol implementation.</span></span> <span data-ttu-id="0dee8-165">De forma predeterminada, WCF limita el tamaño de los mensajes HTTP a solo 65 kilobytes.</span><span class="sxs-lookup"><span data-stu-id="0dee8-165">By default, WCF limits the size of HTTP messages to only 65K bytes.</span></span> <span data-ttu-id="0dee8-166">Para poder transmitir datos binarios grandes por secuencias al servicio de datos y desde él, debe configurar también la aplicación web para habilitar archivos binarios grandes y utilizar secuencias para la transferencia.</span><span class="sxs-lookup"><span data-stu-id="0dee8-166">To be able to stream large binary data to and from the data service, you must also configure the Web application to enable large binary files and to use streams for transfer.</span></span> <span data-ttu-id="0dee8-167">Para ello, en el elemento `<configuration />` del archivo Web.config de la aplicación agregue lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="0dee8-167">To do this, add the following in the `<configuration />` element of the application's Web.config file:</span></span>

> [!NOTE]
> <span data-ttu-id="0dee8-168">Debe usar un <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> modo de transferencia para asegurarse de que los datos binarios en mensajes de solicitud y respuesta se transmite por secuencias y no almacena en búfer por WCF.</span><span class="sxs-lookup"><span data-stu-id="0dee8-168">You must use a <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> transfer mode to ensure that the binary data in both the request and response messages are streamed and not buffered by WCF.</span></span>

<span data-ttu-id="0dee8-169">Para obtener más información, consulte [Streaming Message Transfer](../../../../docs/framework/wcf/feature-details/streaming-message-transfer.md) y [las cuotas de transporte](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="0dee8-169">For more information, see [Streaming Message Transfer](../../../../docs/framework/wcf/feature-details/streaming-message-transfer.md) and [Transport Quotas](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span></span>

<span data-ttu-id="0dee8-170">De forma predeterminada, Internet Information Services (IIS) también limita el tamaño de las respuestas a 4 MB.</span><span class="sxs-lookup"><span data-stu-id="0dee8-170">By default, Internet Information Services (IIS) also limits the size of requests to 4MB.</span></span> <span data-ttu-id="0dee8-171">Para habilitar el servicio de datos recibir flujos mayores que 4MB cuando se ejecuta en IIS, también debe establecer el `maxRequestLength` atributo de la [httpRuntime Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/e1f13641(v=vs.100)) en la `<system.web />` sección de configuración, como se muestra en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="0dee8-171">To enable your data service to receive streams larger than 4MB when running on IIS, you must also set the `maxRequestLength` attribute of the [httpRuntime Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/e1f13641(v=vs.100)) in the `<system.web />` configuration section, as shown in the following example:</span></span>

## <a name="using-data-streams-in-a-client-application"></a><span data-ttu-id="0dee8-172">Usar flujos de datos en una aplicación cliente</span><span class="sxs-lookup"><span data-stu-id="0dee8-172">Using Data Streams in a Client Application</span></span>

<span data-ttu-id="0dee8-173">La biblioteca cliente de [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] le permite recuperar y actualizar estos recursos expuestos como flujos binarios en el cliente.</span><span class="sxs-lookup"><span data-stu-id="0dee8-173">The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library enables you to both retrieve and update these exposed resources as binary streams on the client.</span></span> <span data-ttu-id="0dee8-174">Para obtener más información, consulte [trabajar con datos binarios](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="0dee8-174">For more information, see [Working with Binary Data](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span></span>

## <a name="considerations-for-working-with-a-streaming-provider"></a><span data-ttu-id="0dee8-175">Consideraciones para trabajar con un proveedor de transmisión por secuencias</span><span class="sxs-lookup"><span data-stu-id="0dee8-175">Considerations for Working with a Streaming Provider</span></span>

<span data-ttu-id="0dee8-176">A continuación se enumeran algunas de las consideraciones que debe tener en cuenta al implementar un proveedor de transmisiones por secuencias y al tener acceso a los recursos multimedia de un servicio de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-176">The following are things to consider when you implement a streaming provider and when you access media resources from a data service.</span></span>

- <span data-ttu-id="0dee8-177">Los recursos multimedia no admiten solicitudes MERGE.</span><span class="sxs-lookup"><span data-stu-id="0dee8-177">MERGE requests are not supported for media resources.</span></span> <span data-ttu-id="0dee8-178">Utilice una solicitud PUT para cambiar el recurso multimedia de una entidad existente.</span><span class="sxs-lookup"><span data-stu-id="0dee8-178">Use a PUT request to change the media resource of an existing entity.</span></span>

- <span data-ttu-id="0dee8-179">Una solicitud POST no se puede utilizar para crear una entrada de vínculo multimedia.</span><span class="sxs-lookup"><span data-stu-id="0dee8-179">A POST request cannot be used to create a new media link entry.</span></span> <span data-ttu-id="0dee8-180">En su lugar, debe emitir una solicitud POST para crear un nuevo recurso multimedia y el servicio de datos creará una entrada de vínculo multimedia con los valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="0dee8-180">Instead, you must issue a POST request to create a new media resource, and the data service creates a new media link entry with default values.</span></span> <span data-ttu-id="0dee8-181">Una solicitud MERGE o PUT posterior puede actualizar esta nueva entidad.</span><span class="sxs-lookup"><span data-stu-id="0dee8-181">This new entity can be updated by a subsequent MERGE or PUT request.</span></span> <span data-ttu-id="0dee8-182">También puede considerar la opción de almacenar en memoria caché la entidad y realizar actualizaciones en el contenedor de elementos eliminados, como establecer el valor de propiedad en el valor del encabezado Slug en la solicitud POST.</span><span class="sxs-lookup"><span data-stu-id="0dee8-182">You may also consider caching the entity and make updates in the disposer, such as setting the property value to the value of the Slug header in the POST request.</span></span>

- <span data-ttu-id="0dee8-183">Cuando se recibe una solicitud POST, el servicio de datos llama a <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> para crear el recurso multimedia antes de llamar a <xref:System.Data.Services.IUpdatable.SaveChanges%2A> para crear la entrada de vínculo multimedia.</span><span class="sxs-lookup"><span data-stu-id="0dee8-183">When a POST request is received, the data service calls <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> to create the media resource before it calls <xref:System.Data.Services.IUpdatable.SaveChanges%2A> to create the media link entry.</span></span>

- <span data-ttu-id="0dee8-184">Una implementación de <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> no debe devolver un objeto <xref:System.IO.MemoryStream>.</span><span class="sxs-lookup"><span data-stu-id="0dee8-184">An implementation of <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> should not return a <xref:System.IO.MemoryStream> object.</span></span> <span data-ttu-id="0dee8-185">Cuando se utiliza este tipo de flujo, se producirán problemas de recursos de memoria cuando el servicio reciba flujos de datos muy grandes.</span><span class="sxs-lookup"><span data-stu-id="0dee8-185">When you use this kind of stream, memory resource issues will occur when the service receives very large data streams.</span></span>

- <span data-ttu-id="0dee8-186">A continuación se enumeran algunas de las consideraciones que debe tener en cuenta al almacenar recursos multimedia en una base de datos:</span><span class="sxs-lookup"><span data-stu-id="0dee8-186">The following are things to consider when storing media resources in a database:</span></span>

  - <span data-ttu-id="0dee8-187">En el modelo de datos no debe incluirse una propiedad binaria que sea un recurso multimedia.</span><span class="sxs-lookup"><span data-stu-id="0dee8-187">A binary property that is a media resource should not be included in the data model.</span></span> <span data-ttu-id="0dee8-188">Todas las propiedades expuestas en un modelo de datos se devuelven en la entrada de una fuente de respuesta.</span><span class="sxs-lookup"><span data-stu-id="0dee8-188">All properties exposed in a data model are returned in the entry in a response feed.</span></span>

  - <span data-ttu-id="0dee8-189">Para mejorar el rendimiento con un flujo binario grande, recomendamos crear una clase de flujo personalizado para almacenar datos binarios en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-189">To improve performance with a large binary stream, we recommend that you create a custom stream class to store binary data in the database.</span></span> <span data-ttu-id="0dee8-190">La implementación de <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> devuelve esta clase y envía los datos binarios a la base de datos en fragmentos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-190">This class is returned by your <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> implementation and sends the binary data to the database in chunks.</span></span> <span data-ttu-id="0dee8-191">Para una base de datos de SQL Server, se recomienda usar un objeto FILESTREAM para transmitir datos en la base de datos cuando los datos binarios están mayores que 1MB.</span><span class="sxs-lookup"><span data-stu-id="0dee8-191">For a SQL Server database, we recommend that you use a FILESTREAM to stream data into the database when the binary data is larger than 1MB.</span></span>

  - <span data-ttu-id="0dee8-192">Asegúrese de que la base de datos esté diseñada para almacenar los flujos binarios grandes que vaya a recibir el servicio de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-192">Ensure that your database is designed to store the binary large streams that are to be received by your data service.</span></span>

  - <span data-ttu-id="0dee8-193">Cuando un cliente envía a una solicitud POST para insertar una entrada de vínculo multimedia con un recurso multimedia en una solicitud única, se llama a <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> para obtener el flujo antes de que el servicio de datos inserte la nueva entidad en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-193">When a client sends a POST request to insert a media link entry with a media resource in a single request, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> is called to obtain the stream before the data service inserts the new entity into the database.</span></span> <span data-ttu-id="0dee8-194">Una implementación del proveedor de transmisiones por secuencias debe ser capaz de controlar este comportamiento del servicio de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-194">A streaming provider implementation must be able to handle this data service behavior.</span></span> <span data-ttu-id="0dee8-195">Considere la opción de usar una tabla de datos independiente para almacenar los datos binarios o almacenar el flujo de datos en un archivo hasta que la entidad se haya insertado en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0dee8-195">Consider using a separate data table to store the binary data or store the data stream in a file until after the entity has been inserted into the database.</span></span>

- <span data-ttu-id="0dee8-196">Cuando implemente los métodos <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A> o <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>, debe utilizar el objeto eTag y los valores Content-Type y que se proporcionan como parámetros de método.</span><span class="sxs-lookup"><span data-stu-id="0dee8-196">When you implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>, or <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> methods, you must use the eTag and Content-Type values that are supplied as method parameters.</span></span> <span data-ttu-id="0dee8-197">No establezca el objeto eTag ni los encabezados Content-Type en la implementación del proveedor <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="0dee8-197">Do not set eTag or Content-Type headers in your <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider implementation.</span></span>

- <span data-ttu-id="0dee8-198">De forma predeterminada, el cliente envía secuencias binarias grandes mediante codificación de transferencia HTTP fragmentada.</span><span class="sxs-lookup"><span data-stu-id="0dee8-198">By default, the client sends large binary streams by using a chunked HTTP Transfer-Encoding.</span></span> <span data-ttu-id="0dee8-199">Dado que el [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server no admite este tipo de codificación, no se puede usar este servidor Web para hospedar un servicio de datos de transmisión por secuencias que debe aceptar secuencias binarias grandes.</span><span class="sxs-lookup"><span data-stu-id="0dee8-199">Because the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server does not support this kind of encoding, you cannot use this Web server to host a streaming data service that must accept large binary streams.</span></span> <span data-ttu-id="0dee8-200">Para obtener más información sobre [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] servidor de desarrollo, consulte [servidores Web en Visual Studio para proyectos Web de ASP.NET](https://docs.microsoft.com/previous-versions/aspnet/58wxa9w5(v=vs.120)).</span><span class="sxs-lookup"><span data-stu-id="0dee8-200">For more information on [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server, see [Web Servers in Visual Studio for ASP.NET Web Projects](https://docs.microsoft.com/previous-versions/aspnet/58wxa9w5(v=vs.120)).</span></span>

<a name="versioning"></a>

## <a name="versioning-requirements"></a><span data-ttu-id="0dee8-201">Requisitos de control de versiones</span><span class="sxs-lookup"><span data-stu-id="0dee8-201">Versioning Requirements</span></span>

<span data-ttu-id="0dee8-202">El proveedor de transmisión por secuencias tiene los siguientes requisitos de control de versiones de [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="0dee8-202">The streaming provider has the following [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol versioning requirements:</span></span>

- <span data-ttu-id="0dee8-203">El proveedor de transmisión por secuencias requiere que el servicio de datos admita la versión 2.0 del protocolo de [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="0dee8-203">The streaming provider requires that the data service support version 2.0 of the [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol and later versions.</span></span>

<span data-ttu-id="0dee8-204">Para obtener más información, consulte [versiones del servicio de datos](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="0dee8-204">For more information, see [Data Service Versioning](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="0dee8-205">Vea también</span><span class="sxs-lookup"><span data-stu-id="0dee8-205">See also</span></span>

- [<span data-ttu-id="0dee8-206">Proveedores de Data Services</span><span class="sxs-lookup"><span data-stu-id="0dee8-206">Data Services Providers</span></span>](../../../../docs/framework/data/wcf/data-services-providers-wcf-data-services.md)
- [<span data-ttu-id="0dee8-207">Proveedores de servicios de datos personalizados</span><span class="sxs-lookup"><span data-stu-id="0dee8-207">Custom Data Service Providers</span></span>](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md)
- [<span data-ttu-id="0dee8-208">Trabajo con datos binarios</span><span class="sxs-lookup"><span data-stu-id="0dee8-208">Working with Binary Data</span></span>](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md)
