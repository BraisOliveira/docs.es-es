---
title: 'Simultaneidad optimista: Información general'
ms.date: 03/30/2017
ms.assetid: c2e38512-d0c8-4807-b30a-cb7e30338694
ms.openlocfilehash: a61d4c5b35f3797539fe845045b8a959b0351350
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/22/2019
ms.locfileid: "69938627"
---
# <a name="optimistic-concurrency-overview"></a><span data-ttu-id="1315c-102">Simultaneidad optimista: Información general</span><span class="sxs-lookup"><span data-stu-id="1315c-102">Optimistic Concurrency: Overview</span></span>
[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="1315c-103">admite el control de simultaneidad optimista.</span><span class="sxs-lookup"><span data-stu-id="1315c-103">supports optimistic concurrency control.</span></span> <span data-ttu-id="1315c-104">En la tabla siguiente se describen los términos que se aplican [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] a la simultaneidad optimista en la documentación de:</span><span class="sxs-lookup"><span data-stu-id="1315c-104">The following table describes terms that apply to optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] documentation:</span></span>  
  
|<span data-ttu-id="1315c-105">Términos</span><span class="sxs-lookup"><span data-stu-id="1315c-105">Terms</span></span>|<span data-ttu-id="1315c-106">DESCRIPCIÓN</span><span class="sxs-lookup"><span data-stu-id="1315c-106">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="1315c-107">concurrency</span><span class="sxs-lookup"><span data-stu-id="1315c-107">concurrency</span></span>|<span data-ttu-id="1315c-108">Situación en la que dos o más usuarios intentan actualizar la misma fila de la base de datos al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="1315c-108">The situation in which two or more users at the same time try to update the same database row.</span></span>|  
|<span data-ttu-id="1315c-109">Conflicto de simultaneidad</span><span class="sxs-lookup"><span data-stu-id="1315c-109">concurrency conflict</span></span>|<span data-ttu-id="1315c-110">Situación en la cual dos o más usuarios intentan enviar valores incompatibles a una o más columnas de una fila al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="1315c-110">The situation in which two or more users at the same time try to submit conflicting values to one or more columns of a row.</span></span>|  
|<span data-ttu-id="1315c-111">control de simultaneidad</span><span class="sxs-lookup"><span data-stu-id="1315c-111">concurrency control</span></span>|<span data-ttu-id="1315c-112">Técnica utilizada para resolver los conflictos de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="1315c-112">The technique used to resolve concurrency conflicts.</span></span>|  
|<span data-ttu-id="1315c-113">control de simultaneidad optimista</span><span class="sxs-lookup"><span data-stu-id="1315c-113">optimistic concurrency control</span></span>|<span data-ttu-id="1315c-114">Técnica que primero investiga si otras transacciones han cambiado los valores de una fila antes de permitir que se envíen los cambios.</span><span class="sxs-lookup"><span data-stu-id="1315c-114">The technique that first investigates whether other transactions have changed values in a row before permitting changes to be submitted.</span></span><br /><br /> <span data-ttu-id="1315c-115">Contraste con el *control de simultaneidad pesimista*, que bloquea el registro para evitar conflictos de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="1315c-115">Contrast with *pessimistic concurrency control*, which locks the record to avoid concurrency conflicts.</span></span><br /><br /> <span data-ttu-id="1315c-116">El control *optimista* se denomina de este modo porque tiene en cuenta las posibilidades de que una transacción interfiera con otra no sea probable.</span><span class="sxs-lookup"><span data-stu-id="1315c-116">*Optimistic* control is so termed because it considers the chances of one transaction interfering with another to be unlikely.</span></span>|  
|<span data-ttu-id="1315c-117">Resolución de conflictos</span><span class="sxs-lookup"><span data-stu-id="1315c-117">conflict resolution</span></span>|<span data-ttu-id="1315c-118">Proceso mediante el cual un elemento en conflicto se actualiza volviendo a consultar la base de datos y resolviendo las diferencias.</span><span class="sxs-lookup"><span data-stu-id="1315c-118">The process of refreshing a conflicting item by querying the database again and then reconciling differences.</span></span><br /><br /> <span data-ttu-id="1315c-119">Cuando un objeto se actualiza, el seguimiento de cambios de [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] conserva los datos siguientes:</span><span class="sxs-lookup"><span data-stu-id="1315c-119">When an object is refreshed, the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] change tracker holds the following data:</span></span><br /><br /> <span data-ttu-id="1315c-120">: Los valores tomados originalmente de la base de datos y se usan para la comprobación de actualización.</span><span class="sxs-lookup"><span data-stu-id="1315c-120">-   The values originally taken from the database and used for the update check.</span></span><br /><span data-ttu-id="1315c-121">-Los nuevos valores de la base de datos de la consulta posterior.</span><span class="sxs-lookup"><span data-stu-id="1315c-121">-   The new database values from the subsequent query.</span></span><br /><br /> <span data-ttu-id="1315c-122">Después, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] determina si el objeto está en conflicto (es decir, si uno o más de sus valores de miembro ha cambiado).</span><span class="sxs-lookup"><span data-stu-id="1315c-122">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] then determines whether the object is in conflict (that is, whether one or more of its member values has changed).</span></span> <span data-ttu-id="1315c-123">Si el objeto está en conflicto, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] Next determina cuál de sus miembros está en conflicto.</span><span class="sxs-lookup"><span data-stu-id="1315c-123">If the object is in conflict, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] next determines which of its members are in conflict.</span></span><br /><br /> <span data-ttu-id="1315c-124">Cualquier conflicto de miembro que [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] detecta se agrega a una lista de conflictos.</span><span class="sxs-lookup"><span data-stu-id="1315c-124">Any member conflict that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] discovers is added to a conflict list.</span></span>|  
  
 <span data-ttu-id="1315c-125">En el [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] modelo de objetos de, se produce un *conflicto de simultaneidad optimista* cuando se cumplen las dos condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="1315c-125">In the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] object model, an *optimistic concurrency conflict* occurs when both of the following conditions are true:</span></span>  
  
- <span data-ttu-id="1315c-126">El cliente intenta enviar cambios a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="1315c-126">The client tries to submit changes to the database.</span></span>  
  
- <span data-ttu-id="1315c-127">Uno o más valores de comprobación de actualizaciones se han actualizado en la base de datos desde la última vez que el cliente los leyó.</span><span class="sxs-lookup"><span data-stu-id="1315c-127">One or more update-check values have been updated in the database since the client last read them.</span></span>  
  
 <span data-ttu-id="1315c-128">Para resolver el conflicto, primero se detectan los miembros del objeto que están en conflicto y, después, se decide qué hacer.</span><span class="sxs-lookup"><span data-stu-id="1315c-128">Resolution of this conflict includes discovering which members of the object are in conflict, and then deciding what you want to do about it.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1315c-129">Solo los miembros asignados como <xref:System.Data.Linq.Mapping.UpdateCheck.Always> o <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participan en las comprobaciones de simultaneidad optimista.</span><span class="sxs-lookup"><span data-stu-id="1315c-129">Only members mapped as <xref:System.Data.Linq.Mapping.UpdateCheck.Always> or <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participate in optimistic concurrency checks.</span></span> <span data-ttu-id="1315c-130">No se realiza ninguna comprobación para los miembros marcados como <xref:System.Data.Linq.Mapping.UpdateCheck.Never>.</span><span class="sxs-lookup"><span data-stu-id="1315c-130">No check is performed for members marked <xref:System.Data.Linq.Mapping.UpdateCheck.Never>.</span></span> <span data-ttu-id="1315c-131">Para obtener más información, consulta <xref:System.Data.Linq.Mapping.UpdateCheck>.</span><span class="sxs-lookup"><span data-stu-id="1315c-131">For more information, see <xref:System.Data.Linq.Mapping.UpdateCheck>.</span></span>  
  
## <a name="example"></a><span data-ttu-id="1315c-132">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="1315c-132">Example</span></span>  
 <span data-ttu-id="1315c-133">Por ejemplo, en el escenario siguiente, User1 empieza a preparar una actualización consultando una fila en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="1315c-133">For example, in the following scenario, User1 starts to prepare an update by querying the database for a row.</span></span> <span data-ttu-id="1315c-134">User1 recibe una fila con los valores Alfreds, Maria y Sales.</span><span class="sxs-lookup"><span data-stu-id="1315c-134">User1 receives a row with values of Alfreds, Maria, and Sales.</span></span>  
  
 <span data-ttu-id="1315c-135">User1 desea cambiar el valor de la columna Manager a Alfred y el valor de la columna Department a Marketing.</span><span class="sxs-lookup"><span data-stu-id="1315c-135">User1 wants to change the value of the Manager column to Alfred and the value of the Department column to Marketing.</span></span> <span data-ttu-id="1315c-136">Antes de que User1 pudiera enviar los cambios, User2 ha enviado cambios a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="1315c-136">Before User1 can submit those changes, User2 has submitted changes to the database.</span></span> <span data-ttu-id="1315c-137">Por lo tanto, ahora el valor de la columna Assistant ha cambiado a Mary y el valor de la columna Department a Service.</span><span class="sxs-lookup"><span data-stu-id="1315c-137">So now the value of the Assistant column has been changed to Mary and the value of the Department column to Service.</span></span>  
  
 <span data-ttu-id="1315c-138">Cuando User1 intenta enviar los cambios, se produce un error en el envío y se inicia una excepción <xref:System.Data.Linq.ChangeConflictException>.</span><span class="sxs-lookup"><span data-stu-id="1315c-138">When User1 now tries to submit changes, the submission fails and a <xref:System.Data.Linq.ChangeConflictException> exception is thrown.</span></span> <span data-ttu-id="1315c-139">Esto es consecuencia de que los valores de base de datos para la columna Assistant y la columna Department no son los esperados.</span><span class="sxs-lookup"><span data-stu-id="1315c-139">This result occurs because the database values for the Assistant column and the Department column are not those that were expected.</span></span> <span data-ttu-id="1315c-140">Los miembros que representan las columnas Assistant y Department están en conflicto.</span><span class="sxs-lookup"><span data-stu-id="1315c-140">Members representing the Assistant and Department columns are in conflict.</span></span> <span data-ttu-id="1315c-141">En la tabla siguiente se resume la situación.</span><span class="sxs-lookup"><span data-stu-id="1315c-141">The following table summarizes the situation.</span></span>  
  
||<span data-ttu-id="1315c-142">Administrador</span><span class="sxs-lookup"><span data-stu-id="1315c-142">Manager</span></span>|<span data-ttu-id="1315c-143">Asistente</span><span class="sxs-lookup"><span data-stu-id="1315c-143">Assistant</span></span>|<span data-ttu-id="1315c-144">department</span><span class="sxs-lookup"><span data-stu-id="1315c-144">Department</span></span>|  
|------|-------------|---------------|----------------|  
|<span data-ttu-id="1315c-145">Estado original</span><span class="sxs-lookup"><span data-stu-id="1315c-145">Original state</span></span>|<span data-ttu-id="1315c-146">Alfreds</span><span class="sxs-lookup"><span data-stu-id="1315c-146">Alfreds</span></span>|<span data-ttu-id="1315c-147">Maria</span><span class="sxs-lookup"><span data-stu-id="1315c-147">Maria</span></span>|<span data-ttu-id="1315c-148">Ventas</span><span class="sxs-lookup"><span data-stu-id="1315c-148">Sales</span></span>|  
|<span data-ttu-id="1315c-149">User1</span><span class="sxs-lookup"><span data-stu-id="1315c-149">User1</span></span>|<span data-ttu-id="1315c-150">Alfred</span><span class="sxs-lookup"><span data-stu-id="1315c-150">Alfred</span></span>||<span data-ttu-id="1315c-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="1315c-151">Marketing</span></span>|  
|<span data-ttu-id="1315c-152">User2</span><span class="sxs-lookup"><span data-stu-id="1315c-152">User2</span></span>||<span data-ttu-id="1315c-153">Mary</span><span class="sxs-lookup"><span data-stu-id="1315c-153">Mary</span></span>|<span data-ttu-id="1315c-154">Servicio</span><span class="sxs-lookup"><span data-stu-id="1315c-154">Service</span></span>|  
  
 <span data-ttu-id="1315c-155">Puede resolver conflictos como estos de maneras diferentes.</span><span class="sxs-lookup"><span data-stu-id="1315c-155">You can resolve conflicts such as this in different ways.</span></span> <span data-ttu-id="1315c-156">Para obtener más información, consulte [Cómo Administrar conflictos](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)de cambios.</span><span class="sxs-lookup"><span data-stu-id="1315c-156">For more information, see [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).</span></span>  
  
## <a name="conflict-detection-and-resolution-checklist"></a><span data-ttu-id="1315c-157">Lista de comprobación para detectar y resolver conflictos</span><span class="sxs-lookup"><span data-stu-id="1315c-157">Conflict Detection and Resolution Checklist</span></span>  
 <span data-ttu-id="1315c-158">Puede detectar y resolver los conflictos en cualquier nivel de detalle.</span><span class="sxs-lookup"><span data-stu-id="1315c-158">You can detect and resolve conflicts at any level of detail.</span></span> <span data-ttu-id="1315c-159">Por una parte, puede resolver todos los conflictos de una de tres maneras (vea <xref:System.Data.Linq.RefreshMode>) sin consideraciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="1315c-159">At one extreme, you can resolve all conflicts in one of three ways (see <xref:System.Data.Linq.RefreshMode>) without additional consideration.</span></span> <span data-ttu-id="1315c-160">En el otro extremo, puede designar una acción concreta para cada tipo de conflicto en cada miembro en conflicto.</span><span class="sxs-lookup"><span data-stu-id="1315c-160">At the other extreme, you can designate a specific action for each type of conflict on every member in conflict.</span></span>  
  
- <span data-ttu-id="1315c-161">Especifique o revise las opciones de <xref:System.Data.Linq.Mapping.UpdateCheck> en su modelo de objetos.</span><span class="sxs-lookup"><span data-stu-id="1315c-161">Specify or revise <xref:System.Data.Linq.Mapping.UpdateCheck> options in your object model.</span></span>  
  
     <span data-ttu-id="1315c-162">Para obtener más información, consulte [Cómo Especifique los miembros que se van a probar para](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md)detectar conflictos de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="1315c-162">For more information, see [How to: Specify Which Members are Tested for Concurrency Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md).</span></span>  
  
- <span data-ttu-id="1315c-163">En el bloque la try/catch de la llamada a <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, especifique en qué punto desea que se inicien excepciones.</span><span class="sxs-lookup"><span data-stu-id="1315c-163">In the try/catch block of your call to <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, specify at what point you want exceptions to be thrown.</span></span>  
  
     <span data-ttu-id="1315c-164">Para obtener más información, consulte [Cómo Especifique cuándo se inician](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md)las excepciones de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="1315c-164">For more information, see [How to: Specify When Concurrency Exceptions are Thrown](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md).</span></span>  
  
- <span data-ttu-id="1315c-165">Determine cuántos detalles del conflicto desea recuperar e incluya el código correspondiente en el bloque try/catch.</span><span class="sxs-lookup"><span data-stu-id="1315c-165">Determine how much conflict detail you want to retrieve, and include code in your try/catch block accordingly.</span></span>  
  
     <span data-ttu-id="1315c-166">Para obtener más información, vea [Cómo: Recuperar información](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) de conflictos de [entidades y cómo: Recuperar información](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md)de conflictos de miembros.</span><span class="sxs-lookup"><span data-stu-id="1315c-166">For more information, see [How to: Retrieve Entity Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) and [How to: Retrieve Member Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md).</span></span>  
  
- <span data-ttu-id="1315c-167">Incluya en el `try` /códigocómodesea resolverlosdistintosconflictosquedetecta`catch` .</span><span class="sxs-lookup"><span data-stu-id="1315c-167">Include in your `try`/`catch` code how you want to resolve the various conflicts you discover.</span></span>  
  
     <span data-ttu-id="1315c-168">Para obtener más información, vea [Cómo: Resolver conflictos conservando los valores](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md)de la base de datos, [cómo: Solucione los conflictos sobrescribiendo los](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md)valores de [la base de datos y cómo: Resuelva los conflictos combinando con los](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md)valores de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="1315c-168">For more information, see [How to: Resolve Conflicts by Retaining Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md), [How to: Resolve Conflicts by Overwriting Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md), and [How to: Resolve Conflicts by Merging with Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md).</span></span>  
  
## <a name="linq-to-sql-types-that-support-conflict-discovery-and-resolution"></a><span data-ttu-id="1315c-169">Tipos LINQ to SQL que admiten la detección y resolución de conflictos</span><span class="sxs-lookup"><span data-stu-id="1315c-169">LINQ to SQL Types That Support Conflict Discovery and Resolution</span></span>  
 <span data-ttu-id="1315c-170">Entre las clases y características que admiten la resolución de conflictos de simultaneidad optimista en [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)], se incluyen:</span><span class="sxs-lookup"><span data-stu-id="1315c-170">Classes and features to support the resolution of conflicts in optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] include the following:</span></span>  
  
- <xref:System.Data.Linq.ObjectChangeConflict?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.MemberChangeConflict?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.ChangeConflictCollection?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.ChangeConflictException?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.DataContext.ChangeConflicts%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.DataContext.SubmitChanges%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.DataContext.Refresh%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.Mapping.ColumnAttribute.UpdateCheck%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.Mapping.UpdateCheck?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.RefreshMode?displayProperty=nameWithType>  
  
## <a name="see-also"></a><span data-ttu-id="1315c-171">Vea también</span><span class="sxs-lookup"><span data-stu-id="1315c-171">See also</span></span>

- [<span data-ttu-id="1315c-172">Procedimientos: Administrar conflictos de cambios</span><span class="sxs-lookup"><span data-stu-id="1315c-172">How to: Manage Change Conflicts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)
