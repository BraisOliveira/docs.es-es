---
title: Instancias de usuario de SQL Server Express
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 00c12376-cb26-4317-86ad-e6e9c089be57
ms.openlocfilehash: f76b1f0a09be2f745156437919f43ebaa8840519
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/22/2019
ms.locfileid: "69938480"
---
# <a name="sql-server-express-user-instances"></a><span data-ttu-id="4b809-102">Instancias de usuario de SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="4b809-102">SQL Server Express User Instances</span></span>
<span data-ttu-id="4b809-103">Microsoft SQL Server Express Edition (SQL Server Express) incorpora una nueva característica de instancia de usuario, que solo está disponible cuando se usa el proveedor de datos .NET Framework para SQL Server (`SqlClient`).</span><span class="sxs-lookup"><span data-stu-id="4b809-103">Microsoft SQL Server Express Edition (SQL Server Express) supports the user instance feature, which is only available when using the .NET Framework Data Provider for SQL Server (`SqlClient`).</span></span> <span data-ttu-id="4b809-104">Una instancia de usuario es una instancia independiente del motor de base de datos de SQL Server Express que se genera mediante una instancia primaria.</span><span class="sxs-lookup"><span data-stu-id="4b809-104">A user instance is a separate instance of the SQL Server Express Database Engine that is generated by a parent instance.</span></span> <span data-ttu-id="4b809-105">Las instancias de usuario permiten a los usuarios que no son administradores en sus equipos locales adjuntar y conectarse a bases de datos de SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="4b809-105">User instances allow users who are not administrators on their local computers to attach and connect to SQL Server Express databases.</span></span> <span data-ttu-id="4b809-106">Cada instancia se ejecuta en el contexto de seguridad del usuario individual, ya que solo se puede ejecutar una instancia por usuario.</span><span class="sxs-lookup"><span data-stu-id="4b809-106">Each instance runs under the security context of the individual user, on a one-instance-per-user basis.</span></span>  
  
## <a name="user-instance-capabilities"></a><span data-ttu-id="4b809-107">Funcionalidades de las instancias de usuario</span><span class="sxs-lookup"><span data-stu-id="4b809-107">User Instance Capabilities</span></span>  
 <span data-ttu-id="4b809-108">Las instancias de usuario resultan muy útiles para los usuarios que ejecutan Windows desde una cuenta de usuario con privilegios mínimos, ya que cada usuario tiene privilegios de administrador del sistema (`sysadmin`) de SQL Server para la instancia que se ejecuta en su equipo sin necesidad de ser también administrador de Windows.</span><span class="sxs-lookup"><span data-stu-id="4b809-108">User instances are useful for users who are running Windows under a least-privilege user account (LUA) because each user has SQL Server system administrator (`sysadmin`) privileges over the instance running on her computer without needing to run as a Windows administrator as well.</span></span> <span data-ttu-id="4b809-109">El software que se ejecuta en una instancia de usuario con permisos limitados no puede realizar cambios en todo el sistema, puesto que la instancia de SQL Server Express se ejecuta en la cuenta del usuario de Windows que no es administrador, no como un servicio.</span><span class="sxs-lookup"><span data-stu-id="4b809-109">Software executing on a user instance with limited permissions cannot make system-wide changes because the instance of SQL Server Express is running under the non-administrator Windows account of the user, not as a service.</span></span> <span data-ttu-id="4b809-110">Cada instancia de usuario se aísla de su instancia principal y de cualquier otra instancia de usuario que se ejecute en el mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="4b809-110">Each user instance is isolated from its parent instance and from any other user instances running on the same computer.</span></span> <span data-ttu-id="4b809-111">Las bases de datos que se ejecutan en una instancia de usuario se abren solo en modo usuario único y no es posible que varios usuarios se conecten a las bases de datos que se ejecutan en una instancia de usuario.</span><span class="sxs-lookup"><span data-stu-id="4b809-111">Databases running on a user instance are opened in single-user mode only, and it is not possible for multiple users to connect to databases running on a user instance.</span></span> <span data-ttu-id="4b809-112">La replicación y las consultas distribuidas también están deshabilitadas para las instancias de usuario.</span><span class="sxs-lookup"><span data-stu-id="4b809-112">Replication and distributed queries are also disabled for user instances.</span></span>  
  
 <span data-ttu-id="4b809-113">Para obtener más información, vea "Instancias de usuario" en los Libros en línea de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4b809-113">For more information, see "User Instances" in SQL Server Books Online.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4b809-114">Las instancias de usuario no son necesarias para los usuarios que ya son administradores en sus propios equipos o en casos en los que están implicados varios usuarios de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="4b809-114">User instances are not needed for users who are already administrators on their own computers, or for scenarios involving multiple database users.</span></span>  
  
## <a name="enabling-user-instances"></a><span data-ttu-id="4b809-115">Habilitar instancias de usuario</span><span class="sxs-lookup"><span data-stu-id="4b809-115">Enabling User Instances</span></span>  
 <span data-ttu-id="4b809-116">Para generar instancias de usuario, debe estar ejecutándose una instancia primaria de SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="4b809-116">To generate user instances, a parent instance of SQL Server Express must be running.</span></span> <span data-ttu-id="4b809-117">Las instancias de usuario están habilitadas de forma predeterminada cuando se instala SQL Server Express y se pueden habilitar o deshabilitar explícitamente un administrador del sistema ejecutando el procedimiento almacenado del sistema **sp_configure** en la instancia primaria.</span><span class="sxs-lookup"><span data-stu-id="4b809-117">User instances are enabled by default when SQL Server Express is installed, and they can be explicitly enabled or disabled by a system administrator executing the **sp_configure** system stored procedure on the parent instance.</span></span>  
  
```  
-- Enable user instances.  
sp_configure 'user instances enabled','1'   
  
-- Disable user instances.  
sp_configure 'user instances enabled','0'  
```  
  
 <span data-ttu-id="4b809-118">El protocolo de red para las instancias de usuario debe ser el de Canalizaciones con nombre locales.</span><span class="sxs-lookup"><span data-stu-id="4b809-118">The network protocol for user instances must be local Named Pipes.</span></span> <span data-ttu-id="4b809-119">No se puede iniciar una instancia de usuario en una instancia remota de SQL Server y los inicios de sesión de SQL Server no están permitidos.</span><span class="sxs-lookup"><span data-stu-id="4b809-119">A user instance cannot be started on a remote instance of SQL Server, and SQL Server logins are not allowed.</span></span>  
  
## <a name="connecting-to-a-user-instance"></a><span data-ttu-id="4b809-120">Conectarse a una instancia de usuario</span><span class="sxs-lookup"><span data-stu-id="4b809-120">Connecting to a User Instance</span></span>  
 <span data-ttu-id="4b809-121">Las `User Instance` palabras `AttachDBFilename` clave y <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> permiten <xref:System.Data.SqlClient.SqlConnection> que un se conecte a una instancia de usuario.</span><span class="sxs-lookup"><span data-stu-id="4b809-121">The `User Instance` and `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> keywords allow a <xref:System.Data.SqlClient.SqlConnection> to connect to a user instance.</span></span> <span data-ttu-id="4b809-122">Las instancias de usuario también funcionan con las propiedades <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` y `AttachDBFilename`.</span><span class="sxs-lookup"><span data-stu-id="4b809-122">User instances are also supported by the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` and `AttachDBFilename` properties.</span></span>  
  
 <span data-ttu-id="4b809-123">Tenga en cuenta lo siguiente sobre la cadena de conexión de ejemplo que se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="4b809-123">Note the following about the sample connection string shown below:</span></span>  
  
- <span data-ttu-id="4b809-124">La palabra clave `Data Source` hace referencia a la instancia primaria de SQL Server Express que está generando la instancia de usuario.</span><span class="sxs-lookup"><span data-stu-id="4b809-124">The `Data Source` keyword refers to the parent instance of SQL Server Express that is generating the user instance.</span></span> <span data-ttu-id="4b809-125">La instancia predeterminada es .\sqlexpress.</span><span class="sxs-lookup"><span data-stu-id="4b809-125">The default instance is .\sqlexpress.</span></span>  
  
- <span data-ttu-id="4b809-126">El valor de `Integrated Security` está establecido en `true`.</span><span class="sxs-lookup"><span data-stu-id="4b809-126">`Integrated Security` is set to `true`.</span></span> <span data-ttu-id="4b809-127">Para conectarse a una instancia de usuario, se requiere la autenticación de Windows; los inicios de sesión de SQL no están permitidos.</span><span class="sxs-lookup"><span data-stu-id="4b809-127">To connect to a user instance, Windows Authentication is required; SQL Server logins are not supported.</span></span>  
  
- <span data-ttu-id="4b809-128">La `User Instance` está establecida en `true`, por lo que invoca una instancia de usuario.</span><span class="sxs-lookup"><span data-stu-id="4b809-128">The `User Instance` is set to `true`, which invokes a user instance.</span></span> <span data-ttu-id="4b809-129">(El valor predeterminado es `false`.)</span><span class="sxs-lookup"><span data-stu-id="4b809-129">(The default is `false`.)</span></span>  
  
- <span data-ttu-id="4b809-130">La palabra clave de cadena de conexión `AttachDbFileName` se utiliza para adjuntar el archivo de base de datos primario (.mdf), que debe incluir el nombre de ruta de acceso completo.</span><span class="sxs-lookup"><span data-stu-id="4b809-130">The `AttachDbFileName` connection string keyword is used to attach the primary database file (.mdf), which must include the full path name.</span></span> <span data-ttu-id="4b809-131">`AttachDbFileName` se corresponde también con las claves "extended properties" e "initial file name" dentro de una cadena de conexión <xref:System.Data.SqlClient.SqlConnection>.</span><span class="sxs-lookup"><span data-stu-id="4b809-131">`AttachDbFileName` also corresponds to the "extended properties" and "initial file name" keys within a <xref:System.Data.SqlClient.SqlConnection> connection string.</span></span>  
  
- <span data-ttu-id="4b809-132">La cadena de sustitución `|DataDirectory|`, que va entre barras verticales, hace referencia al directorio de datos de la aplicación que abre la conexión y proporciona una ruta de acceso relativa que muestra la ubicación de los archivos de la base de datos y de registro .mdf y .ldf.</span><span class="sxs-lookup"><span data-stu-id="4b809-132">The `|DataDirectory|` substitution string enclosed in the pipe symbols refers to the data directory of the application opening the connection and provides a relative path indicating the location of the .mdf and .ldf database and log files.</span></span> <span data-ttu-id="4b809-133">Si quiere ubicar estos archivos en cualquier otro lugar, debe indicar la ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="4b809-133">If you want to locate these files elsewhere, you must provide the full path to the files.</span></span>  
  
```  
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;AttachDBFilename=|DataDirectory|\InstanceDB.mdf;  
Initial Catalog=InstanceDB;  
```  
  
> [!NOTE]
> <span data-ttu-id="4b809-134">También puede usar las propiedades <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> y <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> para compilar una cadena de conexión en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="4b809-134">You can also use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> and <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> properties to build a connection string at run time.</span></span>  
  
### <a name="using-the-124datadirectory124-substitution-string"></a><span data-ttu-id="4b809-135">Usar la &#124;cadena de&#124; sustitución DataDirectory</span><span class="sxs-lookup"><span data-stu-id="4b809-135">Using the &#124;DataDirectory&#124; Substitution String</span></span>  
 <span data-ttu-id="4b809-136">`AttachDbFileName` se amplió en ADO.NET 2.0 con la incorporación de la cadena de sustitución `|DataDirectory|` (entre barras verticales).</span><span class="sxs-lookup"><span data-stu-id="4b809-136">`AttachDbFileName` was extended in ADO.NET 2.0 with the introduction of the `|DataDirectory|` (enclosed in pipe symbols) substitution string.</span></span> <span data-ttu-id="4b809-137">`DataDirectory` se usa junto con `AttachDbFileName` para indicar una ruta de acceso relativa a un archivo de datos, lo que permite a los desarrolladores crear cadenas de conexión basadas en una ruta relativa al origen de datos en lugar de tener que especificar la ruta completa.</span><span class="sxs-lookup"><span data-stu-id="4b809-137">`DataDirectory` is used in conjunction with `AttachDbFileName` to indicate a relative path to a data file, allowing developers to create connection strings that are based on a relative path to the data source instead of being required to specify a full path.</span></span>  
  
 <span data-ttu-id="4b809-138">La ubicación física que indica `DataDirectory` depende del tipo de aplicación.</span><span class="sxs-lookup"><span data-stu-id="4b809-138">The physical location that `DataDirectory` points to depends on the type of application.</span></span> <span data-ttu-id="4b809-139">En este ejemplo, el archivo Northwind.mdf que se va a adjuntar se encuentra en la carpeta \app_data de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4b809-139">In this example, the Northwind.mdf file to be attached is located in the application's \app_data folder.</span></span>  
  
```  
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;  
AttachDBFilename=|DataDirectory|\app_data\Northwind.mdf;  
Initial Catalog=Northwind;  
```  
  
 <span data-ttu-id="4b809-140">Si se usa `DataDirectory`, la ruta del archivo resultante no puede estar más alta en la estructura de directorios que el directorio que señala la cadena de sustitución.</span><span class="sxs-lookup"><span data-stu-id="4b809-140">When `DataDirectory` is used, the resulting file path cannot be higher in the directory structure than the directory pointed to by the substitution string.</span></span> <span data-ttu-id="4b809-141">Por ejemplo, si el `DataDirectory` totalmente expandido es C:\AppDirectory\app_data, la cadena de conexión de ejemplo que se muestra arriba funcionará porque está por debajo de c:\AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="4b809-141">For example, if the fully expanded `DataDirectory` is C:\AppDirectory\app_data, then the sample connection string shown above works because it is below c:\AppDirectory.</span></span> <span data-ttu-id="4b809-142">Sin embargo, si se intenta especificar `DataDirectory` como `|DataDirectory|\..\data`, se producirá un error porque \data no es un subdirectorio de \AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="4b809-142">However, attempting to specify `DataDirectory` as `|DataDirectory|\..\data` will result in an error because \data is not a subdirectory of \AppDirectory.</span></span>  
  
 <span data-ttu-id="4b809-143">Si la cadena de conexión tiene una cadena de sustitución con formato incorrecto, se producirá una <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="4b809-143">If the connection string has an improperly formatted substitution string, an <xref:System.ArgumentException> will be thrown.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4b809-144"><xref:System.Data.SqlClient> resuelve las cadenas de sustitución en rutas de acceso completas del sistema de archivos del equipo local.</span><span class="sxs-lookup"><span data-stu-id="4b809-144"><xref:System.Data.SqlClient> resolves the substitution strings into full paths against the local computer file system.</span></span> <span data-ttu-id="4b809-145">Por eso, no se admiten rutas de acceso a servidores remotos, HTTP ni UNC.</span><span class="sxs-lookup"><span data-stu-id="4b809-145">Therefore, remote server, HTTP, and UNC path names are not supported.</span></span> <span data-ttu-id="4b809-146">Si el servidor no se encuentra en el equipo local, se produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="4b809-146">An exception is thrown when the connection is opened if the server is not located on the local computer.</span></span>  
  
 <span data-ttu-id="4b809-147">Cuando se abre <xref:System.Data.SqlClient.SqlConnection>, se redirige desde la instancia de SQL Server Express predeterminada a una instancia iniciada en tiempo de ejecución que se ejecuta en la cuenta del llamador.</span><span class="sxs-lookup"><span data-stu-id="4b809-147">When the <xref:System.Data.SqlClient.SqlConnection> is opened, it is redirected from the default SQL Server Express instance to a run-time initiated instance running under the caller's account.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4b809-148">Puede ser necesario aumentar el valor de <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> porque las instancias de usuario pueden tardar más en cargar que las instancias normales.</span><span class="sxs-lookup"><span data-stu-id="4b809-148">It may be necessary to increase the <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> value since user instances may take longer to load than regular instances.</span></span>  
  
 <span data-ttu-id="4b809-149">El siguiente fragmento de código abre una nueva `SqlConnection`, muestra la cadena de conexión en la ventana de la consola y después cierra la conexión cuando sale del bloque de código `using`.</span><span class="sxs-lookup"><span data-stu-id="4b809-149">The following code fragment opens a new `SqlConnection`, displays the connection string in the console window, and then closes the connection when exiting the `using` code block.</span></span>  
  
```vb  
Private Sub OpenSqlConnection()  
    ' Retrieve the connection string.  
    Dim connectionString As String = GetConnectionString()  
  
    Using connection As New SqlConnection(connectionString)  
        connection.Open()  
        Console.WriteLine("ConnectionString: {0}", _  
           connection.ConnectionString)  
    End Using  
End Sub  
```  
  
```csharp  
private static void OpenSqlConnection()  
{  
    // Retrieve the connection string.  
    string connectionString = GetConnectionString();  
  
    using (SqlConnection connection =   
        new SqlConnection(connectionString))  
    {  
        connection.Open();  
        Console.WriteLine("ConnectionString: {0}",   
             connection.ConnectionString);  
    }  
}  
```  
  
> [!NOTE]
> <span data-ttu-id="4b809-150">No se admiten las instancias de usuario en código de Common Language Runtime (CLR) cuando se está ejecutando dentro de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4b809-150">User instances are not supported in common language runtime (CLR) code that is running inside of SQL Server.</span></span> <span data-ttu-id="4b809-151">Se producirá una <xref:System.InvalidOperationException> si se llama a `Open` en una conexión <xref:System.Data.SqlClient.SqlConnection> que tiene `User Instance=true` en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="4b809-151">An <xref:System.InvalidOperationException> is thrown if `Open` is called on a <xref:System.Data.SqlClient.SqlConnection> that has `User Instance=true` in the connection string.</span></span>  
  
## <a name="lifetime-of-a-user-instance-connection"></a><span data-ttu-id="4b809-152">Duración de la conexión a una instancia de usuario</span><span class="sxs-lookup"><span data-stu-id="4b809-152">Lifetime of a User Instance Connection</span></span>  
 <span data-ttu-id="4b809-153">A diferencia de las versiones de SQL Server que se ejecutan como un servicio, no es necesario iniciar y detener manualmente las instancias de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4b809-153">Unlike versions of SQL Server that run as a service, SQL Server Express instances do not need to be manually started and stopped.</span></span> <span data-ttu-id="4b809-154">Cada vez que un usuario inicia sesión y se conecta a una instancia de usuario, ésta se inicia si no se está ejecutando ya.</span><span class="sxs-lookup"><span data-stu-id="4b809-154">Each time a user logs in and connects to a user instance, the user instance is started if it is not already running.</span></span> <span data-ttu-id="4b809-155">Las bases de datos de instancias de usuario tienen establecida la opción `AutoClose` para que la base de datos se cierre automáticamente después de un período de inactividad.</span><span class="sxs-lookup"><span data-stu-id="4b809-155">User instance databases have the `AutoClose` option set so that the database is automatically shut down after a period of inactivity.</span></span> <span data-ttu-id="4b809-156">El proceso sqlser.exe que se ha iniciado se mantiene en ejecución durante un período de espera limitado después de que se cierre la última conexión a la instancia, de modo que no es necesario volver a iniciarla si se abre otra conexión antes de que pase el tiempo de espera.</span><span class="sxs-lookup"><span data-stu-id="4b809-156">The sqlservr.exe process that is started is kept running for a limited time-out period after the last connection to the instance is closed, so it does not need to be restarted if another connection is opened before the time-out has expired.</span></span> <span data-ttu-id="4b809-157">La instancia de usuario se cierra automáticamente si no se abre ninguna conexión nueva antes de que haya expirado el período de espera.</span><span class="sxs-lookup"><span data-stu-id="4b809-157">The user instance automatically shuts down if no new connection opens before that time-out period has expired.</span></span> <span data-ttu-id="4b809-158">Un administrador del sistema en la instancia primaria puede establecer la duración del período de tiempo de espera para una instancia de usuario mediante **sp_configure** para cambiar la opción de tiempo de espera de la **instancia de usuario** .</span><span class="sxs-lookup"><span data-stu-id="4b809-158">A system administrator on the parent instance can set the duration of the time-out period for a user instance by using **sp_configure** to change the **user instance timeout** option.</span></span> <span data-ttu-id="4b809-159">El valor predeterminado es de 60 minutos.</span><span class="sxs-lookup"><span data-stu-id="4b809-159">The default is 60 minutes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4b809-160">Si en la cadena de conexión se utiliza `Min Pool Size` con un valor mayor de cero, el concentrador de conexión siempre mantendrá unas cuantas conexiones abiertas y la instancia de usuario no se cerrará automáticamente.</span><span class="sxs-lookup"><span data-stu-id="4b809-160">If `Min Pool Size` is used in the connection string with a value greater than zero, the connection pooler will always maintain a few opened connections, and the user instance will not automatically shut down.</span></span>  
  
## <a name="how-user-instances-work"></a><span data-ttu-id="4b809-161">Cómo funcionan las instancias de usuario</span><span class="sxs-lookup"><span data-stu-id="4b809-161">How User Instances Work</span></span>  
 <span data-ttu-id="4b809-162">La primera vez que se genera una instancia de usuario para cada usuario, las bases de datos del sistema **maestra** y **msdb** se copian de la carpeta de datos de plantilla en una ruta de acceso en el directorio del repositorio de datos de la aplicación local del usuario para que la instancia de usuario la use exclusivamente.</span><span class="sxs-lookup"><span data-stu-id="4b809-162">The first time a user instance is generated for each user, the **master** and **msdb** system databases are copied from the Template Data folder to a path under the user's local application data repository directory for exclusive use by the user instance.</span></span> <span data-ttu-id="4b809-163">La ruta de acceso suele ser `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span><span class="sxs-lookup"><span data-stu-id="4b809-163">This path is typically `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span></span> <span data-ttu-id="4b809-164">Cuando se inicia una instancia de usuario, los archivos **tempdb**, log y trace también se escriben en este directorio.</span><span class="sxs-lookup"><span data-stu-id="4b809-164">When a user instance starts up, the **tempdb**, log, and trace files are also written to this directory.</span></span> <span data-ttu-id="4b809-165">Se genera un nombre para la instancia cuya exclusividad está garantizada para cada usuario.</span><span class="sxs-lookup"><span data-stu-id="4b809-165">A name is generated for the instance, which is guaranteed to be unique for each user.</span></span>  
  
 <span data-ttu-id="4b809-166">De forma predeterminada, se concede permisos a todos los miembros del grupo Builtin\Users de Windows para conectarse a la instancia local, así como permisos de lectura y ejecución para los binarios de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4b809-166">By default all members of the Windows Builtin\Users group are granted permissions to connect on the local instance as well as read and execute permissions on the SQL Server binaries.</span></span> <span data-ttu-id="4b809-167">Una vez comprobadas las credenciales del usuario que llama y que hospeda la instancia de usuario, éste se convierte en el `sysadmin` de esa instancia.</span><span class="sxs-lookup"><span data-stu-id="4b809-167">Once the credentials of the calling user hosting the user instance have been verified, that user becomes the `sysadmin` on that instance.</span></span> <span data-ttu-id="4b809-168">Solo hay habilitada memoria compartida para las instancias de usuario, lo que significa que solo es posible realizar operaciones en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="4b809-168">Only shared memory is enabled for user instances, which means that only operations on the local machine are possible.</span></span>  
  
 <span data-ttu-id="4b809-169">Los usuarios deben recibir permisos tanto de lectura como de escritura para los archivos .mdf y .ldf especificados en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="4b809-169">Users must be granted both read and write permissions on the .mdf and .ldf files specified in the connection string.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4b809-170">Los archivos .mdf y .ldf son los archivos de la base de datos y del registro, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="4b809-170">The .mdf and .ldf files represent the database and log files, respectively.</span></span> <span data-ttu-id="4b809-171">Estos dos archivos forman un conjunto, así que hay que prestar mucha atención durante las operaciones de copia de seguridad y restauración.</span><span class="sxs-lookup"><span data-stu-id="4b809-171">These two files are a matched set, so care must be taken during backup and restore operations.</span></span> <span data-ttu-id="4b809-172">El archivo de la base de datos contiene información sobre la versión exacta del archivo de registro, y no será posible abrir la base de datos si está unida al archivo de registro incorrecto.</span><span class="sxs-lookup"><span data-stu-id="4b809-172">The database file contains information about the exact version of the log file, and the database will not open if it is coupled with the wrong log file.</span></span>  
  
 <span data-ttu-id="4b809-173">Para evitar que se corrompan datos, las bases de datos en las instancias de usuario se abren con acceso exclusivo.</span><span class="sxs-lookup"><span data-stu-id="4b809-173">To avoid data corruption, a database in the user instance is opened with exclusive access.</span></span> <span data-ttu-id="4b809-174">Si dos instancias de usuario diferentes comparten la misma base de datos en el mismo equipo, el usuario de la primera instancia debe cerrar la base de datos para que se pueda abrir en una segunda instancia.</span><span class="sxs-lookup"><span data-stu-id="4b809-174">If two different user instances share the same database on the same computer, the user on the first instance must close the database before it can be opened in a second instance.</span></span>  
  
## <a name="user-instance-scenarios"></a><span data-ttu-id="4b809-175">Escenarios de instancias de usuario</span><span class="sxs-lookup"><span data-stu-id="4b809-175">User Instance Scenarios</span></span>  
 <span data-ttu-id="4b809-176">Las instancias de usuario proporcionan a los desarrolladores de aplicaciones de base de datos un almacén de datos de SQL Server que no depende de que los desarrolladores tengan cuentas administrativas en sus equipos de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="4b809-176">User instances provide developers of database applications with a SQL Server data store that does not depend on developers having administrative accounts on their development computers.</span></span> <span data-ttu-id="4b809-177">Las instancias de usuario se basan en el modelo Access/Jet, en el que la aplicación de base de datos simplemente se conecta a un archivo y automáticamente el usuario tiene todos los permisos sobre los objetos de la base de datos sin necesidad de que intervenga un administrador del sistema para concedérselos.</span><span class="sxs-lookup"><span data-stu-id="4b809-177">User instances are based on the Access/Jet model, where the database application simply connects to a file, and the user automatically has full permissions on all of the database objects without needing the intervention of a system administrator to grant permissions.</span></span> <span data-ttu-id="4b809-178">Resulta muy práctico en situaciones en las que el usuario está utilizando una cuenta de privilegios mínimos, no tiene permisos de administrador para el servidor o el equipo local y necesita crear objetos y aplicaciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="4b809-178">It is intended to work in situations where the user is running under a least-privilege user account (LUA) and does not have administrative privileges on the server or local machine, yet needs to create database objects and applications.</span></span> <span data-ttu-id="4b809-179">Las instancias de usuario permiten a los usuarios crear instancias en tiempo de ejecución que se ejecutan en el propio contexto de seguridad del usuario y no en el contexto de seguridad de un servicio del sistema con más privilegios.</span><span class="sxs-lookup"><span data-stu-id="4b809-179">User instances allow users to create instances at run time that run under the user's own security context, and not in the security context of a more privileged system service.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="4b809-180">Las instancias de usuario solo se deberían utilizar cuando todas las aplicaciones que las usen sean de plena confianza.</span><span class="sxs-lookup"><span data-stu-id="4b809-180">User instances should only be used in scenarios where all the applications using it are fully trusted.</span></span>  
  
 <span data-ttu-id="4b809-181">Los escenarios de instancias de usuario incluyen:</span><span class="sxs-lookup"><span data-stu-id="4b809-181">User instance scenarios include:</span></span>  
  
- <span data-ttu-id="4b809-182">Cualquier aplicación de un único usuario en la que no sea necesario compartir datos</span><span class="sxs-lookup"><span data-stu-id="4b809-182">Any single-user application where sharing data is not required.</span></span>  
  
- <span data-ttu-id="4b809-183">Implementación ClickOnce</span><span class="sxs-lookup"><span data-stu-id="4b809-183">ClickOnce deployment.</span></span> <span data-ttu-id="4b809-184">Si .NET Framework 2.0, o posterior, y SQL Server Express ya están instalados en el equipo de destino, los usuarios que no sean administradores pueden instalar y utilizar el paquete de instalación que se descargó como resultado de una acción ClickOnce.</span><span class="sxs-lookup"><span data-stu-id="4b809-184">If the .NET Framework 2.0 (or later) and SQL Server Express are already installed on the target computer, the installation package downloaded as a result of a ClickOnce action can be installed and used by non-administrator users.</span></span> <span data-ttu-id="4b809-185">Un administrador debe instalar SQL Server Express si forma parte de la instalación.</span><span class="sxs-lookup"><span data-stu-id="4b809-185">Note that an administrator must install SQL Server Express if that is part of the setup.</span></span> <span data-ttu-id="4b809-186">Para obtener más información, vea [ClickOnce Deployment for Windows Forms](../../../winforms/clickonce-deployment-for-windows-forms.md).</span><span class="sxs-lookup"><span data-stu-id="4b809-186">For more information, see [ClickOnce Deployment for Windows Forms](../../../winforms/clickonce-deployment-for-windows-forms.md).</span></span>
  
- <span data-ttu-id="4b809-187">Hospedaje de ASP.NET dedicado con autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="4b809-187">Dedicated ASP.NET hosting using Windows Authentication.</span></span> <span data-ttu-id="4b809-188">Una sola instancia de SQL Express Server se puede hospedar en una intranet.</span><span class="sxs-lookup"><span data-stu-id="4b809-188">A single SQL Server Express instance can be hosted on an intranet.</span></span> <span data-ttu-id="4b809-189">La aplicación se conecta usando la cuenta de Windows ASPNET, sin que haya suplantación.</span><span class="sxs-lookup"><span data-stu-id="4b809-189">The application connects using the ASPNET Windows account, not by using impersonation.</span></span> <span data-ttu-id="4b809-190">No se debería utilizar instancias de usuario en escenarios de hospedaje compartido o de terceros en los que todas las aplicaciones compartirían la misma instancia de usuario y dejarían de permanecer aisladas las unas de las otras.</span><span class="sxs-lookup"><span data-stu-id="4b809-190">User instances should not be used for third-party or shared hosting scenarios where all applications would share the same user instance and would no longer remain isolated from each other.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4b809-191">Vea también</span><span class="sxs-lookup"><span data-stu-id="4b809-191">See also</span></span>

- [<span data-ttu-id="4b809-192">SQL Server y ADO.NET</span><span class="sxs-lookup"><span data-stu-id="4b809-192">SQL Server and ADO.NET</span></span>](../../../../../docs/framework/data/adonet/sql/index.md)
- [<span data-ttu-id="4b809-193">Cadenas de conexión</span><span class="sxs-lookup"><span data-stu-id="4b809-193">Connection Strings</span></span>](../../../../../docs/framework/data/adonet/connection-strings.md)
- [<span data-ttu-id="4b809-194">Conexión a un origen de datos</span><span class="sxs-lookup"><span data-stu-id="4b809-194">Connecting to a Data Source</span></span>](../../../../../docs/framework/data/adonet/connecting-to-a-data-source.md)
- [<span data-ttu-id="4b809-195">Proveedores administrados de ADO.NET y Centro para desarrolladores de DataSet</span><span class="sxs-lookup"><span data-stu-id="4b809-195">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
