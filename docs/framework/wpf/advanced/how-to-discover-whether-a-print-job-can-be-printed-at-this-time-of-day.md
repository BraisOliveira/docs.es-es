---
title: Procedimiento Detectar si un trabajo de impresión se puede imprimir en esta hora del día
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print queues [WPF], timing
- printers [WPF], availability
- print jobs [WPF], timing
ms.assetid: 7e9c8ec1-abf6-4b3d-b1c6-33b35d3c4063
ms.openlocfilehash: 7eed5400744f1010cbf52dc8d3b3d0bc24aa4371
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "61776225"
---
# <a name="how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day"></a><span data-ttu-id="a7d5d-102">Procedimiento Detectar si un trabajo de impresión se puede imprimir en esta hora del día</span><span class="sxs-lookup"><span data-stu-id="a7d5d-102">How to: Discover Whether a Print Job Can Be Printed At This Time of Day</span></span>
<span data-ttu-id="a7d5d-103">Las colas de impresión no están siempre disponibles durante 24 horas al día.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-103">Print queues are not always available for 24 hours a day.</span></span> <span data-ttu-id="a7d5d-104">Tienen propiedades de tiempo de inicio y finalización que se pueden establecer para que no esté disponible en determinados momentos del día.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-104">They have start and end time properties that can be set to make them unavailable at certain times of day.</span></span> <span data-ttu-id="a7d5d-105">Esta característica, por ejemplo, puede usarse para reservar una impresora para uso exclusivo de un determinado departamento después de las 5 P.M..</span><span class="sxs-lookup"><span data-stu-id="a7d5d-105">This feature can be used, for example, to reserve a printer for the exclusive use of a certain department after 5 P.M..</span></span> <span data-ttu-id="a7d5d-106">Ese departamento tendría una cola diferente, mantenimiento de la impresora que otros departamentos usar.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-106">That department would have a different queue servicing the printer than other departments use.</span></span> <span data-ttu-id="a7d5d-107">La cola para los otros departamentos se establecería en estar disponible después de 5 P.M., mientras que la cola del departamento favorecido podría establecerse como disponible en todo momento.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-107">The queue for the other departments would be set to be unavailable after 5 P.M., while queue for the favored department could be set to be available at all times.</span></span>  
  
 <span data-ttu-id="a7d5d-108">Además, los propios trabajos de impresión se pueden establecer en ser imprimible solo dentro de un intervalo de tiempo especificado.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-108">Moreover, print jobs themselves can be set to be printable only within a specified span of time.</span></span>  
  
 <span data-ttu-id="a7d5d-109">El <xref:System.Printing.PrintQueue> y <xref:System.Printing.PrintSystemJobInfo> clases se expongan en el [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] de Microsoft .NET Framework proporcionan un medio para la comprobación de forma remota si un determinado trabajo de impresión puede imprimir en una cola determinada en el momento actual.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-109">The <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> classes exposed in the [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] of Microsoft .NET Framework provide a means for remotely checking whether a given print job can print on a given queue at the current time.</span></span>  
  
## <a name="example"></a><span data-ttu-id="a7d5d-110">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="a7d5d-110">Example</span></span>  
 <span data-ttu-id="a7d5d-111">El ejemplo siguiente es un ejemplo que puede diagnosticar problemas con un trabajo de impresión.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-111">The example below is a sample that can diagnose problems with a print job.</span></span>  
  
 <span data-ttu-id="a7d5d-112">Hay dos pasos principales para este tipo de función como se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-112">There are two major steps for this kind of function as follows.</span></span>  
  
1. <span data-ttu-id="a7d5d-113">Leer el <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> y <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> propiedades de la <xref:System.Printing.PrintQueue> para determinar si la hora actual es entre ellos.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-113">Read the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintQueue> to determine whether the current time is between them.</span></span>  
  
2. <span data-ttu-id="a7d5d-114">Leer el <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> y <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> propiedades de la <xref:System.Printing.PrintSystemJobInfo> para determinar si la hora actual es entre ellos.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-114">Read the <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> and <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintSystemJobInfo> to determine whether the current time is between them.</span></span>  
  
 <span data-ttu-id="a7d5d-115">Pero las complicaciones surgen del hecho de que estas propiedades no son <xref:System.DateTime> objetos.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-115">But complications arise from the fact that these properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="a7d5d-116">En su lugar, son <xref:System.Int32> objetos que expresan la hora del día como el número de minutos desde la medianoche.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-116">Instead they are <xref:System.Int32> objects that express the time of day as the number of minutes since midnight.</span></span> <span data-ttu-id="a7d5d-117">Además, esto no es medianoche en la zona horaria actual, pero la medianoche UTC (Coordinated Universal Time).</span><span class="sxs-lookup"><span data-stu-id="a7d5d-117">Moreover, this is not midnight in the current time zone, but midnight UTC (Coordinated Universal Time).</span></span>  
  
 <span data-ttu-id="a7d5d-118">El primer ejemplo de código presenta el método estático **ReportQueueAndJobAvailability**, que se pasa un <xref:System.Printing.PrintSystemJobInfo> y llama a métodos auxiliares para determinar si puede imprimir el trabajo en el momento actual y, si no, cuando puede imprimir.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-118">The first code example presents the static method **ReportQueueAndJobAvailability**, which is passed a <xref:System.Printing.PrintSystemJobInfo> and calls helper methods to determine whether the job can print at the current time and, if not, when it can print.</span></span> <span data-ttu-id="a7d5d-119">Tenga en cuenta que un <xref:System.Printing.PrintQueue> no se pasa al método.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-119">Notice that a <xref:System.Printing.PrintQueue> is not passed to the method.</span></span> <span data-ttu-id="a7d5d-120">Esto es porque el <xref:System.Printing.PrintSystemJobInfo> incluye una referencia a la cola en su <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> propiedad.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-120">This is because the <xref:System.Printing.PrintSystemJobInfo> includes a reference to the queue in its <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> property.</span></span>  
  
 <span data-ttu-id="a7d5d-121">Los métodos subordinados incluyen sobrecargado **ReportAvailabilityAtThisTime** método que puede tomar un <xref:System.Printing.PrintQueue> o un <xref:System.Printing.PrintSystemJobInfo> como un parámetro.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-121">The subordinate methods include the overloaded **ReportAvailabilityAtThisTime** method which can take either a <xref:System.Printing.PrintQueue> or a <xref:System.Printing.PrintSystemJobInfo> as a parameter.</span></span> <span data-ttu-id="a7d5d-122">También hay un **TimeConverter.ConvertToLocalHumanReadableTime**.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-122">There is also a **TimeConverter.ConvertToLocalHumanReadableTime**.</span></span> <span data-ttu-id="a7d5d-123">Todos estos métodos se describen a continuación.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-123">All of these methods are discussed below.</span></span>  
  
 <span data-ttu-id="a7d5d-124">El **ReportQueueAndJobAvailability** método comienza comprobando si la cola o el trabajo de impresión no está disponible en este momento.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-124">The **ReportQueueAndJobAvailability** method begins by checking to see if either the queue or the print job is unavailable at this time.</span></span> <span data-ttu-id="a7d5d-125">Si cualquiera de ellas está disponible, a continuación, comprueba para ver si la cola no está disponible.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-125">If either of them is unavailable, it then checks to see if the queue unavailable.</span></span> <span data-ttu-id="a7d5d-126">Si no está disponible, el método notifica este hecho y el tiempo cuando la cola volverá a estar disponible.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-126">If it is not available, then the method reports this fact and the time when the queue will become available again.</span></span> <span data-ttu-id="a7d5d-127">A continuación, comprueba el trabajo y si no está disponible, notifica la próxima vez que abarcan cuando cuando puede imprimir.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-127">It then checks the job and if it is unavailable, it reports the next time span when it when it can print.</span></span> <span data-ttu-id="a7d5d-128">Por último, el método notifica la hora más temprana, cuando el trabajo puede imprimirse.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-128">Finally, the method reports the earliest time when the job can print.</span></span> <span data-ttu-id="a7d5d-129">Esto es una versión posterior de los siguientes dos veces.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-129">This is the later of following two times.</span></span>  
  
- <span data-ttu-id="a7d5d-130">La próxima hora a la cola de impresión esté disponible.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-130">The time when the print queue is next available.</span></span>  
  
- <span data-ttu-id="a7d5d-131">La hora cuando el trabajo de impresión a continuación está disponible.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-131">The time when the print job is next available.</span></span>  
  
 <span data-ttu-id="a7d5d-132">Al informar de horas del día, la <xref:System.DateTime.ToShortTimeString%2A> también se llama al método porque este método suprime los años, meses y días a partir de la salida.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-132">When reporting times of day, the <xref:System.DateTime.ToShortTimeString%2A> method is also called because this method suppresses the years, months, and days from the output.</span></span> <span data-ttu-id="a7d5d-133">No se puede restringir la disponibilidad de una cola de impresión o un trabajo de impresión para días, meses o años determinados.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-133">You cannot restrict the availability of either a print queue or a print job to particular years, months, or days.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#reportqueueandjobavailability)]
 [!code-csharp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#reportqueueandjobavailability)]
 [!code-vb[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#reportqueueandjobavailability)]  
  
 <span data-ttu-id="a7d5d-134">Las dos sobrecargas de los **ReportAvailabilityAtThisTime** método son idénticos salvo por el tipo pasado a ellas, por lo que solo el <xref:System.Printing.PrintQueue> versión se presenta a continuación.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-134">The two overloads of the **ReportAvailabilityAtThisTime** method are identical except for the type passed to them, so only the <xref:System.Printing.PrintQueue> version is presented below.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a7d5d-135">El hecho de que los métodos son idénticos salvo por tipo plantea la pregunta de por qué el ejemplo no crea un método genérico **ReportAvailabilityAtThisTime\<T >**.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-135">The fact that the methods are identical except for type raises the question of why the sample does not create a generic method **ReportAvailabilityAtThisTime\<T>**.</span></span> <span data-ttu-id="a7d5d-136">El motivo es que este tipo de método tendría que estar restringido a una clase que tiene el **las StartTimeOfDay** y **UntilTimeOfDay** las propiedades que se llama al método, pero un método genérico solo pueden restringirse a un único de clase y la única clase comunes a ambos <xref:System.Printing.PrintQueue> y <xref:System.Printing.PrintSystemJobInfo> en la herencia es árbol <xref:System.Printing.PrintSystemObject> que no tiene ninguna propiedad de este tipo.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-136">The reason is that such a method would have to be restricted to a class that has the **StartTimeOfDay** and **UntilTimeOfDay** properties that the method calls, but a generic method can only be restricted to a single class and the only class common to both <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> in the inheritance tree is <xref:System.Printing.PrintSystemObject> which has no such properties.</span></span>  
  
 <span data-ttu-id="a7d5d-137">El **ReportAvailabilityAtThisTime** método (presentado en el ejemplo de código siguiente) comienza por inicializar un <xref:System.Boolean> variable centinela para `true`.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-137">The **ReportAvailabilityAtThisTime** method (presented in the code example below) begins by initializing a <xref:System.Boolean> sentinel variable to `true`.</span></span> <span data-ttu-id="a7d5d-138">Se restablecerá a `false`, si la cola no está disponible.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-138">It will be reset to `false`, if the queue is not available.</span></span>  
  
 <span data-ttu-id="a7d5d-139">A continuación, el método comprueba si el inicio y "until" horas son idénticas.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-139">Next, the method checks to see if the start and "until" times are identical.</span></span> <span data-ttu-id="a7d5d-140">Si lo son, la cola siempre está disponible, por lo que devuelve el método `true`.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-140">If they are, the queue is always available, so the method returns `true`.</span></span>  
  
 <span data-ttu-id="a7d5d-141">Si la cola no está disponible todo el tiempo, utiliza el método estático <xref:System.DateTime.UtcNow%2A> propiedad va a obtener la hora actual como un <xref:System.DateTime> objeto.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-141">If the queue is not available all the time, the method uses the static <xref:System.DateTime.UtcNow%2A> property to get the current time as a <xref:System.DateTime> object.</span></span> <span data-ttu-id="a7d5d-142">(Hora local no es necesario porque el <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> y <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> son propiedades en hora UTC.)</span><span class="sxs-lookup"><span data-stu-id="a7d5d-142">(We do not need local time because the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties are themselves in UTC time.)</span></span>  
  
 <span data-ttu-id="a7d5d-143">Sin embargo, estas dos propiedades no son <xref:System.DateTime> objetos.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-143">However, these two properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="a7d5d-144">Son <xref:System.Int32>expresan la hora como el número de minutos después de medianoche UTC.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-144">They are <xref:System.Int32>s expressing the time as the number of minutes-after-UTC-midnight.</span></span> <span data-ttu-id="a7d5d-145">Por lo que tenemos que convertir nuestra <xref:System.DateTime> objeto en minutos después de medianoche.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-145">So we do have to convert our <xref:System.DateTime> object to minutes-after-midnight.</span></span> <span data-ttu-id="a7d5d-146">Cuando esté listo, el método simplemente comprueba ver si "ahora" está entre el inicio de la cola y "horas, Establece el centinela en false si"ahora"no está entre las dos horas y devuelve al centinela hasta".</span><span class="sxs-lookup"><span data-stu-id="a7d5d-146">When that is done, the method simply checks to see whether "now" is between the queue's start and "until" times, sets the sentinel to false if "now" is not between the two times, and returns the sentinel.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#printqueuestartuntil)]
 [!code-csharp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#printqueuestartuntil)]
 [!code-vb[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#printqueuestartuntil)]  
  
 <span data-ttu-id="a7d5d-147">El **TimeConverter.ConvertToLocalHumanReadableTime** método (presentado en el ejemplo de código siguiente) no utiliza ningún método introducido con Microsoft .NET Framework, por lo que el análisis es breve.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-147">The **TimeConverter.ConvertToLocalHumanReadableTime** method (presented in the code example below) does not use any methods introduced with Microsoft .NET Framework, so the discussion is brief.</span></span> <span data-ttu-id="a7d5d-148">El método tiene una tarea de conversión doble: debe tomar un entero que expresa minutos después de medianoche y convertirlo en un tiempo legible y que debe convertir a la hora local.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-148">The method has a double conversion task: it must take an integer expressing minutes-after-midnight and convert it to a human-readable time and it must convert this to the local time.</span></span> <span data-ttu-id="a7d5d-149">Esto realiza creando primero un <xref:System.DateTime> objeto que está establecida en medianoche UTC y, a continuación, usa el <xref:System.DateTime.AddMinutes%2A> método para agregar los minutos que se pasaron al método.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-149">It accomplishes this by first creating a <xref:System.DateTime> object that is set to midnight UTC and then it uses the <xref:System.DateTime.AddMinutes%2A> method to add the minutes that were passed to the method.</span></span> <span data-ttu-id="a7d5d-150">Esto devuelve un nuevo <xref:System.DateTime> expresa la hora original que se pasó al método.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-150">This returns a new <xref:System.DateTime> expressing the original time that was passed to the method.</span></span> <span data-ttu-id="a7d5d-151">El <xref:System.DateTime.ToLocalTime%2A> método, a continuación, lo convierte en hora local.</span><span class="sxs-lookup"><span data-stu-id="a7d5d-151">The <xref:System.DateTime.ToLocalTime%2A> method then converts this to local time.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#timeconverter)]
 [!code-csharp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#timeconverter)]
 [!code-vb[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#timeconverter)]  
  
## <a name="see-also"></a><span data-ttu-id="a7d5d-152">Vea también</span><span class="sxs-lookup"><span data-stu-id="a7d5d-152">See also</span></span>

- <xref:System.DateTime>
- <xref:System.Printing.PrintSystemJobInfo>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="a7d5d-153">Documentos en WPF</span><span class="sxs-lookup"><span data-stu-id="a7d5d-153">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="a7d5d-154">Información general sobre impresión</span><span class="sxs-lookup"><span data-stu-id="a7d5d-154">Printing Overview</span></span>](printing-overview.md)
