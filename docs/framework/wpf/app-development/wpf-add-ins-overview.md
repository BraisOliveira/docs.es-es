---
title: Información general sobre los complementos de WPF
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 36cfcaca5ae49c87916f6d7c769c878c4321247f
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/08/2019
ms.locfileid: "59091621"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="57c42-102">Información general sobre los complementos de WPF</span><span class="sxs-lookup"><span data-stu-id="57c42-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="57c42-103">.NET Framework incluye un modelo de complemento que los desarrolladores pueden usar para crear aplicaciones que admiten la extensibilidad de complemento.</span><span class="sxs-lookup"><span data-stu-id="57c42-103">The .NET Framework includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="57c42-104">Dicho modelo permite la creación de complementos que se integran con las aplicaciones y amplían su funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="57c42-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="57c42-105">En algunos escenarios, las aplicaciones también necesitan mostrar interfaces de usuario que se proporcionan los complementos. En este tema se muestra cómo WPF amplía el modelo de complemento de .NET Framework para habilitar estos escenarios, la arquitectura subyacente, sus ventajas y sus limitaciones.</span><span class="sxs-lookup"><span data-stu-id="57c42-105">In some scenarios, applications also need to display user interfaces that are provided by add-ins. This topic shows how WPF augments the .NET Framework add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  

<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="57c42-106">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="57c42-106">Prerequisites</span></span>  
 <span data-ttu-id="57c42-107">Es necesario estar familiarizado con el modelo de complemento de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="57c42-107">Familiarity with the .NET Framework add-in model is required.</span></span> <span data-ttu-id="57c42-108">Para más información, consulte [Complementos y extensibilidad](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="57c42-108">For more information, see [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="57c42-109">Información general sobre los complementos</span><span class="sxs-lookup"><span data-stu-id="57c42-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="57c42-110">Para evitar las complejidades de la recompilación y reimplementación de aplicaciones para incorporar la nueva funcionalidad, estas implementan mecanismos de extensibilidad que permiten a los desarrolladores (tanto propios como de terceros) crear otras aplicaciones que se integran con ellas.</span><span class="sxs-lookup"><span data-stu-id="57c42-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="57c42-111">La manera más común de admitir este tipo de extensibilidad es mediante el uso de complementos (también conocido como "complementos" y "módulos").</span><span class="sxs-lookup"><span data-stu-id="57c42-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="57c42-112">Estos son algunos ejemplos de aplicaciones reales que exponen la extensibilidad con complementos:</span><span class="sxs-lookup"><span data-stu-id="57c42-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="57c42-113">Complementos de Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="57c42-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="57c42-114">Módulos del Reproductor de Windows Media.</span><span class="sxs-lookup"><span data-stu-id="57c42-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="57c42-115">Complementos de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="57c42-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="57c42-116">Por ejemplo, el modelo del complemento del Reproductor de Windows Media permite a los desarrolladores de otras empresas implementar "módulos" que extienden el Reproductor de Windows Media de varias formas, entre las que se incluye incluida la creación de descodificadores y codificadores para los formatos multimedia que el Reproductor de Windows Media no admite de forma nativa (por ejemplo, DVD o MP3), efectos de audio y máscaras.</span><span class="sxs-lookup"><span data-stu-id="57c42-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="57c42-117">Cada modelo del complemento se crea para exponer la funcionalidad que es única para una aplicación, aunque hay varias entidades y comportamientos que son comunes a todos los modelos de complementos.</span><span class="sxs-lookup"><span data-stu-id="57c42-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="57c42-118">Las tres entidades principales de las soluciones de extensibilidad de complemento habituales son los *contratos*, los *complementos* y las *aplicaciones host*.</span><span class="sxs-lookup"><span data-stu-id="57c42-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="57c42-119">Los contratos definen la forma en que los complementos se integran con las aplicaciones host de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="57c42-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="57c42-120">Los complementos se integran con la funcionalidad que implementan las aplicaciones host.</span><span class="sxs-lookup"><span data-stu-id="57c42-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="57c42-121">Las aplicaciones host exponen la funcionalidad para que los complementos se integren con ella.</span><span class="sxs-lookup"><span data-stu-id="57c42-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="57c42-122">Para que se usen los complementos, es preciso que las aplicaciones host los encuentren y los carguen en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="57c42-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="57c42-123">En consecuencia, las aplicaciones que admiten complementos tienen las siguientes responsabilidades adicionales:</span><span class="sxs-lookup"><span data-stu-id="57c42-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="57c42-124">**Detección**: Buscar complementos que se adhieran a los contratos admitidos por las aplicaciones host.</span><span class="sxs-lookup"><span data-stu-id="57c42-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="57c42-125">**Activación**: Cargar, ejecutar y establecer comunicación con complementos.</span><span class="sxs-lookup"><span data-stu-id="57c42-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="57c42-126">**Aislamiento**: Uso de dominios de aplicación o procesos para establecer los límites de aislamiento que protejan las aplicaciones de seguridad potencial y problemas de ejecución de complementos.</span><span class="sxs-lookup"><span data-stu-id="57c42-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="57c42-127">**Comunicación**: Los complementos y aplicaciones host comunicarse entre sí a través de límites de aislamiento llamando a métodos y pasando datos.</span><span class="sxs-lookup"><span data-stu-id="57c42-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="57c42-128">**Administración de la duración**: Cargar y descargar dominios de aplicación y los procesos de una manera limpia y predecible (consulte [dominios de aplicación](../../app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="57c42-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="57c42-129">**Control de versiones**: Lo que garantiza que las aplicaciones de host y los complementos puedan comunicarse cuando se crean las nuevas versiones de cualquiera.</span><span class="sxs-lookup"><span data-stu-id="57c42-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="57c42-130">Por último, el desarrollo de un sólido modelo de complemento es una empresa que no es trivial.</span><span class="sxs-lookup"><span data-stu-id="57c42-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="57c42-131">Por este motivo, .NET Framework proporciona una infraestructura para la creación de modelos de complementos.</span><span class="sxs-lookup"><span data-stu-id="57c42-131">For this reason, the .NET Framework provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="57c42-132">Para más información acerca de los complementos, consulte [Complementos y extensibilidad](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="57c42-132">For more detailed information on add-ins, see [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="57c42-133">Introducción al modelo de complemento de .NET Framework</span><span class="sxs-lookup"><span data-stu-id="57c42-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="57c42-134">El modelo de complemento de .NET Framework, que se encuentra en la <xref:System.AddIn> espacio de nombres contiene un conjunto de tipos que están diseñadas para simplificar el desarrollo de extensibilidad.</span><span class="sxs-lookup"><span data-stu-id="57c42-134">The .NET Framework add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="57c42-135">La unidad fundamental del modelo de complementos de .NET Framework es la *contrato*, que define cómo una aplicación host y un complemento comunicarse entre sí.</span><span class="sxs-lookup"><span data-stu-id="57c42-135">The fundamental unit of the .NET Framework add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="57c42-136">Un contrato se expone a una aplicación host mediante una *vista* específica de la aplicación host del contrato.</span><span class="sxs-lookup"><span data-stu-id="57c42-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="57c42-137">Del mismo modo, se expone una *vista* específica del complemento al complemento.</span><span class="sxs-lookup"><span data-stu-id="57c42-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="57c42-138">Se usa un *adaptador* para que una aplicación host y un complemento se comuniquen entre sus respectivas vistas del contrato.</span><span class="sxs-lookup"><span data-stu-id="57c42-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="57c42-139">Los contratos, vistas y adaptadores se conocen como segmentos y un conjunto de segmentos relacionados constituye una *canalización*.</span><span class="sxs-lookup"><span data-stu-id="57c42-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="57c42-140">Las canalizaciones son la base en el que el modelo de complemento de .NET Framework admite la detección, la activación, aislamiento de seguridad, aislamiento de ejecución (mediante procesos y dominios de aplicación), comunicación, administración de la duración y control de versiones.</span><span class="sxs-lookup"><span data-stu-id="57c42-140">Pipelines are the foundation upon which the .NET Framework add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="57c42-141">La suma de todo ello permite a los desarrolladores compilar complementos que se integran con la funcionalidad de una aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="57c42-142">Sin embargo, algunos escenarios requieren las aplicaciones host muestren las interfaces de usuario proporcionadas por complementos. Dado que cada tecnología de presentación de .NET Framework tiene su propio modelo de implementación de interfaces de usuario, el modelo de complemento de .NET Framework no admite ninguna tecnología de presentación determinado.</span><span class="sxs-lookup"><span data-stu-id="57c42-142">However, some scenarios require host applications to display user interfaces provided by add-ins. Because each presentation technology in the .NET Framework has its own model for implementing user interfaces, the .NET Framework add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="57c42-143">En su lugar, WPF amplía el modelo de complemento de .NET Framework con compatibilidad de UI para complementos.</span><span class="sxs-lookup"><span data-stu-id="57c42-143">Instead, WPF extends the .NET Framework add-in model with UI support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="57c42-144">Complementos WPF</span><span class="sxs-lookup"><span data-stu-id="57c42-144">WPF Add-Ins</span></span>  
 <span data-ttu-id="57c42-145">WPF, junto con el modelo de complemento de .NET Framework, le permite abordar una amplia variedad de escenarios que requieren las aplicaciones host muestren las interfaces de usuario de complementos. En concreto, estos escenarios se tratan por WPF con los dos modelos de programación siguientes:</span><span class="sxs-lookup"><span data-stu-id="57c42-145">WPF, in conjunction with the .NET Framework add-in model, allows you to address a wide variety of scenarios that require host applications to display user interfaces from add-ins. In particular, these scenarios are addressed by WPF with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="57c42-146">**El complemento devuelve una interfaz de usuario**.</span><span class="sxs-lookup"><span data-stu-id="57c42-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="57c42-147">Un complemento devuelve una interfaz de usuario a la aplicación host mediante una llamada de método, tal como se define el contrato.</span><span class="sxs-lookup"><span data-stu-id="57c42-147">An add-in returns a UI to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="57c42-148">Este escenario se utiliza en los casos siguientes:</span><span class="sxs-lookup"><span data-stu-id="57c42-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="57c42-149">La apariencia de una interfaz de usuario devuelto por un complemento es dependiente de datos o condiciones que existen en tiempo de ejecución, como dinámicamente los informes generan.</span><span class="sxs-lookup"><span data-stu-id="57c42-149">The appearance of a UI that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="57c42-150">La interfaz de usuario para los servicios proporcionados por un complemento difiere de la interfaz de usuario de las aplicaciones de host que puede usar el complemento.</span><span class="sxs-lookup"><span data-stu-id="57c42-150">The UI for services provided by an add-in differs from the UI of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="57c42-151">El complemento principalmente realiza un servicio para la aplicación host y notifica el estado a la aplicación host con una interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="57c42-151">The add-in primarily performs a service for the host application, and reports status to the host application with a UI.</span></span>  
  
2.  <span data-ttu-id="57c42-152">**El complemento es una interfaz de usuario**.</span><span class="sxs-lookup"><span data-stu-id="57c42-152">**The add-in is a UI**.</span></span> <span data-ttu-id="57c42-153">Un complemento es una interfaz de usuario, como se define en el contrato.</span><span class="sxs-lookup"><span data-stu-id="57c42-153">An add-in is a UI, as defined by the contract.</span></span> <span data-ttu-id="57c42-154">Este escenario se utiliza en los casos siguientes:</span><span class="sxs-lookup"><span data-stu-id="57c42-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="57c42-155">Los complementos solo muestran los servicios que se muestran, como un anuncio.</span><span class="sxs-lookup"><span data-stu-id="57c42-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="57c42-156">La interfaz de usuario para los servicios proporcionados por un complemento es común a todas las aplicaciones host que pueden usar ese complemento, como una calculadora o un selector de colores.</span><span class="sxs-lookup"><span data-stu-id="57c42-156">The UI for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="57c42-157">Estos escenarios requieren que se pueden pasar objetos de interfaz de usuario entre la aplicación host y los dominios de aplicación del complemento.</span><span class="sxs-lookup"><span data-stu-id="57c42-157">These scenarios require that UI objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="57c42-158">Desde el modelo de complementos se basa en la comunicación remota entre dominios de aplicación de .NET Framework, los objetos que se pasan entre ellos deben ser utilizables de forma remota.</span><span class="sxs-lookup"><span data-stu-id="57c42-158">Since the .NET Framework add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="57c42-159">Un objeto que se puede usar de forma remota es una instancia de una clase que realiza una o varias de las siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="57c42-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="57c42-160">Deriva el <xref:System.MarshalByRefObject> clase.</span><span class="sxs-lookup"><span data-stu-id="57c42-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="57c42-161">Implementa la interfaz <xref:System.Runtime.Serialization.ISerializable>.</span><span class="sxs-lookup"><span data-stu-id="57c42-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="57c42-162">Tiene la <xref:System.SerializableAttribute> atributo aplicado.</span><span class="sxs-lookup"><span data-stu-id="57c42-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="57c42-163">Para obtener más información acerca de la creación de objetos de .NET Framework utilizable de forma remota, consulte [utilizable de forma remota los objetos que hace](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="57c42-163">For more information regarding the creation of remotable .NET Framework objects, see [Making Objects Remotable](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100)).</span></span>  
  
 <span data-ttu-id="57c42-164">Los tipos de UI de WPF no son utilizables de forma remota.</span><span class="sxs-lookup"><span data-stu-id="57c42-164">The WPF UI types are not remotable.</span></span> <span data-ttu-id="57c42-165">Para solucionar el problema, WPF amplía el modelo de complemento de .NET Framework para habilitar la UI de WPF crea los complementos que se muestran desde las aplicaciones host.</span><span class="sxs-lookup"><span data-stu-id="57c42-165">To solve the problem, WPF extends the .NET Framework add-in model to enable WPF UI created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="57c42-166">Esta compatibilidad se proporciona por WPF en dos tipos: el <xref:System.AddIn.Contract.INativeHandleContract> interfaz y dos métodos estáticos implementados por el <xref:System.AddIn.Pipeline.FrameworkElementAdapters> clase: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> y <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="57c42-166">This support is provided by WPF by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="57c42-167">A un nivel alto, estos tipos y métodos se utilizan como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="57c42-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  <span data-ttu-id="57c42-168">WPF requiere que las interfaces de usuario proporcionadas por complementos sean clases que derivan directa o indirectamente de <xref:System.Windows.FrameworkElement>, como formas, controles, controles de usuario, paneles de diseño y las páginas.</span><span class="sxs-lookup"><span data-stu-id="57c42-168">WPF requires that user interfaces provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="57c42-169">Siempre que el contrato declare que se pasará una interfaz de usuario entre el complemento y la aplicación host, debe declararse como un <xref:System.AddIn.Contract.INativeHandleContract> (no un <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> es una representación utilizable de forma remota de la IU del complemento que se puede pasar entre los límites de aislamiento.</span><span class="sxs-lookup"><span data-stu-id="57c42-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in UI that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="57c42-170">Antes de que se pasa desde dominio de aplicación del complemento, un <xref:System.Windows.FrameworkElement> se empaqueta como un <xref:System.AddIn.Contract.INativeHandleContract> mediante una llamada a <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="57c42-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="57c42-171">Después de que se pasa al dominio de aplicación de la aplicación host, el <xref:System.AddIn.Contract.INativeHandleContract> se debe volver a empaquetar como un <xref:System.Windows.FrameworkElement> mediante una llamada a <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="57c42-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="57c42-172">Cómo <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, y <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> se usan depende del escenario específico.</span><span class="sxs-lookup"><span data-stu-id="57c42-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="57c42-173">En las siguientes secciones se proporciona información acerca de cada modelo de programación.</span><span class="sxs-lookup"><span data-stu-id="57c42-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="57c42-174">El complemento devuelve una interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="57c42-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="57c42-175">Para que un complemento devolver una interfaz de usuario a una aplicación host, se requiere lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="57c42-175">For an add-in to return a UI to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="57c42-176">La aplicación host y la canalización deben crearse, como se describe en .NET Framework [complementos y extensibilidad](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentación.</span><span class="sxs-lookup"><span data-stu-id="57c42-176">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>  
  
2.  <span data-ttu-id="57c42-177">El contrato debe implementar <xref:System.AddIn.Contract.IContract> y, para devolver una interfaz de usuario, el contrato debe declarar un método con un valor devuelto de tipo <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="57c42-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a UI, the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="57c42-178">La interfaz de usuario que se pasa entre el complemento y la aplicación host debe derivar directa o indirectamente de <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="57c42-178">The UI that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="57c42-179">La interfaz de usuario devuelto por el complemento se debe convertir de un <xref:System.Windows.FrameworkElement> a un <xref:System.AddIn.Contract.INativeHandleContract> antes de cruzar el límite de aislamiento.</span><span class="sxs-lookup"><span data-stu-id="57c42-179">The UI that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="57c42-180">La interfaz de usuario devuelto debe convertirse de un <xref:System.AddIn.Contract.INativeHandleContract> a un <xref:System.Windows.FrameworkElement> después de cruzar el límite de aislamiento.</span><span class="sxs-lookup"><span data-stu-id="57c42-180">The UI that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="57c42-181">La aplicación host muestra el valor devuelto <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="57c42-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="57c42-182">Para obtener un ejemplo que muestra cómo implementar un complemento que devuelva una interfaz de usuario, consulte [crear un complemento que devuelva una interfaz de usuario](how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="57c42-182">For an example that demonstrates how to implement an add-in that returns a UI, see [Create an Add-In That Returns a UI](how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="57c42-183">El complemento es una interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="57c42-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="57c42-184">Cuando un complemento es una interfaz de usuario, se requiere lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="57c42-184">When an add-in is a UI, the following are required:</span></span>  
  
1.  <span data-ttu-id="57c42-185">La aplicación host y la canalización deben crearse, como se describe en .NET Framework [complementos y extensibilidad](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentación.</span><span class="sxs-lookup"><span data-stu-id="57c42-185">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>  
  
2.  <span data-ttu-id="57c42-186">Debe implementar la interfaz de contrato para el complemento <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="57c42-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="57c42-187">El complemento que se pasa a la aplicación host debe derivar directa o indirectamente de <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="57c42-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="57c42-188">El complemento se debe convertir de un <xref:System.Windows.FrameworkElement> a un <xref:System.AddIn.Contract.INativeHandleContract> antes de cruzar el límite de aislamiento.</span><span class="sxs-lookup"><span data-stu-id="57c42-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="57c42-189">El complemento se debe convertir de un <xref:System.AddIn.Contract.INativeHandleContract> a un <xref:System.Windows.FrameworkElement> después de cruzar el límite de aislamiento.</span><span class="sxs-lookup"><span data-stu-id="57c42-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="57c42-190">La aplicación host muestra el valor devuelto <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="57c42-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="57c42-191">Para obtener un ejemplo que muestra cómo implementar un complemento es una interfaz de usuario, consulte [crear un complemento, que es una interfaz de usuario](how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="57c42-191">For an example that demonstrates how to implement an add-in that is a UI, see [Create an Add-In That Is a UI](how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="57c42-192">Devolución de varias interfaces de usuario desde un complemento</span><span class="sxs-lookup"><span data-stu-id="57c42-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="57c42-193">Complementos a menudo proporcionan varias interfaces de usuario para las aplicaciones host muestren.</span><span class="sxs-lookup"><span data-stu-id="57c42-193">Add-ins often provide multiple user interfaces for host applications to display.</span></span> <span data-ttu-id="57c42-194">Por ejemplo, considere un complemento que es una interfaz de usuario que también proporciona información de estado a la aplicación host, también como una interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="57c42-194">For example, consider an add-in that is a UI that also provides status information to the host application, also as a UI.</span></span> <span data-ttu-id="57c42-195">Un complemento como este se puede implementar mediante una combinación de técnicas de los modelos de [El complemento devuelve una interfaz de usuario](#ReturnUIFromAddInContract) y [El complemento es una interfaz de usuario](#AddInIsAUI).</span><span class="sxs-lookup"><span data-stu-id="57c42-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="57c42-196">Complementos y aplicaciones del explorador XAML</span><span class="sxs-lookup"><span data-stu-id="57c42-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="57c42-197">Hasta ahora, en los ejemplos, la aplicación host ha sido una aplicación independiente instalada.</span><span class="sxs-lookup"><span data-stu-id="57c42-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="57c42-198">Pero [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] también pueden hospedar complementos, aunque con los siguientes requisitos adicionales de compilación e implementación:</span><span class="sxs-lookup"><span data-stu-id="57c42-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="57c42-199">El manifiesto de aplicación de [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] se debe configurar especialmente para descargar la canalización (carpetas y ensamblados) y el ensamblado del complemento a la caché de la aplicación [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] en el equipo cliente, en la misma carpeta que la [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="57c42-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="57c42-200">Para detectar y cargar complementos, el código de la [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] debe usar la caché de la aplicación [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] para la [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] como ubicación de la canalización y del complemento.</span><span class="sxs-lookup"><span data-stu-id="57c42-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="57c42-201">La [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] debe cargar el complemento en un contexto de seguridad especial si el complemento hace referencia a archivos dinámicos que se encuentran en el sitio de origen; cuando los hospedan [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], los complementos solo pueden hacer referencia a los archivos dinámico que se encuentran en el sitio de origen de la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="57c42-202">Estas tareas se describen con detalle en las subsecciones siguientes.</span><span class="sxs-lookup"><span data-stu-id="57c42-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="57c42-203">Configuración de la canalización y el complemento para la implementación de ClickOnce</span><span class="sxs-lookup"><span data-stu-id="57c42-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] <span data-ttu-id="57c42-204">se descargan a y ejecutar desde una carpeta segura de la [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] memoria caché de implementación.</span><span class="sxs-lookup"><span data-stu-id="57c42-204">are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="57c42-205">Para que una [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] hospede un complemento, la canalización y el ensamblado del complemento también se debe descargar en la carpeta segura.</span><span class="sxs-lookup"><span data-stu-id="57c42-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="57c42-206">Para lograrlo, es preciso que configure el manifiesto de aplicación para incluir tanto la canalización como el ensamblado del complemento en la descarga.</span><span class="sxs-lookup"><span data-stu-id="57c42-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="57c42-207">Esto se hace más fácilmente en [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], aunque el ensamblado de la canalización y del ensamblado debe estar la carpeta raíz del proyecto de [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] del host en orden para que [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] detecte los ensamblados de canalización.</span><span class="sxs-lookup"><span data-stu-id="57c42-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="57c42-208">Por consiguiente, el primer paso es crear el ensamblado de la canalización y del complemento para la raíz del proyecto [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] estableciendo la salida de la compilación de cada proyecto de ensamblado de canalización y ensamblado de complemento.</span><span class="sxs-lookup"><span data-stu-id="57c42-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="57c42-209">La siguiente tabla muestra las rutas de la salida de la compilación de los proyectos de ensamblado de canalización el proyecto de ensamblado de complemento que se encuentran en la misma carpeta de solución y raíz que el proyecto de [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] del host.</span><span class="sxs-lookup"><span data-stu-id="57c42-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="57c42-210">Tabla 1: Crear rutas de acceso de salida para los ensamblados de canalización que se hospedan en una aplicación XBAP</span><span class="sxs-lookup"><span data-stu-id="57c42-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="57c42-211">Proyecto de ensamblado de canalización</span><span class="sxs-lookup"><span data-stu-id="57c42-211">Pipeline assembly project</span></span>|<span data-ttu-id="57c42-212">Ruta de acceso de salida de la compilación</span><span class="sxs-lookup"><span data-stu-id="57c42-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="57c42-213">Contrato</span><span class="sxs-lookup"><span data-stu-id="57c42-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="57c42-214">Vista de complemento</span><span class="sxs-lookup"><span data-stu-id="57c42-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="57c42-215">Adaptador del lado del complemento</span><span class="sxs-lookup"><span data-stu-id="57c42-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="57c42-216">Adaptador del lado del host</span><span class="sxs-lookup"><span data-stu-id="57c42-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="57c42-217">Complemento</span><span class="sxs-lookup"><span data-stu-id="57c42-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="57c42-218">El siguiente paso es especificar los ensamblados de canalización y el ensamblado del complemento como archivos de contenido de las [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] en [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] haciendo lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="57c42-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="57c42-219">Incluir Incluso el ensamblado de la canalización y del complemento en el proyecto haciendo clic con el botón derecho en cada carpeta de la canalización en el Explorador de soluciones y elegir **Incluir en el proyecto**.</span><span class="sxs-lookup"><span data-stu-id="57c42-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="57c42-220">Establecer el **acción de compilación** de cada ensamblado de canalización y ensamblado de complemento en **Contenido** desde la ventana **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="57c42-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="57c42-221">El paso final es configurar el manifiesto de aplicación para incluir los archivos del ensamblado de la canalización como el archivo del ensamblado del complemento en la descarga.</span><span class="sxs-lookup"><span data-stu-id="57c42-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="57c42-222">Los archivos deben encontrarse en las carpetas de la raíz de la carpeta de la caché de [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] que ocupa la aplicación de [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="57c42-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="57c42-223">En [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], para lograr esta configuración es preciso realizar las siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="57c42-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="57c42-224">Haga clic con el botón derecho en el proyecto de [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], haga clic en **Propiedades**, **Publicar** y, después, haga clic en el botón **Archivos de aplicación**.</span><span class="sxs-lookup"><span data-stu-id="57c42-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="57c42-225">En el cuadro de diálogo **Archivos de aplicación**, establezca el **estado de la publicación** de la DLL de cada canalización y complemento en **Incluir (automático)** y establezca el **grupo de descarga** de la DLL de cada canalización y complemento en **(Requerido)**.</span><span class="sxs-lookup"><span data-stu-id="57c42-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="57c42-226">Uso de la canalización y del complemento de la base de aplicación</span><span class="sxs-lookup"><span data-stu-id="57c42-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="57c42-227">Cuando la canalización y el complemento están configurados para la implementación de [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)], se descargan en la misma carpeta de caché de [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] que la [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="57c42-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="57c42-228">Para usar la canalización y el complemento de la [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], el código de la [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] debe obtenerlos de la base de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="57c42-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="57c42-229">Los distintos tipos y miembros del modelo de complemento de .NET Framework para el uso de canalizaciones y complementos proporcionan una compatibilidad especial para este escenario.</span><span class="sxs-lookup"><span data-stu-id="57c42-229">The various types and members of the .NET Framework add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="57c42-230">En primer lugar, la ruta de acceso se identifica mediante el <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> valor de enumeración.</span><span class="sxs-lookup"><span data-stu-id="57c42-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="57c42-231">Este valor se utiliza en las sobrecargas de los miembros del complemento pertinentes para usar canalizaciones que incluyan los siguientes:</span><span class="sxs-lookup"><span data-stu-id="57c42-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="57c42-232">Acceso a sitio de origen del Host</span><span class="sxs-lookup"><span data-stu-id="57c42-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="57c42-233">Para asegurarse de que un complemento puede hacer referencia a los archivos del sitio de origen, debe cargarse con un aislamiento de seguridad equivalente a la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="57c42-234">Este nivel de seguridad se identifica mediante el <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> valor de enumeración y pasa a la <xref:System.AddIn.Hosting.AddInToken.Activate%2A> método cuando se activa un complemento.</span><span class="sxs-lookup"><span data-stu-id="57c42-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="57c42-235">Arquitectura de complemento WPF</span><span class="sxs-lookup"><span data-stu-id="57c42-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="57c42-236">En el nivel más alto, como hemos visto, WPF habilita complementos de .NET Framework implementar las interfaces de usuario (que se derivan directa o indirectamente de <xref:System.Windows.FrameworkElement>) mediante <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> y <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="57c42-236">At the highest level, as we've seen, WPF enables .NET Framework add-ins to implement user interfaces (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="57c42-237">El resultado es que la aplicación host se devuelve un <xref:System.Windows.FrameworkElement> que se muestra en la interfaz de usuario en la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from UI in the host application.</span></span>  
  
 <span data-ttu-id="57c42-238">Para la interfaz de usuario-en escenarios simples, se trata como nivel de detalle que necesita el desarrollador.</span><span class="sxs-lookup"><span data-stu-id="57c42-238">For simple UI add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="57c42-239">Para escenarios más complejos, especialmente aquellas que intenten usar servicios adicionales de WPF como diseño, recursos y enlace de datos, se requiere un conocimiento más detallado de cómo WPF amplía el modelo de complemento de .NET Framework con compatibilidad de UI para comprender sus ventajas y las limitaciones.</span><span class="sxs-lookup"><span data-stu-id="57c42-239">For more complex scenarios, particularly those that try to utilize additional WPF services such as layout, resources, and data binding, more detailed knowledge of how WPF extends the .NET Framework add-in model with UI support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="57c42-240">Fundamentalmente, WPF no pasa una interfaz de usuario desde un complemento a una aplicación host; en su lugar, WPF pasa el identificador de ventana de Win32 para la interfaz de usuario mediante el uso de la interoperabilidad con WPF.</span><span class="sxs-lookup"><span data-stu-id="57c42-240">Fundamentally, WPF doesn't pass a UI from an add-in to a host application; instead, WPF passes the Win32 window handle for the UI by using WPF interoperability.</span></span> <span data-ttu-id="57c42-241">Por lo tanto, cuando se pasa una interfaz de usuario desde un complemento a una aplicación host, ocurre lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="57c42-241">As such, when a UI from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="57c42-242">En el lado del complemento, WPF adquiere un identificador de ventana de la interfaz de usuario que se mostrará la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-242">On the add-in side, WPF acquires a window handle for the UI that will be displayed by the host application.</span></span> <span data-ttu-id="57c42-243">El identificador de ventana está encapsulado por una clase interna de WPF que se deriva de <xref:System.Windows.Interop.HwndSource> e implementa <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="57c42-243">The window handle is encapsulated by an internal WPF class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="57c42-244">Devuelve una instancia de esta clase <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> y se calculan las referencias de dominio de aplicación del complemento al dominio de aplicación de la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="57c42-245">En el lado de la aplicación host, WPF, vuelve a empaquetar la <xref:System.Windows.Interop.HwndSource> como una clase interna de WPF que se derive de <xref:System.Windows.Interop.HwndHost> y consume <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="57c42-245">On the host application side, WPF repackages the <xref:System.Windows.Interop.HwndSource> as an internal WPF class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="57c42-246">Devuelve una instancia de esta clase <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> a la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <xref:System.Windows.Interop.HwndHost> <span data-ttu-id="57c42-247">existe para mostrar interfaces de usuario, identificadas por los identificadores de ventana, de las interfaces de usuario WPF.</span><span class="sxs-lookup"><span data-stu-id="57c42-247">exists to display user interfaces, identified by window handles, from WPF user interfaces.</span></span> <span data-ttu-id="57c42-248">Para más información, consulte [Interoperabilidad de WPF y Win32](../advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="57c42-248">For more information, see [WPF and Win32 Interoperation](../advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="57c42-249">En resumen, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, y <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> existen para permitir que el identificador de ventana para una UI de WPF se pase de un complemento a una aplicación host, donde se encapsula mediante un <xref:System.Windows.Interop.HwndHost> y muestra la interfaz de usuario de la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a WPF UI to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's UI.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="57c42-250">Dado que la aplicación host obtiene un <xref:System.Windows.Interop.HwndHost>, la aplicación host no puede convertir el objeto devuelto por <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> para el tipo se implementa como mediante el complemento (por ejemplo, un <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="57c42-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="57c42-251">Por su naturaleza, <xref:System.Windows.Interop.HwndHost> tiene ciertas limitaciones que afectan a cómo las aplicaciones host pueden usarlos.</span><span class="sxs-lookup"><span data-stu-id="57c42-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="57c42-252">Sin embargo, WPF amplía <xref:System.Windows.Interop.HwndHost> con varias funcionalidades para escenarios de inicio.</span><span class="sxs-lookup"><span data-stu-id="57c42-252">However, WPF extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="57c42-253">A continuación se describen estas ventajas y limitaciones.</span><span class="sxs-lookup"><span data-stu-id="57c42-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="57c42-254">Ventajas del complemento de WPF</span><span class="sxs-lookup"><span data-stu-id="57c42-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="57c42-255">Dado que las interfaces de usuario WPF se muestran desde las aplicaciones host mediante una clase interna que deriva de <xref:System.Windows.Interop.HwndHost>, esas interfaces de usuario están restringidas por las capacidades de <xref:System.Windows.Interop.HwndHost> con respecto a los servicios de la UI de WPF como diseño, representación, enlace de datos, estilos, plantillas y recursos.</span><span class="sxs-lookup"><span data-stu-id="57c42-255">Because WPF add-in user interfaces are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those user interfaces are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to WPF UI services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="57c42-256">Sin embargo, aumenta su interno WPF <xref:System.Windows.Interop.HwndHost> subclase con capacidades adicionales que incluyen lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="57c42-256">However, WPF augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="57c42-257">Tabulación entre la interfaz de usuario de la aplicación host e interfaz de usuario de un complemento.</span><span class="sxs-lookup"><span data-stu-id="57c42-257">Tabbing between a host application's UI and an add-in's UI.</span></span> <span data-ttu-id="57c42-258">Tenga en cuenta que el modelo de programación "complemento es una interfaz de usuario" requiere que el adaptador de complemento en el lado invalidar <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> para habilitar la tabulación, si el complemento es de plena confianza o de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="57c42-258">Note that the "add-in is a UI" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="57c42-259">Teniendo en cuenta los requisitos de accesibilidad para las interfaces de usuario que se muestran desde las interfaces de usuario de aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-259">Honoring accessibility requirements for add-in user interfaces that are displayed from host application user interfaces.</span></span>  
  
-   <span data-ttu-id="57c42-260">Habilitación de las aplicaciones de WPF se ejecutan de forma segura en diversos escenarios de dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="57c42-260">Enabling WPF applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="57c42-261">Impedir el acceso no válido para la interfaz de usuario del complemento los identificadores de ventana cuando los complementos se ejecutan con aislamiento de seguridad (es decir, un recinto de seguridad de confianza parcial).</span><span class="sxs-lookup"><span data-stu-id="57c42-261">Preventing illegal access to add-in UI window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="57c42-262">Una llamada a <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> garantiza esta seguridad:</span><span class="sxs-lookup"><span data-stu-id="57c42-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="57c42-263">Para el modelo de programación "complemento devuelve una interfaz de usuario", la única manera de pasar el identificador de ventana para un complemento de la interfaz de usuario a través del límite de aislamiento es llamar a <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="57c42-263">For the "add-in returns a UI" programming model, the only way to pass the window handle for an add-in UI across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="57c42-264">Para el modelo de programación "complemento es una interfaz de usuario" reemplazar <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> en el adaptador del complemento y llamar al método <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (como se muestra en los ejemplos anteriores), es necesario, tal como está llamando a agregar en el lado del adaptador `QueryContract` implementación desde el adaptador del host.</span><span class="sxs-lookup"><span data-stu-id="57c42-264">For the "add-in is a UI" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="57c42-265">Se proporciona protección para la ejecución de varios dominios de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="57c42-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="57c42-266">Dadas las limitaciones de los dominios de aplicación, las excepciones no controladas que se producen en los dominios de aplicación del complemento provocan que toda la aplicación se bloquee, aunque exista el límite de aislamiento.</span><span class="sxs-lookup"><span data-stu-id="57c42-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="57c42-267">Sin embargo, WPF y el modelo de complemento de .NET Framework proporcionan una manera sencilla de solucionar este problema y mejorar la estabilidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="57c42-267">However, WPF and the .NET Framework add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="57c42-268">Un complemento de WPF que muestra una interfaz de usuario crea un <xref:System.Windows.Threading.Dispatcher> para el subproceso que el dominio de aplicación se ejecuta, si la aplicación host es una aplicación de WPF.</span><span class="sxs-lookup"><span data-stu-id="57c42-268">A WPF add-in that displays a UI creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a WPF application.</span></span> <span data-ttu-id="57c42-269">Puede detectar excepciones no controladas de todos los que se producen en el dominio de aplicación controlando el <xref:System.Windows.Threading.Dispatcher.UnhandledException> eventos del complemento WPF <xref:System.Windows.Threading.Dispatcher>.</span><span class="sxs-lookup"><span data-stu-id="57c42-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the WPF add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="57c42-270">Puede obtener el <xref:System.Windows.Threading.Dispatcher> desde el <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> propiedad.</span><span class="sxs-lookup"><span data-stu-id="57c42-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="57c42-271">Limitaciones del complemento de WPF</span><span class="sxs-lookup"><span data-stu-id="57c42-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="57c42-272">Más allá de las ventajas que WPF se agrega a los comportamientos predeterminados proporcionados por <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>y los identificadores de ventana, también hay limitaciones para las interfaces de usuario que se muestran desde las aplicaciones host:</span><span class="sxs-lookup"><span data-stu-id="57c42-272">Beyond the benefits that WPF adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in user interfaces that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="57c42-273">Interfaces de usuario muestra desde una aplicación host no respetan el comportamiento de recorte de la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-273">Add-in user interfaces displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="57c42-274">El concepto de *espacio aéreo* en los escenarios de interoperabilidad también se aplica a los complementos (consulte [Información general sobre áreas de la tecnología](../advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="57c42-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="57c42-275">La interfaz de usuario de la aplicación host de servicios, como la herencia de los recursos, el enlace de datos y comandos, no están disponibles automáticamente para el complemento de interfaces de usuario.</span><span class="sxs-lookup"><span data-stu-id="57c42-275">A host application's UI services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in user interfaces.</span></span> <span data-ttu-id="57c42-276">Para proporcionar estos servicios al complemento, es preciso actualizar la canalización.</span><span class="sxs-lookup"><span data-stu-id="57c42-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="57c42-277">Un complemento de la interfaz de usuario no se puede girar, escalar, sesgar o verse afectada por una transformación (consulte [información general sobre transformaciones](../graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="57c42-277">An add-in UI cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="57c42-278">Contenido dentro de las interfaces de usuario que se representa mediante el dibujo de las operaciones desde el <xref:System.Drawing> espacio de nombres puede incluir la combinación alfa.</span><span class="sxs-lookup"><span data-stu-id="57c42-278">Content inside add-in user interfaces that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="57c42-279">Sin embargo, un complemento de la interfaz de usuario y la aplicación host de la interfaz de usuario que lo contiene deben ser 100% opacas; en otras palabras, la `Opacity` propiedad en ambos debe establecerse en 1.</span><span class="sxs-lookup"><span data-stu-id="57c42-279">However, both an add-in UI and the host application UI that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="57c42-280">Si el <xref:System.Windows.Window.AllowsTransparency%2A> propiedad de una ventana en la aplicación host que contiene un complemento de la interfaz de usuario se establece en `true`, el complemento no es visible.</span><span class="sxs-lookup"><span data-stu-id="57c42-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in UI is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="57c42-281">Esto es así incluso si el complemento de la interfaz de usuario es 100% opaco (es decir, el `Opacity` propiedad tiene un valor de 1).</span><span class="sxs-lookup"><span data-stu-id="57c42-281">This is true even if the add-in UI is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="57c42-282">Un complemento de la interfaz de usuario debe aparecer encima de otros elementos WPF en la misma ventana de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="57c42-282">An add-in UI must appear on top of other WPF elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="57c42-283">Ninguna parte de interfaz de usuario de un complemento se puede representar mediante un <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="57c42-283">No portion of an add-in's UI can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="57c42-284">En su lugar, el complemento puede tardar una instantánea de la interfaz de usuario generada para crear un mapa de bits que se puede pasar a la aplicación host mediante los métodos definidos por el contrato.</span><span class="sxs-lookup"><span data-stu-id="57c42-284">Instead, the add-in may take a snapshot of the generated UI to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="57c42-285">No se puede reproducir archivos multimedia desde un <xref:System.Windows.Controls.MediaElement> en un complemento de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="57c42-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in UI.</span></span>  
  
-   <span data-ttu-id="57c42-286">Eventos del mouse generados para el complemento de la interfaz de usuario no recibe ni generados por la aplicación host y el `IsMouseOver` propiedad de interfaz de usuario de la aplicación host tiene un valor de `false`.</span><span class="sxs-lookup"><span data-stu-id="57c42-286">Mouse events generated for the add-in UI are neither received nor raised by the host application, and the `IsMouseOver` property for host application UI has a value of `false`.</span></span>  
  
-   <span data-ttu-id="57c42-287">Cuando el foco cambia entre los controles en un complemento de la interfaz de usuario, el `GotFocus` y `LostFocus` eventos no recibe ni generados por la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-287">When focus shifts between controls in an add-in UI, the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="57c42-288">La parte de una aplicación host que contiene un complemento de la interfaz de usuario aparece en blanco cuando se imprimen.</span><span class="sxs-lookup"><span data-stu-id="57c42-288">The portion of a host application that contains an add-in UI appears white when printed.</span></span>  
  
-   <span data-ttu-id="57c42-289">Todos los distribuidores (consulte <xref:System.Windows.Threading.Dispatcher>) creados por el complemento de interfaz de usuario se debe apagar manualmente antes de que el complemento propietario se descargue si continúa la ejecución de la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="57c42-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in UI must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="57c42-290">El contrato puede implementar métodos que permiten la aplicación host señalar el complemento antes de que el complemento se descarga, lo que permite que la interfaz de usuario complemento apagar sus distribuidores.</span><span class="sxs-lookup"><span data-stu-id="57c42-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in UI to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="57c42-291">Si un complemento de la interfaz de usuario es un <xref:System.Windows.Controls.InkCanvas> o contiene un <xref:System.Windows.Controls.InkCanvas>, no se puede descargar el complemento.</span><span class="sxs-lookup"><span data-stu-id="57c42-291">If an add-in UI is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="57c42-292">Optimización del rendimiento</span><span class="sxs-lookup"><span data-stu-id="57c42-292">Performance Optimization</span></span>  
 <span data-ttu-id="57c42-293">De forma predeterminada, cuando se utilizan varios dominios de aplicación, los distintos ensamblados de .NET Framework requeridos por cada aplicación todas cargados en el dominio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="57c42-293">By default, when multiple application domains are used, the various .NET Framework assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="57c42-294">Como consecuencia, el tiempo requerido para crear nuevos dominios de aplicación e iniciar aplicaciones en ellas puede afectar al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="57c42-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="57c42-295">Sin embargo, .NET Framework proporciona una manera de reducir los tiempos de inicio indicando a las aplicaciones pueden compartir ensamblados entre dominios de aplicación si ya están cargados.</span><span class="sxs-lookup"><span data-stu-id="57c42-295">However, the .NET Framework provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="57c42-296">Para ello, uso el <xref:System.LoaderOptimizationAttribute> atributo, que debe aplicarse al método de punto de entrada (`Main`).</span><span class="sxs-lookup"><span data-stu-id="57c42-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="57c42-297">En este caso, solo debe usar el código para implementar la definición de aplicación (consulte [Información general sobre la administración de aplicaciones](application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="57c42-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="57c42-298">Vea también</span><span class="sxs-lookup"><span data-stu-id="57c42-298">See also</span></span>

- <xref:System.LoaderOptimizationAttribute>
- [<span data-ttu-id="57c42-299">Complementos y extensibilidad</span><span class="sxs-lookup"><span data-stu-id="57c42-299">Add-ins and Extensibility</span></span>](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100))
- [<span data-ttu-id="57c42-300">Dominios de aplicación</span><span class="sxs-lookup"><span data-stu-id="57c42-300">Application Domains</span></span>](../../app-domains/application-domains.md)
- [<span data-ttu-id="57c42-301">Información general de servicios remotos de .NET Framework</span><span class="sxs-lookup"><span data-stu-id="57c42-301">.NET Framework Remoting Overview</span></span>](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/kwdt6w2k(v=vs.100))
- [<span data-ttu-id="57c42-302">Hacer que los objetos sean remotos</span><span class="sxs-lookup"><span data-stu-id="57c42-302">Making Objects Remotable</span></span>](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100))
- [<span data-ttu-id="57c42-303">Temas "Cómo..."</span><span class="sxs-lookup"><span data-stu-id="57c42-303">How-to Topics</span></span>](how-to-topics.md)
