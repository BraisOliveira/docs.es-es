---
title: Usar delegados de actividad
ms.date: 03/30/2017
ms.assetid: e33cf876-8979-440b-9b23-4a12d1139960
ms.openlocfilehash: 63f550549456404b237067c98afdb18a8758dd7a
ms.sourcegitcommit: 005980b14629dfc193ff6cdc040800bc75e0a5a5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/14/2019
ms.locfileid: "70989090"
---
# <a name="using-activity-delegates"></a><span data-ttu-id="3d880-102">Usar delegados de actividad</span><span class="sxs-lookup"><span data-stu-id="3d880-102">Using Activity Delegates</span></span>
<span data-ttu-id="3d880-103">Los delegados de actividad permiten a los autores de actividad exponer devoluciones de llamada con firmas específicas, para las que los usuarios de la actividad pueden proporcionar controladores basados en actividades.</span><span class="sxs-lookup"><span data-stu-id="3d880-103">Activity delegates enable activity authors to expose callbacks with specific signatures, for which users of the activity can provide activity-based handlers.</span></span> <span data-ttu-id="3d880-104">Hay dos tipos de delegados de actividad disponibles: <xref:System.Activities.ActivityAction%601> se usa para definir delegados de actividad que no tienen un valor devuelto y <xref:System.Activities.ActivityFunc%601> se utiliza para definir delegados de actividad que tienen un valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="3d880-104">Two types of activity delegates are available: <xref:System.Activities.ActivityAction%601> is used to define activity delegates that do not have a return value, and <xref:System.Activities.ActivityFunc%601> is used to define activity delegates that do have a return value.</span></span>

<span data-ttu-id="3d880-105">Los delegados de actividad son útiles en situaciones en que se debe restringir una actividad secundaria para que tenga una firma determinada.</span><span class="sxs-lookup"><span data-stu-id="3d880-105">Activity delegates are useful in scenarios where a child activity must be constrained to having a certain signature.</span></span> <span data-ttu-id="3d880-106">Por ejemplo, una actividad <xref:System.Activities.Statements.While> puede contener cualquier tipo de actividad secundaria sin restricciones, aunque el cuerpo de una actividad <xref:System.Activities.Statements.ForEach%601> es <xref:System.Activities.ActivityAction%601> y la actividad secundaria que <xref:System.Activities.Statements.ForEach%601> ejecuta finalmente debe tener <xref:System.Activities.InArgument%601>, que es el mismo tipo de miembros de la colección que <xref:System.Activities.Statements.ForEach%601> enumera.</span><span class="sxs-lookup"><span data-stu-id="3d880-106">For example, a <xref:System.Activities.Statements.While> activity can contain any type of child activity with no constraints, but the body of a <xref:System.Activities.Statements.ForEach%601> activity is an <xref:System.Activities.ActivityAction%601>, and the child activity that is ultimately executed by <xref:System.Activities.Statements.ForEach%601> must have an <xref:System.Activities.InArgument%601> that is the same type of the members of the collection that the <xref:System.Activities.Statements.ForEach%601> enumerates.</span></span>

## <a name="using-activityaction"></a><span data-ttu-id="3d880-107">Utilizar ActivityAction</span><span class="sxs-lookup"><span data-stu-id="3d880-107">Using ActivityAction</span></span>

<span data-ttu-id="3d880-108">Varias actividades de [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] utilizan acciones de actividad, como <xref:System.Activities.Statements.Catch> y <xref:System.Activities.Statements.ForEach%601>.</span><span class="sxs-lookup"><span data-stu-id="3d880-108">Several [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] activities use activity actions, such as the <xref:System.Activities.Statements.Catch> activity and the <xref:System.Activities.Statements.ForEach%601> activity.</span></span> <span data-ttu-id="3d880-109">En cada caso, la acción de actividad representa una ubicación donde el autor del flujo de trabajo especifica una actividad para proporcionar el comportamiento deseado cuando se crea un flujo de trabajo mediante una de estas actividades.</span><span class="sxs-lookup"><span data-stu-id="3d880-109">In each case, the activity action represents a location where the workflow author specifies an activity to provide the desired behavior when composing a workflow using one of these activities.</span></span> <span data-ttu-id="3d880-110">En el siguiente ejemplo, se utiliza una actividad <xref:System.Activities.Statements.ForEach%601> para mostrar texto en la ventana de la consola.</span><span class="sxs-lookup"><span data-stu-id="3d880-110">In the following example, a <xref:System.Activities.Statements.ForEach%601> activity is used to display text to the console window.</span></span> <span data-ttu-id="3d880-111">El cuerpo de <xref:System.Activities.Statements.ForEach%601> se especifica utilizando un objeto <xref:System.Activities.ActivityAction%601> que coincide con el tipo del objeto <xref:System.Activities.Statements.ForEach%601> que es cadena.</span><span class="sxs-lookup"><span data-stu-id="3d880-111">The body of the <xref:System.Activities.Statements.ForEach%601> is specified by using an <xref:System.Activities.ActivityAction%601> that matches the type of the <xref:System.Activities.Statements.ForEach%601> which is string.</span></span> <span data-ttu-id="3d880-112">La actividad <xref:System.Activities.Statements.WriteLine> especificada en <xref:System.Activities.ActivityDelegate.Handler%2A> tiene su argumento <xref:System.Activities.Statements.WriteLine.Text%2A> enlazado a los valores de cadena en la colección que la actividad <xref:System.Activities.Statements.ForEach%601> recorre en iteración.</span><span class="sxs-lookup"><span data-stu-id="3d880-112">The <xref:System.Activities.Statements.WriteLine> activity specified in the <xref:System.Activities.ActivityDelegate.Handler%2A> has its <xref:System.Activities.Statements.WriteLine.Text%2A> argument bound to the string values in the collection that the <xref:System.Activities.Statements.ForEach%601> activity iterates.</span></span>

[!code-csharp[CFX_ActivityExample#6](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#6)]

<span data-ttu-id="3d880-113">ActionArgument se utiliza para pasar los elementos individuales de la colección a WriteLine.</span><span class="sxs-lookup"><span data-stu-id="3d880-113">The actionArgument is used to flow the individual items in the collection to the WriteLine.</span></span> <span data-ttu-id="3d880-114">Cuando se invoca el flujo de trabajo, en la consola se muestra el siguiente resultado.</span><span class="sxs-lookup"><span data-stu-id="3d880-114">When the workflow is invoked, the following output is displayed to the console.</span></span>

```console
HelloWorld.
```

<span data-ttu-id="3d880-115">Los ejemplos de este tema usan la sintaxis de inicialización del objeto.</span><span class="sxs-lookup"><span data-stu-id="3d880-115">The examples in this topic use object initialization syntax.</span></span> <span data-ttu-id="3d880-116">Esta sintaxis puede ser una forma útil de crear definiciones de flujo de trabajo en el código porque proporciona una vista jerárquica de las actividades en el flujo de trabajo y muestra la relación entre las actividades.</span><span class="sxs-lookup"><span data-stu-id="3d880-116">Object initialization syntax can be a useful way to create workflow definitions in code because it provides a hierarchical view of the activities in the workflow and shows the relationship between the activities.</span></span> <span data-ttu-id="3d880-117">No hay ningún requisito para usar la sintaxis de inicialización de objeto al crear los flujos de trabajo mediante programación.</span><span class="sxs-lookup"><span data-stu-id="3d880-117">There is no requirement to use object initialization syntax when you programmatically create workflows.</span></span> <span data-ttu-id="3d880-118">El ejemplo siguiente es equivalente en su funcionamiento al ejemplo anterior.</span><span class="sxs-lookup"><span data-stu-id="3d880-118">The following example is functionally equivalent to the previous example.</span></span>

[!code-csharp[CFX_ActivityExample#7](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#7)]

<span data-ttu-id="3d880-119">Para obtener más información sobre los inicializadores de [objeto, consulte Cómo: Inicializar objetos sin llamar a unC# constructor (guía](https://go.microsoft.com/fwlink/?LinkId=161015) de [programación) y cómo: Declare un objeto mediante un inicializador](https://go.microsoft.com/fwlink/?LinkId=161016)de objeto.</span><span class="sxs-lookup"><span data-stu-id="3d880-119">For more information about object initializers, see [How to: Initialize Objects without Calling a Constructor (C# Programming Guide)](https://go.microsoft.com/fwlink/?LinkId=161015) and [How to: Declare an Object by Using an Object Initializer](https://go.microsoft.com/fwlink/?LinkId=161016).</span></span>

<span data-ttu-id="3d880-120">En el siguiente ejemplo, se utiliza una actividad <xref:System.Activities.Statements.TryCatch> en un flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="3d880-120">In the following example, a <xref:System.Activities.Statements.TryCatch> activity is used in a workflow.</span></span> <span data-ttu-id="3d880-121">El flujo de trabajo produce una excepción <xref:System.ApplicationException>, que es controlada por una actividad <xref:System.Activities.Statements.Catch%601>.</span><span class="sxs-lookup"><span data-stu-id="3d880-121">An <xref:System.ApplicationException> is thrown by the workflow, and is handled by a <xref:System.Activities.Statements.Catch%601> activity.</span></span> <span data-ttu-id="3d880-122">El controlador de la <xref:System.Activities.Statements.Catch%601> acción de actividad de la actividad <xref:System.Activities.Statements.WriteLine> es una actividad, y el detalle de la excepción se transmite a `ex` <xref:System.Activities.DelegateInArgument%601>través de.</span><span class="sxs-lookup"><span data-stu-id="3d880-122">The handler for the <xref:System.Activities.Statements.Catch%601> activity's activity action is a <xref:System.Activities.Statements.WriteLine> activity, and the exception detail is flowed through to it using the `ex` <xref:System.Activities.DelegateInArgument%601>.</span></span>

[!code-csharp[CFX_WorkflowApplicationExample#33](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#33)]

<span data-ttu-id="3d880-123">Cuando cree una actividad personalizada que defina un objeto <xref:System.Activities.ActivityAction%601>, use <xref:System.Activities.Statements.InvokeAction%601> para modelar la invocación de ese objeto <xref:System.Activities.ActivityAction%601>.</span><span class="sxs-lookup"><span data-stu-id="3d880-123">When creating a custom activity that defines an <xref:System.Activities.ActivityAction%601>, use an <xref:System.Activities.Statements.InvokeAction%601> to model the invocation of that <xref:System.Activities.ActivityAction%601>.</span></span> <span data-ttu-id="3d880-124">En este ejemplo, se define una actividad `WriteLineWithNotification` personalizada.</span><span class="sxs-lookup"><span data-stu-id="3d880-124">In this example, a custom `WriteLineWithNotification` activity is defined.</span></span> <span data-ttu-id="3d880-125">Esta actividad está compuesta de una clase <xref:System.Activities.Statements.Sequence> que contiene una actividad <xref:System.Activities.Statements.WriteLine> seguida de <xref:System.Activities.Statements.InvokeAction%601> que invoca una clase <xref:System.Activities.ActivityAction%601> que toma un argumento de tipo cadena.</span><span class="sxs-lookup"><span data-stu-id="3d880-125">This activity is composed of a <xref:System.Activities.Statements.Sequence> that contains a <xref:System.Activities.Statements.WriteLine> activity followed by an <xref:System.Activities.Statements.InvokeAction%601> that invokes an <xref:System.Activities.ActivityAction%601> that takes one string argument.</span></span>

[!code-csharp[CFX_ActivityExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#1)]

<span data-ttu-id="3d880-126">Cuando se crea un flujo de trabajo con la actividad `WriteLineWithNotification`, el autor del flujo de trabajo especifica la lógica personalizada deseada en la propiedad <xref:System.Activities.ActivityDelegate.Handler%2A> de la acción de la actividad.</span><span class="sxs-lookup"><span data-stu-id="3d880-126">When a workflow is created by using the `WriteLineWithNotification` activity, the workflow author specifies the desired custom logic in the activity action’s <xref:System.Activities.ActivityDelegate.Handler%2A>.</span></span> <span data-ttu-id="3d880-127">En este ejemplo, se crea un flujo de trabajo que utiliza la actividad `WriteLineWithNotification` y se usa una actividad <xref:System.Activities.Statements.WriteLine> como <xref:System.Activities.ActivityDelegate.Handler%2A>.</span><span class="sxs-lookup"><span data-stu-id="3d880-127">In this example, a workflow is created that use the `WriteLineWithNotification` activity, and a <xref:System.Activities.Statements.WriteLine> activity is used as the <xref:System.Activities.ActivityDelegate.Handler%2A>.</span></span>

[!code-csharp[CFX_ActivityExample#2](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#2)]

<span data-ttu-id="3d880-128">Hay varias versiones genéricas de <xref:System.Activities.Statements.InvokeAction%601> y <xref:System.Activities.ActivityAction%601> proporcionadas para pasar uno o varios argumentos.</span><span class="sxs-lookup"><span data-stu-id="3d880-128">There are multiple generic versions of <xref:System.Activities.Statements.InvokeAction%601> and <xref:System.Activities.ActivityAction%601> provided for passing one or more arguments.</span></span>

## <a name="using-activityfunc"></a><span data-ttu-id="3d880-129">Usar ActivityFunc</span><span class="sxs-lookup"><span data-stu-id="3d880-129">Using ActivityFunc</span></span>

<span data-ttu-id="3d880-130"><xref:System.Activities.ActivityAction%601> es útil cuando no existe ningún valor de resultado procedente de la actividad y <xref:System.Activities.ActivityFunc%601> se utiliza cuando se devuelve un valor de resultado.</span><span class="sxs-lookup"><span data-stu-id="3d880-130"><xref:System.Activities.ActivityAction%601> is useful when there is no result value from the activity, and <xref:System.Activities.ActivityFunc%601> is used when a result value is returned.</span></span> <span data-ttu-id="3d880-131">Cuando cree una actividad personalizada que defina un objeto <xref:System.Activities.ActivityFunc%601>, use <xref:System.Activities.Expressions.InvokeFunc%601> para modelar la invocación de ese objeto <xref:System.Activities.ActivityFunc%601>.</span><span class="sxs-lookup"><span data-stu-id="3d880-131">When creating a custom activity that defines an <xref:System.Activities.ActivityFunc%601>, use an <xref:System.Activities.Expressions.InvokeFunc%601> to model the invocation of that <xref:System.Activities.ActivityFunc%601>.</span></span> <span data-ttu-id="3d880-132">En el ejemplo siguiente, se define una actividad `WriteFillerText` .</span><span class="sxs-lookup"><span data-stu-id="3d880-132">In the following example, a `WriteFillerText` activity is defined.</span></span> <span data-ttu-id="3d880-133">Para proporcionar el texto de relleno, se especifica una clase <xref:System.Activities.Expressions.InvokeFunc%601> que toma un argumento entero y genera una cadena como resultado.</span><span class="sxs-lookup"><span data-stu-id="3d880-133">To supply the filler text, an <xref:System.Activities.Expressions.InvokeFunc%601> is specified that takes an integer argument and has a string result.</span></span> <span data-ttu-id="3d880-134">Una vez recuperado el texto de relleno, se muestra en la consola utilizando una actividad <xref:System.Activities.Statements.WriteLine>.</span><span class="sxs-lookup"><span data-stu-id="3d880-134">Once the filler text is retrieved, it is displayed to the console using a <xref:System.Activities.Statements.WriteLine> activity.</span></span>

[!code-csharp[CFX_ActivityExample#3](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#3)]

<span data-ttu-id="3d880-135">Para proporcionar el texto, se debe usar una actividad que tome un argumento `int` y tenga como resultado una cadena.</span><span class="sxs-lookup"><span data-stu-id="3d880-135">To supply the text, an activity must be used that takes one `int` argument and has a string result.</span></span> <span data-ttu-id="3d880-136">En este ejemplo se muestra una actividad `TextGenerator` que cumple estos requisitos.</span><span class="sxs-lookup"><span data-stu-id="3d880-136">This example shows a `TextGenerator` activity that meets these requirements.</span></span>

[!code-csharp[CFX_ActivityExample#4](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#4)]

<span data-ttu-id="3d880-137">Para usar la actividad `TextGenerator` con la actividad `WriteFillerText`, especifíquela como <xref:System.Activities.ActivityDelegate.Handler%2A>.</span><span class="sxs-lookup"><span data-stu-id="3d880-137">To use the `TextGenerator` activity with the `WriteFillerText` activity, specify it as the <xref:System.Activities.ActivityDelegate.Handler%2A>.</span></span>

[!code-csharp[CFX_ActivityExample#5](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#5)]
