---
title: 'Algoritmo de carga de ensamblado administrado: .NET Core'
description: Descripción de los detalles del algoritmo de carga de ensamblado administrado en .NET Core
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: bf95cbd0eebed064f0198ae9b0f7a4288a938f8a
ms.sourcegitcommit: 6f28b709592503d27077b16fff2e2eacca569992
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 08/28/2019
ms.locfileid: "72303633"
---
# <a name="managed-assembly-loading-algorithm"></a><span data-ttu-id="ccc6a-103">Algoritmo de carga de ensamblado administrado</span><span class="sxs-lookup"><span data-stu-id="ccc6a-103">Managed assembly loading algorithm</span></span>

<span data-ttu-id="ccc6a-104">Los ensamblados administrados se ubican y se cargan con un algoritmo que implica varias fases.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-104">Managed assemblies are located and loaded with an algorithm involving various stages.</span></span>

<span data-ttu-id="ccc6a-105">Todos los ensamblados administrados, excepto los ensamblados satélite y los de `WinRT`, usan el mismo algoritmo.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-105">All managed assemblies except satellite assemblies and `WinRT` assemblies use the same algorithm.</span></span>

## <a name="when-are-managed-assemblies-loaded"></a><span data-ttu-id="ccc6a-106">¿Cuándo se cargan los ensamblados administrados?</span><span class="sxs-lookup"><span data-stu-id="ccc6a-106">When are managed assemblies loaded?</span></span>

<span data-ttu-id="ccc6a-107">El mecanismo más común para desencadenar la carga de un ensamblado administrado es una referencia estática de ensamblado.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-107">The most common mechanism to trigger a managed assembly load is a static assembly reference.</span></span> <span data-ttu-id="ccc6a-108">El compilador inserta estas referencias siempre que el código usa un tipo definido en otro ensamblado.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-108">These references are inserted by the compiler whenever code uses a type defined in another assembly.</span></span> <span data-ttu-id="ccc6a-109">Estos ensamblados los carga (`load-by-name`) el runtime, según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-109">These assemblies are loaded (`load-by-name`) as needed by the runtime.</span></span>

<span data-ttu-id="ccc6a-110">El uso directo de API específicas también desencadenará cargas:</span><span class="sxs-lookup"><span data-stu-id="ccc6a-110">The direct use of specific APIs will also trigger loads:</span></span>

|<span data-ttu-id="ccc6a-111">API</span><span class="sxs-lookup"><span data-stu-id="ccc6a-111">API</span></span>  |<span data-ttu-id="ccc6a-112">DESCRIPCIÓN</span><span class="sxs-lookup"><span data-stu-id="ccc6a-112">Description</span></span>  |<span data-ttu-id="ccc6a-113">`Active` <xref:System.Runtime.Loader.AssemblyLoadContext></span><span class="sxs-lookup"><span data-stu-id="ccc6a-113">`Active` <xref:System.Runtime.Loader.AssemblyLoadContext></span></span> |
|---------|---------|---------|
|<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromAssemblyName%2A?displayProperty=nameWithType>|`Load-by-name`|<span data-ttu-id="ccc6a-114">La instancia de [this](../../csharp/language-reference/keywords/this.md).</span><span class="sxs-lookup"><span data-stu-id="ccc6a-114">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
|<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromAssemblyPath%2A?displayProperty=nameWithType><p><xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromNativeImagePath%2A?displayProperty=nameWithType>|<span data-ttu-id="ccc6a-115">Cargue desde la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-115">Load from path.</span></span>|<span data-ttu-id="ccc6a-116">La instancia de [this](../../csharp/language-reference/keywords/this.md).</span><span class="sxs-lookup"><span data-stu-id="ccc6a-116">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromStream%2A?displayProperty=nameWithType>|<span data-ttu-id="ccc6a-117">Cargue desde el objeto.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-117">Load from object.</span></span>|<span data-ttu-id="ccc6a-118">La instancia de [this](../../csharp/language-reference/keywords/this.md).</span><span class="sxs-lookup"><span data-stu-id="ccc6a-118">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
|<xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType>|<span data-ttu-id="ccc6a-119">Cargue desde la ruta de acceso en una nueva instancia de <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-119">Load from path in a new <xref:System.Runtime.Loader.AssemblyLoadContext> instance</span></span>|<span data-ttu-id="ccc6a-120">La nueva instancia de <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-120">The new <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>|
<xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>|<span data-ttu-id="ccc6a-121">Cargue desde la ruta de acceso en la instancia de <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-121">Load from path in the <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instance.</span></span><p><span data-ttu-id="ccc6a-122">Agregue un controlador <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving> a <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-122">Adds a <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving> handler to <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="ccc6a-123">El controlador cargará las dependencias del ensamblado desde su directorio.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-123">The handler will load the assembly's dependencies from its directory.</span></span>|<span data-ttu-id="ccc6a-124">Instancia de <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-124">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instance.</span></span>|
|<xref:System.Reflection.Assembly.Load(System.Reflection.AssemblyName)?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.Load(System.String)?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType>|<span data-ttu-id="ccc6a-125">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-125">`Load-by-name`.</span></span>|<span data-ttu-id="ccc6a-126">Se infiere del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-126">Inferred from caller.</span></span><p><span data-ttu-id="ccc6a-127">Prefiere los métodos <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-127">Prefer <xref:System.Runtime.Loader.AssemblyLoadContext> methods.</span></span>|
|<xref:System.Reflection.Assembly.Load(System.Byte[])?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.Load(System.Byte[],System.Byte[])?displayProperty=nameWithType>|<span data-ttu-id="ccc6a-128">Cargue desde el objeto.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-128">Load from object.</span></span>|<span data-ttu-id="ccc6a-129">Se infiere del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-129">Inferred from caller.</span></span><p><span data-ttu-id="ccc6a-130">Prefiere los métodos <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-130">Prefer <xref:System.Runtime.Loader.AssemblyLoadContext> methods.</span></span>|
<xref:System.Type.GetType(System.String)?displayProperty=nameWithType><p><xref:System.Type.GetType(System.String,System.Boolean)?displayProperty=nameWithType><p><xref:System.Type.GetType(System.String,System.Boolean,System.Boolean)?displayProperty=nameWithType>|<span data-ttu-id="ccc6a-131">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-131">`Load-by-name`.</span></span>|<span data-ttu-id="ccc6a-132">Se infiere del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-132">Inferred from caller.</span></span><p><span data-ttu-id="ccc6a-133">Prefiere los métodos <xref:System.Type.GetType%2A?displayProperty=nameWithType> con un argumento `assemblyResolver`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-133">Prefer <xref:System.Type.GetType%2A?displayProperty=nameWithType> methods with an `assemblyResolver` argument.</span></span>|
<xref:System.Reflection.Assembly.GetType%2A?displayProperty=nameWithType>|<span data-ttu-id="ccc6a-134">Si el tipo `name` describe un tipo genérico calificado con el ensamblado, desencadene un elemento `Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-134">If type `name` describes an assembly qualified generic type, trigger a `Load-by-name`.</span></span>|<span data-ttu-id="ccc6a-135">Se infiere del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-135">Inferred from caller.</span></span><p><span data-ttu-id="ccc6a-136">Prefiere <xref:System.Type.GetType%2A?displayProperty=nameWithType> al utilizar nombres de tipo calificados con el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-136">Prefer <xref:System.Type.GetType%2A?displayProperty=nameWithType> when using assembly qualified type names.</span></span>|
<xref:System.Activator.CreateInstance(System.String,System.String)?displayProperty=nameWithType><p><xref:System.Activator.CreateInstance(System.String,System.String,System.Object[])?displayProperty=nameWithType><p><xref:System.Activator.CreateInstance(System.String,System.String,System.Boolean,System.Reflection.BindingFlags,System.Reflection.Binder,System.Object[],System.Globalization.CultureInfo,System.Object[])?displayProperty=nameWithType>|<span data-ttu-id="ccc6a-137">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-137">`Load-by-name`.</span></span>|<span data-ttu-id="ccc6a-138">Se infiere del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-138">Inferred from caller.</span></span><p><span data-ttu-id="ccc6a-139">Prefiere los métodos <xref:System.Activator.CreateInstance%2A?displayProperty=nameWithType> que toman un argumento <xref:System.Type>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-139">Prefer <xref:System.Activator.CreateInstance%2A?displayProperty=nameWithType> methods taking a <xref:System.Type> argument.</span></span>|

## <a name="algorithm"></a><span data-ttu-id="ccc6a-140">Algoritmo</span><span class="sxs-lookup"><span data-stu-id="ccc6a-140">Algorithm</span></span>

<span data-ttu-id="ccc6a-141">El algoritmo siguiente describe cómo el runtime carga un ensamblado administrado.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-141">The following algorithm describes how the runtime loads a managed assembly.</span></span>

1. <span data-ttu-id="ccc6a-142">Determine el elemento <xref:System.Runtime.Loader.AssemblyLoadContext> de `active`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-142">Determine the `active` <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>

    - <span data-ttu-id="ccc6a-143">En el caso de una referencia estática de ensamblado, `active` <xref:System.Runtime.Loader.AssemblyLoadContext> es la instancia que ha cargado el ensamblado de referencia.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-143">For a static assembly reference, the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> is the instance that loaded the referring assembly.</span></span>
    - <span data-ttu-id="ccc6a-144">Las API preferidas hacen que `active` <xref:System.Runtime.Loader.AssemblyLoadContext> sean explícitos.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-144">Preferred APIs make the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> explicit.</span></span>
    - <span data-ttu-id="ccc6a-145">Otras API infieren el elemento <xref:System.Runtime.Loader.AssemblyLoadContext> de `active`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-145">Other APIs infer the `active` <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span> <span data-ttu-id="ccc6a-146">Para estas API, se usa la propiedad <xref:System.Runtime.Loader.AssemblyLoadContext.CurrentContextualReflectionContext?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-146">For these APIs, the <xref:System.Runtime.Loader.AssemblyLoadContext.CurrentContextualReflectionContext?displayProperty=nameWithType> property is used.</span></span> <span data-ttu-id="ccc6a-147">Si su valor es `null`, se usa la instancia de <xref:System.Runtime.Loader.AssemblyLoadContext> inferida.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-147">If its value is `null`, then the inferred <xref:System.Runtime.Loader.AssemblyLoadContext> instance is used.</span></span>
    - <span data-ttu-id="ccc6a-148">Consulte la tabla anterior.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-148">See table above.</span></span>

2. <span data-ttu-id="ccc6a-149">En el caso de los métodos `Load-by-name`, el elemento <xref:System.Runtime.Loader.AssemblyLoadContext> activo carga el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-149">For the `Load-by-name` methods, the active <xref:System.Runtime.Loader.AssemblyLoadContext> loads the assembly.</span></span> <span data-ttu-id="ccc6a-150">En orden de prioridad por:</span><span class="sxs-lookup"><span data-stu-id="ccc6a-150">In priority order by:</span></span>
    - <span data-ttu-id="ccc6a-151">Comprobar su `cache-by-name`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-151">Checking its `cache-by-name`.</span></span>

    - <span data-ttu-id="ccc6a-152">Llamar a la función de <xref:System.Runtime.Loader.AssemblyLoadContext.Load%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-152">Calling the <xref:System.Runtime.Loader.AssemblyLoadContext.Load%2A?displayProperty=nameWithType> function.</span></span>

    - <span data-ttu-id="ccc6a-153">Comprobar la memoria caché de las instancias de <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> y ejecutar la lógica [sondeo predeterminado de ensamblado administrado](default-probing.md#managed-assembly-default-probing).</span><span class="sxs-lookup"><span data-stu-id="ccc6a-153">Checking the <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instances' cache and running [managed assembly default probing](default-probing.md#managed-assembly-default-probing) logic.</span></span>

    - <span data-ttu-id="ccc6a-154">Generar el evento <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType> para el AssemblyLoadContext activo.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-154">Raising the <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType> event for the active AssemblyLoadContext.</span></span>

    - <span data-ttu-id="ccc6a-155">Generar el evento <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-155">Raising the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>

3. <span data-ttu-id="ccc6a-156">Para los demás tipos de cargas, el <xref:System.Runtime.Loader.AssemblyLoadContext> `active` carga el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-156">For the other types of loads, the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> loads the assembly.</span></span> <span data-ttu-id="ccc6a-157">En orden de prioridad por:</span><span class="sxs-lookup"><span data-stu-id="ccc6a-157">In priority order by:</span></span>
    - <span data-ttu-id="ccc6a-158">Comprobar su `cache-by-name`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-158">Checking its `cache-by-name`.</span></span>

    - <span data-ttu-id="ccc6a-159">Cargar desde la ruta de acceso especificada o el objeto de ensamblado sin formato.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-159">Loading from the specified path or raw assembly object.</span></span>

4. <span data-ttu-id="ccc6a-160">En cualquier caso, si se ha cargado un ensamblado recientemente, entonces ocurre lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="ccc6a-160">In either case, if an assembly is newly loaded, then:</span></span>
   - <span data-ttu-id="ccc6a-161">Se genera el evento <xref:System.AppDomain.AssemblyLoad?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-161">The <xref:System.AppDomain.AssemblyLoad?displayProperty=nameWithType> event is raised.</span></span>
   - <span data-ttu-id="ccc6a-162">Se agrega una referencia al elemento `cache-by-name` de la instancia de <xref:System.Runtime.Loader.AssemblyLoadContext> del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-162">A reference is added to the assembly's <xref:System.Runtime.Loader.AssemblyLoadContext> instance's `cache-by-name`.</span></span>

5. <span data-ttu-id="ccc6a-163">Si se encuentra el ensamblado, se agrega una referencia según sea necesario al elemento `cache-by-name` de la instancia de <xref:System.Runtime.Loader.AssemblyLoadContext> de `active`.</span><span class="sxs-lookup"><span data-stu-id="ccc6a-163">If the assembly is found, a reference is added as needed to the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> instance's `cache-by-name`.</span></span>
